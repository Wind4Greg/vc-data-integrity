<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="generator" content="ReSpec 32.2.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>Data Integrity 1.0</title>
    
    
    
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
code{color:#c63501}
th code{color:inherit}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
    

    
    
<style>

ol.algorithm { counter-reset:numsection; list-style-type: none; }
ol.algorithm li { margin: 0.5em 0; }
ol.algorithm li:before { font-weight: bold; counter-increment: numsection; content: counters(numsection, ".") ") "; }
    
</style>

<meta name="description" content="This specification describes mechanisms for ensuring the authenticity and
integrity of structured digital documents using cryptography, such as digital
signatures and other digital mathematical proofs.">
<link rel="canonical" href="https://www.w3.org/community/reports/credentials/CG-FINAL-data-integrity-20220722/">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "CG-FINAL",
  "latestVersion": "https://www.w3.org/community/reports/credentials/CG-FINAL-data-integrity-20220722/",
  "shortName": "data-integrity",
  "edDraftURI": "https://w3c.github.io/data-integrity-spec/",
  "editors": [
    {
      "name": "Dave Longley",
      "url": "http://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/"
    },
    {
      "name": "Manu Sporny",
      "url": "http://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/"
    }
  ],
  "authors": [
    {
      "name": "Dave Longley",
      "url": "http://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/"
    },
    {
      "name": "Manu Sporny",
      "url": "http://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/"
    }
  ],
  "group": "credentials",
  "wgPublicList": "public-credentials",
  "github": "w3c-ccg/data-integrity-spec",
  "otherLinks": [
    {
      "key": "Source control",
      "data": [
        {
          "value": "https://github.com/w3c-ccg/data-integrity-spec/",
          "href": "https://github.com/w3c-ccg/data-integrity-spec/"
        }
      ]
    },
    {
      "key": "Issue Tracker",
      "data": [
        {
          "value": "https://github.com/w3c-ccg/data-integrity-spec/issues/",
          "href": "https://github.com/w3c-ccg/data-integrity-spec/issues/"
        }
      ]
    }
  ],
  "wgPatentURI": "",
  "maxTocLevel": 4,
  "localBiblio": {
    "RDF-DATASET-C14N": {
      "title": "RDF Dataset Normalization",
      "href": "https://json-ld.github.io/normalization/spec/",
      "authors": [
        "David Longley",
        "Manu Sporny"
      ],
      "status": "CGDRAFT",
      "publisher": "JSON-LD Community Group",
      "id": "rdf-dataset-c14n"
    },
    "SECURITY-VOCABULARY": {
      "title": "The Security Vocabulary",
      "href": "https://w3c-ccg.github.io/security-vocab/",
      "authors": [
        "Manu Sporny",
        "David Longley"
      ],
      "status": "CGDRAFT",
      "publisher": "Credentials Community Group",
      "id": "security-vocabulary"
    },
    "ZCAP": {
      "title": "Authorization Capabilities for Linked Data",
      "href": "https://w3c-ccg.github.io/zcap-ld/",
      "status": "CGDRAFT",
      "publisher": "Credentials Community Group",
      "id": "zcap"
    },
    "MULTIBASE": {
      "title": "The Multibase Encoding Scheme",
      "date": "February 2021",
      "href": "https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-03",
      "authors": [
        "Juan Benet",
        "Manu Sporny"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF",
      "id": "multibase"
    },
    "MULTICODEC": {
      "title": "The Multi Codec Encoding Scheme",
      "date": "February 2022",
      "href": "https://github.com/multiformats/multicodec/blob/master/table.csv",
      "authors": [
        "The Multiformats Community"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF",
      "id": "multicodec"
    }
  },
  "postProcess": [
    null
  ],
  "publishISODate": "2022-07-21T00:00:00.000Z",
  "generatedSubtitle": "Final Community Group Report 21 July 2022"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/cg-final"></head>
<body class="h-entry"><div class="head">
    
    <h1 id="title" class="title">Data Integrity 1.0</h1> 
    <p id="w3c-state">
      <a href="https://www.w3.org/standards/types#reports">Final Community Group Report</a>
      <time class="dt-published" datetime="2022-07-21">21 July 2022</time>
    </p>
    <dl>
      <dt>This version:</dt><dd>
              <a class="u-url" href="https://www.w3.org/community/reports/credentials/CG-FINAL-data-integrity-20220721/">https://www.w3.org/community/reports/credentials/CG-FINAL-data-integrity-20220721/</a>
            </dd>
      <dt>Latest published version:</dt><dd>
              <a href="https://www.w3.org/community/reports/credentials/CG-FINAL-data-integrity-20220722/">https://www.w3.org/community/reports/credentials/CG-FINAL-data-integrity-20220722/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/data-integrity-spec/">https://w3c.github.io/data-integrity-spec/</a></dd>
      
      
      
      
      <dt>Editors:</dt><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="http://digitalbazaar.com/">Dave Longley</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="http://digitalbazaar.com/">Manu Sporny</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd>
      
      <dt>Authors:</dt><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="http://digitalbazaar.com/">Dave Longley</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="http://digitalbazaar.com/">Manu Sporny</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd>
      <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c-ccg/data-integrity-spec/">GitHub w3c-ccg/data-integrity-spec</a>
        (<a href="https://github.com/w3c-ccg/data-integrity-spec/pulls/">pull requests</a>,
        <a href="https://github.com/w3c-ccg/data-integrity-spec/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c-ccg/data-integrity-spec/issues/">open issues</a>)
      </dd><dd><a href="mailto:public-credentials@w3.org?subject=%5Bdata-integrity%5D%20YOUR%20TOPIC%20HERE">public-credentials@w3.org</a> with subject line <kbd>[data-integrity] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-credentials">archives</a>)</dd>
    </dl>
    
    <p class="copyright">
          <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
          ©
          2022
          
          the Contributors to the Data Integrity 1.0
          Specification, published by the
          <a href="https://www.w3.org/groups/cg/credentials">Credentials Community Group</a> under the
          <a href="https://www.w3.org/community/about/agreements/fsa/">W3C Community Final Specification Agreement (FSA)</a>. A human-readable
                <a href="https://www.w3.org/community/about/agreements/fsa-deed/">summary</a>
                is available.
              
        </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
This specification describes mechanisms for ensuring the authenticity and
integrity of structured digital documents using cryptography, such as digital
signatures and other digital mathematical proofs.
      </p>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/groups/cg/credentials">Credentials Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/final/">W3C Community Final Specification Agreement (FSA)</a>
            other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p>
      <p>
This is an experimental specification and is undergoing regular revisions. It
is not fit for production deployment.
      </p>
    <p>
    <a href="https://github.com/w3c-ccg/data-integrity-spec/issues/">GitHub Issues</a> are preferred for
          discussion of this specification.
        
    Alternatively, you can send comments to our mailing list.
          Please send them to
          <a href="mailto:public-credentials@w3.org">public-credentials@w3.org</a>
          (<a href="mailto:public-credentials-request@w3.org?subject=subscribe">subscribe</a>,
          <a href="https://lists.w3.org/Archives/Public/public-credentials/">archives</a>).
        
  </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#design-goals-and-rationale"><bdi class="secno">1.1 </bdi>Design Goals and Rationale</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.2 </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.3 </bdi>Terminology</a></li></ol></li><li class="tocline"><a class="tocxref" href="#data-model"><bdi class="secno">2. </bdi>Data Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proofs"><bdi class="secno">2.1 </bdi>Proofs</a></li><li class="tocline"><a class="tocxref" href="#proof-purposes"><bdi class="secno">2.2 </bdi>Proof Purposes</a></li><li class="tocline"><a class="tocxref" href="#controller-documents"><bdi class="secno">2.3 </bdi>Controller Documents</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#verification-methods"><bdi class="secno">2.3.1 </bdi>Verification Methods</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#verification-material"><bdi class="secno">2.3.1.1 </bdi>Verification Material</a></li><li class="tocline"><a class="tocxref" href="#multikey"><bdi class="secno">2.3.1.2 </bdi>Multikey</a></li><li class="tocline"><a class="tocxref" href="#referring-to-verification-methods"><bdi class="secno">2.3.1.3 </bdi>Referring to Verification Methods</a></li></ol></li><li class="tocline"><a class="tocxref" href="#verification-relationships"><bdi class="secno">2.3.2 </bdi>Verification Relationships</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#authentication"><bdi class="secno">2.3.2.1 </bdi>Authentication</a></li><li class="tocline"><a class="tocxref" href="#assertion"><bdi class="secno">2.3.2.2 </bdi>Assertion</a></li><li class="tocline"><a class="tocxref" href="#key-agreement"><bdi class="secno">2.3.2.3 </bdi>Key Agreement</a></li><li class="tocline"><a class="tocxref" href="#capability-invocation"><bdi class="secno">2.3.2.4 </bdi>Capability Invocation</a></li><li class="tocline"><a class="tocxref" href="#capability-delegation"><bdi class="secno">2.3.2.5 </bdi>Capability Delegation</a></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#multiple-proofs"><bdi class="secno">3. </bdi>Multiple Proofs</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proof-sets"><bdi class="secno">3.1 </bdi>Proof Sets</a></li><li class="tocline"><a class="tocxref" href="#proof-chains"><bdi class="secno">3.2 </bdi>Proof Chains</a></li></ol></li><li class="tocline"><a class="tocxref" href="#proof-types"><bdi class="secno">4. </bdi>Proof Types</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#signatures"><bdi class="secno">4.1 </bdi>Signatures</a></li><li class="tocline"><a class="tocxref" href="#other-proof-types"><bdi class="secno">4.2 </bdi>Other Proof Types</a></li></ol></li><li class="tocline"><a class="tocxref" href="#advanced-terminology"><bdi class="secno">5. </bdi>Advanced Terminology</a></li><li class="tocline"><a class="tocxref" href="#creating-new-proof-types"><bdi class="secno">6. </bdi>Creating New Proof Types</a></li><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">7. </bdi>Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proof-algorithm"><bdi class="secno">7.1 </bdi>Proof Algorithm</a></li><li class="tocline"><a class="tocxref" href="#proof-verification-algorithm"><bdi class="secno">7.2 </bdi>Proof Verification Algorithm</a></li><li class="tocline"><a class="tocxref" href="#create-verify-hash-algorithm"><bdi class="secno">7.3 </bdi>Create Verify Hash Algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">8. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#verification-method-binding"><bdi class="secno">8.1 </bdi>Verification Method Binding</a></li><li class="tocline"><a class="tocxref" href="#verification-relationship-validation"><bdi class="secno">8.2 </bdi>Verification Relationship Validation</a></li><li class="tocline"><a class="tocxref" href="#canonicalization-method-correctness"><bdi class="secno">8.3 </bdi>Canonicalization Method Correctness</a></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">9. </bdi>Privacy Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#unlinkability"><bdi class="secno">9.1 </bdi>Unlinkability</a></li><li class="tocline"><a class="tocxref" href="#selective-disclosure"><bdi class="secno">9.2 </bdi>Selective Disclosure</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">A.1 </bdi>Normative references</a></li></ol></li></ol></nav>

    <section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
      
      <p>
Cryptographic proofs enable functionality that is useful to implementors of
distributed systems. For example, proofs can be used to:
      </p>

<ul>
<li>
Make statements that can be shared without loss of trust, because their
authorship can be verified by a third party, for example as part of Verifiable
Credentials [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model" title="Verifiable Credentials Data Model v1.1">VC-DATA-MODEL</a></cite>] or social media posts.
</li>
<li>
Authenticate as an entity identified by a particular identifier, for example, as
the subject identified by a Decentralized Identifier (DID) [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>].
</li>
<li>
Delegate authorization for actions in a remote execution environment, via
mechanisms such as Authorization Capabilities [<cite><a class="bibref" data-link-type="biblio" href="#bib-zcap" title="Authorization Capabilities for Linked Data">ZCAP</a></cite>].
</li>
<li>
Agree to contracts where the agreement can be verified by another party.
</li>
<li>
Additionally, many proofs that are based on cryptographic digital signatures
provide the benefit of integrity protection, making documents and data
tamper-evident.
</li>
</ul>

      <p>
The term Linked Data is used to describe a recommended best practice for
exposing, sharing, and connecting information on the Web using standards,
such as URLs, to identify things and their properties. When information
is presented as Linked Data, other related information can be easily discovered
and new information can be easily linked to it. Linked Data is extensible in a
decentralized way, greatly reducing barriers to large scale integration.
      </p>

      <p>
With the increase in usage of Linked Data for a variety of applications, there
is a need to be able to verify the authenticity and integrity of Linked Data
documents. This specification adds authentication and integrity protection to
data documents through the use of mathematical proofs without sacrificing
Linked Data features such as extensibility and
composability.
      </p>

      <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>Note</span><span class="issue-label">: Use of Linked Data is an optional feature</span></div><p class="">
While  this specification provides mechanisms to digitally sign Linked Data, the
use  of Linked Data is not necessary to gain some of the advantages provided by
this specification.
      </p></div>

      <section id="design-goals-and-rationale"><div class="header-wrapper"><h3 id="x1-1-design-goals-and-rationale"><bdi class="secno">1.1 </bdi>Design Goals and Rationale</h3><a class="self-link" href="#design-goals-and-rationale" aria-label="Permalink for Section 1.1"></a></div>
        

        <p>
The Data Integrity specification achieves the following design goals:
        </p>

        <dl>
          <dt>Simple for Developers</dt>
          <dd>
The proof format is designed to be easy to use for developers that don't
have significant cryptography training. For example, <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-1">cryptographic suite</a>
identifiers are used instead of specific cryptographic parameters to ensure
that it is difficult to accidentally produce a weak digital proof.
          </dd>
          <dt>Layered Architecture</dt>
          <dd>
A number of historical digital signature mechanisms have had monolithic
designs which limited use cases by combining data normalization, syntax,
digital signature, and serialization into a single specification. This
specification layers each component such that a broader range of use cases,
such as generalized selective disclosure and serialization-agnostic signatures,
are enabled.
          </dd>
          <dt>Cryptographic Agility</dt>
          <dd>
Since digital proof mechanisms might be compromised without warning due to
technological advancements, it is important that <a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-1">proof type</a>s can be
easily and quickly replaced. This specification provides algorithm agility
while still keeping the digital proof format easy for developers to understand.
          </dd>
          <dt>Extensibility</dt>
          <dd>
Creating and deploying new proof types is a fairly trivial undertaking
to ensure that the proof format increases the rate of innovation in the
digital proof space.
          </dd>
          <dt>Syntax Agnostic Proofs</dt>
          <dd>
Cryptographic proofs can be serialized in many different but equivalent ways and
have often been tightly bound to the original document syntax. This
specification enables one to create cryptographic proofs that are not
bound to the original document syntax, which enable more advanced use cases
such as being able to use a single digital signature across a variety of
RDF-based graph serialization syntaxes such as JSON-LD, N-Quads, and TURTLE,
without the need to regenerate the proof.
          </dd>
        </dl>
      </section>

      <section id="conformance"><div class="header-wrapper"><h3 id="x1-2-conformance"><bdi class="secno">1.2 </bdi>Conformance</h3><a class="self-link" href="#conformance" aria-label="Permalink for Section 1.2"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">OPTIONAL</em>, <em class="rfc2119">RECOMMENDED</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>
      </section>

      <section id="terminology"><div class="header-wrapper"><h3 id="x1-3-terminology"><bdi class="secno">1.3 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.3"></a></div>
        

        <div><p>
This section defines the terms used in this specification and throughout
<a href="#dfn-decentralized-identifiers" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-decentralized-identifiers-1">decentralized identifier</a> infrastructure. A link to these terms is
included whenever they appear in this specification.
</p>

<dl class="termlist">
  <dt><dfn data-plurals="data integrity proofs" id="dfn-data-integrity-proof" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">data integrity proof</dfn></dt>
  <dd>
A set of attributes that represent a digital proof and the parameters required
to verify it.
  </dd>
  <dt><dfn id="dfn-unsigned-data-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">unsigned data document</dfn></dt>
  <dd>
A document that does not contain a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-1">data integrity proof</a>.
  </dd>
  <dt><dfn id="dfn-signed-data-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">signed data document</dfn></dt>
  <dd>
A <a href="#dfn-unsigned-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-unsigned-data-document-1">unsigned data document</a> that has had a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-2">data integrity proof</a>
added to it.
  </dd>
  <dt><dfn id="dfn-public-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">public key</dfn></dt>
  <dd>
Cryptographic material that can be used to verify digital proofs created with a
corresponding <a href="#dfn-private-key" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-private-key-1">private key</a>.
  </dd>
  <dt><dfn id="dfn-private-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">private key</dfn></dt>
  <dd>
Cryptographic material that can be used to generate digital proofs.
  </dd>
  <dt><dfn id="dfn-proof-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof type</dfn></dt>
  <dd>
A specified set of cryptographic primitives bundled together into a
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-2">cryptographic suite</a> for the purposes of safety and convenience, by
cryptographers for developers. A proof type typically consists of a
<a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-1">canonicalization algorithm</a>, a <a href="#dfn-message-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-message-digest-algorithm-1">message digest algorithm</a>, and a
specific corresponding <a href="#dfn-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-algorithm-1">proof algorithm</a> (see section <a href="#advanced-terminology" class="sec-ref"><bdi class="secno">5. </bdi>Advanced Terminology</a>).
  </dd>
  <dt><dfn id="dfn-proof-options" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof options</dfn></dt>
  <dd>
A set of options that is included in the proof data. These options might
include <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-1">controller</a>, <a href="#dfn-challenge" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-challenge-1">challenge</a>, <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-1">domain</a>, or other data
that is specific to the proof format.
  </dd>
  <dt><dfn id="dfn-proof-purpose" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof purpose</dfn></dt>
  <dd>
The specific intent for the proof; the reason why an entity created it. The
protected declaration acts as a safeguard to prevent the proof from being
misused for a purpose other than the one it was intended for.
  </dd>
  <dt><dfn id="dfn-challenge" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">challenge</dfn></dt>
  <dd>
A random or pseudo-random value used by some authentication protocols to
mitigate replay attacks.
  </dd>
  <dt><dfn id="dfn-domain" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">domain</dfn></dt>
  <dd>
A string value that specifies the operational domain of a digital proof.
This could be an Internet domain name like <code>example.com</code>, an
ad-hoc value such as <code>mycorp-level3-access</code>, or a very
specific transaction value like <code>8zF6T8J34qP3mqP</code>. A signer could
include a <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-2">domain</a> in its digital proof to restrict its use
to particular target, identified by the specified <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-3">domain</a>.
  </dd>

  <dt><dfn data-lt="authenticated|authenticate" id="dfn-authenticated" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">authenticate</dfn></dt>
  <dd>
Authentication is a process by which an entity can prove it has a specific
attribute or controls a specific secret using one or more <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-1">verification
methods</a>. With <a href="#dfn-decentralized-identifiers" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-decentralized-identifiers-2">DIDs</a>, a common example would be proving control of the
cryptographic private key associated with a public key published in a
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-1">controller document</a>.
  </dd>

  <dt><dfn data-lt="cryptosuite|cryptographic suite" id="dfn-cryptosuite" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">cryptographic suite</dfn></dt>
  <dd>
A specification defining the usage of specific cryptographic primitives in
order to achieve a particular security goal. These documents are often used
to specify <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-2">verification methods</a>, digital signature types,
their identifiers, and other related properties.
  </dd>

  <dt><dfn data-lt="decentralized identifiers|DID|DIDs|decentralized identifier" data-plurals="dids|did" id="dfn-decentralized-identifiers" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">decentralized identifier</dfn> (DID)</dt>

  <dd>
A globally unique persistent identifier that does not require a centralized
registration authority and is often generated and/or registered
cryptographically. The generic format of a is defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>]. Many—but
not all—methods make use of <a href="#dfn-distributed-ledger-technology" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-distributed-ledger-technology-1">distributed ledger technology</a> (DLT) or some
other form of decentralized network.
  </dd>

  <dt><dfn data-lt="controller(s)|controller" data-plurals="controllers" id="dfn-controller-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controller</dfn></dt>

  <dd>
An entity that has the capability to make changes to a
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-2">controller document</a>.
  </dd>

  <dt><dfn data-lt="controller documents|controller document" id="dfn-controller-documents" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controller document</dfn></dt>

  <dd>
A set of data that specifies one or more relationships between a
<a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-2">controller</a> and a set of data, such as a set of public cryptographic keys.
  </dd>

  <dt><dfn id="dfn-resolution" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">resolution</dfn></dt>

  <dd>
The process that takes as its input a [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>] and a set of resolution
options and returns a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-3">controller document</a> plus additional metadata.
  </dd>

  <dt><dfn data-lt="resolvers|resolver" id="dfn-resolvers" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">resolver</dfn></dt>

  <dd>
A <a href="#dfn-resolvers" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-resolvers-1">resolver</a> is a software and/or hardware component that performs the
<a href="#dfn-resolution" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-resolution-1">resolution</a> function by taking a <a href="#dfn-decentralized-identifiers" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-decentralized-identifiers-3">DID</a> as input and producing a
conforming <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-4">controller document</a> as output.
  </dd>

  <dt><dfn data-lt="subjects|subject" id="dfn-subjects" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">subject</dfn></dt>

  <dd>
The entity identified by a <a href="#dfn-decentralized-identifiers" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-decentralized-identifiers-4">DID</a> and described by a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-5">controller document</a>.
Anything can be a subject: person, group, organization, physical thing,
digital thing, logical thing, etc.
  </dd>

  <dt><dfn data-lt="distributed ledger technology|DLT|distributed ledger" id="dfn-distributed-ledger-technology" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">distributed ledger</dfn> (DLT)</dt>

  <dd>
A non-centralized system for recording events. These systems establish
sufficient confidence for participants to rely upon the data recorded by others
to make operational decisions. They typically use distributed databases where
different nodes use a consensus protocol to confirm the ordering of
cryptographically signed transactions. The linking of digitally signed
transactions over time often makes the history of the ledger effectively
immutable.
  </dd>

  <dt><dfn data-lt="resources|resource" id="dfn-resources" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">resource</dfn></dt>

  <dd>
As defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3986" title="Uniform Resource Identifier (URI): Generic Syntax">RFC3986</a></cite>]: "...the term 'resource' is used in a general sense
for whatever might be identified by a URI." Similarly, any resource might serve
as a <a href="#dfn-subjects" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subjects-1">subject</a> identified by a <a href="#dfn-decentralized-identifiers" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-decentralized-identifiers-5">DID</a>.
  </dd>


  <dt><dfn data-lt="verifiable credentials|verifiable credential" id="dfn-verifiable-credentials" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verifiable credential</dfn></dt>

  <dd>
A standard data model and representation format for cryptographically-verifiable
digital credentials as defined by the W3C Verifiable Credentials specification
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model" title="Verifiable Credentials Data Model v1.1">VC-DATA-MODEL</a></cite>].
  </dd>

  <dt><dfn data-lt="" data-plurals="verification methods" id="dfn-verification-method" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification method</dfn></dt>

  <dd>
    <p>
A set of parameters that can be used together with a process to independently
verify a proof. For example, a cryptographic public key can be used as a
verification method with respect to a digital signature; in such usage, it
verifies that the signer possessed the associated cryptographic private key.
    </p>
    <p>
"Verification" and "proof" in this definition are intended to apply broadly. For
example, a cryptographic public key might be used during Diffie-Hellman key
exchange to negotiate a shared symmetric key for encryption. This guarantees the
integrity of the key agreement process. It is thus another type of verification
method, even though descriptions of the process might not use the words
"verification" or "proof."
    </p>
  </dd>

  <dt><dfn data-lt="" data-plurals="verification relationships" id="dfn-verification-relationship" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification relationship</dfn></dt>

  <dd>
    <p>
An expression of the relationship between the <a href="#dfn-subjects" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subjects-2">subject</a> and a
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-3">verification method</a>. An example of a verification relationship is
<a href="#authentication" class="sec-ref"><bdi class="secno">2.3.2.1 </bdi>Authentication</a>.
    </p>
  </dd>

</dl>
</div>
      </section>
    </section>

    <section id="data-model"><div class="header-wrapper"><h2 id="x2-data-model"><bdi class="secno">2. </bdi>Data Model</h2><a class="self-link" href="#data-model" aria-label="Permalink for Section 2."></a></div>
      

      <p>
This section specifies the data model that is used for expressing
<a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-3">data integrity proofs</a> and <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-4">verification methods</a>.
      </p>

      <section id="proofs"><div class="header-wrapper"><h3 id="x2-1-proofs"><bdi class="secno">2.1 </bdi>Proofs</h3><a class="self-link" href="#proofs" aria-label="Permalink for Section 2.1"></a></div>
        
        <p>
A <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-4">data integrity proof</a> is comprised of information about the proof,
parameters required to verify it, and the proof value itself. All of this
information is provided using Linked Data vocabularies such as
[<cite><a class="bibref" data-link-type="biblio" href="#bib-security-vocabulary" title="The Security Vocabulary">SECURITY-VOCABULARY</a></cite>].
        </p>

        <p>
A <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-5">data integrity proof</a> typically includes at least the following
attributes:
        </p>

        <dl style="margin-left: 1em;">
          <dt><dfn id="dfn-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">type</dfn></dt><dt>
          </dt><dd>
<em>Required</em>. The specific <a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-2">proof type</a> used. For example, an
<code>Ed25519Signature2020</code> type indicates that the proof includes a
digital signature produced by an <code>ed25519</code> cryptographic key.
          </dd>

          <dt><dfn class="lint-ignore" id="dfn-proofpurpose" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proofPurpose</dfn></dt><dt>
          </dt><dd>
<em>Required</em>. The specific intent for the proof, the reason why an entity
created it. Acts as a safeguard to prevent the proof from being misused for a
purpose other than the one it was intended for. For example, a proof can be used
for purposes of <code>authentication</code>, for asserting control of a
Verifiable Credential (<code>assertionMethod</code>), and several others.
          </dd>

          <dt><dfn id="dfn-verificationmethod" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verificationMethod</dfn></dt><dt>
          </dt><dd>
<em>Required</em>. A set of parameters required to independently verify the
proof, such as an identifier for a public/private key pair that would be used in
the proof.
          </dd>

          <dt><dfn id="dfn-created" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">created</dfn></dt><dt>
          </dt><dd>
<em>Required</em>. The string value of an [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso8601" title="Representation of dates and times. ISO 8601:2004.">ISO8601</a></cite>] combined date and time
string generated by the <a href="#proof-algorithm">Proof Algorithm</a>.
          </dd>

          <dt>domain</dt><dt>
          </dt><dd>
Optional. A string value specifying the restricted <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-4">domain</a> of the proof.
          </dd>

          <dt><dfn id="dfn-proofvalue" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proofValue</dfn></dt><dt>
          </dt><dd>
<em>Required</em>. One of any number of valid representations of <em>proof
value</em> generated by the <a href="#proof-algorithm">Proof Algorithm</a>.
          </dd>
        </dl>

        <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>Note</span></div><p class="">
The terms <a href="#dfn-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-type-1">type</a>, <a href="#dfn-created" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-created-1">created</a>, and <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-5">domain</a> above map to URLs.
The vocabulary where these terms are defined is the [<cite><a class="bibref" data-link-type="biblio" href="#bib-security-vocabulary" title="The Security Vocabulary">SECURITY-VOCABULARY</a></cite>].
        </p></div>

        <p>
A proof can be added to a JSON document like the following:
        </p>

        <div class="example" id="example-a-simple-json-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-json-data-document">Example<bdi> 1</bdi></a><span class="example-title">: A simple JSON data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs css">{
  "title": <span class="hljs-string">"Hello world!"</span>
};</code></pre>
      </div>

        <p>
by adding the parameters outlined in this section:
        </p>

        <div class="example" id="example-a-simple-signed-json-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-signed-json-data-document">Example<bdi> 2</bdi></a><span class="example-title">: A simple signed JSON data document</span>
  </div> <pre class="highlight" style="overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" aria-busy="false"><code class="hljs">{
  "title": "Hello world!",
  "proof": {
    "type": "JcsSignature2020",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://di.example/issuer#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "zQeVbY4oey5q2M3XKaxup3tmzN4DRFTLVqpLMweBrSxMY2xHX5XTYV8nQA
      pmEcqaqA3Q1gVHMrXFkXJeV6doDwLWx"
  }
}</code></pre>
      </div>

        <p>
The proof example above uses the <code>JcsSignature2020</code>
<a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-3">proof type</a> to produce a verifiable digital proof by canonicalizing the
input data using the JSON Canonicalization Scheme [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>] and then
digitally signing it using an Ed25519 elliptic curve signature.
        </p>

        <p>
Similarly, a proof can be added to a JSON-LD data document like the following:
        </p>

        <div class="example" id="example-a-simple-json-ld-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-json-ld-data-document">Example<bdi> 3</bdi></a><span class="example-title">: A simple JSON-LD data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"@context"</span>: {<span class="hljs-string">"title"</span>: <span class="hljs-string">"https://schema.org#title"</span>},
  <span class="hljs-string">"title"</span>: <span class="hljs-string">"Hello world!"</span>
};</code></pre>
      </div>

        <p>
by adding the parameters outlined in this section:
        </p>

        <div class="example" id="example-a-simple-signed-json-ld-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-signed-json-ld-data-document">Example<bdi> 4</bdi></a><span class="example-title">: A simple signed JSON-LD data document</span>
  </div> <pre class="highlight" style="overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" aria-busy="false"><code class="hljs">{
  "@context": [
    {"title": "https://schema.org#title"},
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ],
  "title": "Hello world!",
  "proof": {
    "type": "Ed25519Signature2020",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://ldi.example/issuer#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4oey5q2M3XKaxup3tmzN4DRFTLVqpLMweBrSxMY2xHX5XTYVQeVbY8nQA
      VHMrXFkXJpmEcqdoDwLWxaqA3Q1geV6"
  }
}</code></pre>
      </div>

        <p>
The proof example above uses the <code>Ed25519Signature2020</code> <a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-4">proof
type</a> to produce a verifiable digital proof by canonicalizing the input data
using the RDF Dataset Canonicalization algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-c14n" title="RDF Dataset Normalization">RDF-DATASET-C14N</a></cite>] and then
digitally signing it using an Ed25519 elliptic curve signature.
        </p>

<div class="issue" id="issue-container-number-1"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><span>Issue 1</span></div><div class="">Create a separate section detailing an optional mechanism
for authenticating public key control via bi-directional links. How
to establish trust in controllers is out of scope but examples can
be given.</div></div>

<div class="issue" id="issue-container-number-2"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="4"><span>Issue 2</span></div><div class="">Specify algorithm agility mechanisms (additional attributes
from the security vocab can be used to indicate other signing and hash
algorithms). Rewrite algorithms to be parameterized on this basis and
move <code>Ed25519Signature2020</code> definition to a single supported
mechanism; specify its identifier as a URL. In order to make it easy to
specify a variety of combinations of algorithms, introduce a core
type <code>DataIntegrityProof</code> that allows for easy filtering/discover of
proof nodes, but that type on its own doesn't specify any default
proof or hash algorithms, those need to be given via other properties in the
nodes.</div></div>

      <div class="issue" id="issue-container-number-3"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="4"><span>Issue 3</span><span class="issue-label">: Avoid signature format proliferation by using text-based suite value</span></div><p class="">
The pattern that Data Integrity Signatures use presently leads to a
proliferation in signature types and JSON-LD Contexts. This proliferation can be
avoided without any loss of the security characteristics of tightly binding a
cryptography suite version to one or more acceptable public keys. The
following signature suites are currently being contemplated: eddsa-2022,
nist-ecdsa-2022, koblitz-ecdsa-2022, rsa-2022, pgp-2022, bbs-2022, eascdsa-2022,
ibsa-2022, and jws-2022.
      </p></div>

      <div class="example" id="example-a-dataintegritysignature-example-using-a-nist-ecdsa-2022-cryptosuite">
        <div class="marker">
    <a class="self-link" href="#example-a-dataintegritysignature-example-using-a-nist-ecdsa-2022-cryptosuite">Example<bdi> 5</bdi></a><span class="example-title">: A DataIntegritySignature example using a NIST ECDSA 2022 Cryptosuite</span>
  </div> <pre aria-busy="false"><code class="hljs">{
  "@context": ["https://w3id.org/security/data-integrity/v1"],
  "type": "DataIntegritySignature",
  "cryptosuite": "ecdsa-2022",
  "created": "2022-11-29T20:35:38Z",
  "verificationMethod": "did:example:123456789abcdefghi#keys-1",
  "proofPurpose": "assertionMethod",
  "proofValue": "z2rb7doJxczUFBTdV5F5pehtbUXPDUgKVugZZ99jniVXCUpojJ9PqLYV
                 evMeB1gCyJ4HqpnTyQwaoRPWaD3afEZboXCBTdV5F5pehtbUXPDUgKVugUpoj"
}</code></pre>
      </div>

<div class="issue" id="issue-container-number-4"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="4"><span>Issue 4</span></div><div class="">Add an explicit check on key type to prevent an
attacker from selecting an algorithm that could abuse how the key is
used/interpreted.</div></div>

<div class="issue" id="issue-container-number-5"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="4"><span>Issue 5</span></div><div class="">Add a note indicating that selective disclosure proof
mechanisms can be compatible with Data Integrity; for example,
an algorithm could produce a merkle tree from a canonicalized set of
N-Quads and then sign the root hash. Disclosure would involve including
the merkle paths for each N-Quad that is to be revealed. This mechanism
would merely consume the normalized output differently (this, and the
proof mechanism would be modifications to this core spec). It might also
be necessary to generate proof parameters such as a private key/seed
that can be used along with an algorithm to deterministically generate
nonces that are concatenated with each N-Quad to prevent rainbow
table or similar attacks.</div></div>



      </section>

      <section id="proof-purposes"><div class="header-wrapper"><h3 id="x2-2-proof-purposes"><bdi class="secno">2.2 </bdi>Proof Purposes</h3><a class="self-link" href="#proof-purposes" aria-label="Permalink for Section 2.2"></a></div>
        

        <p>
A proof that describes its purpose helps prevent it from being misused for some
other purpose.
        </p>

        <div class="issue" id="issue-container-number-6"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="4"><span>Issue 6</span></div><div class="">Add a mention of JWK's <code>key_ops</code>
parameter and WebCrypto's <code>KeyUsage</code> restrictions; explain that
Proof Purpose serves a similar goal but allows for finer-grained restrictions.
        </div></div>

        <p>
The following is a list of commonly used <a href="#dfn-proof-purpose" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-purpose-1">proof purpose</a> values.
        </p>

        <dl>
          <dt>authentication</dt>
          <dd>
Indicates that a given proof is only to be used for the purposes of an
authentication protocol.
          </dd>
          <dt>assertionMethod</dt>
          <dd>
Indicates that a proof can only be used for making assertions, for example
signing a Verifiable Credential.
          </dd>
          <dt>keyAgreement</dt>
          <dd>
Indicates that a proof is used for for key agreement protocols, such as
Elliptic Curve Diffie Hellman key agreement used by popular encryption
libraries.
          </dd>
          <dt>capabilityDelegation</dt>
          <dd>
Indicates that the proof can only be used for delegating capabilities. See the
Authorization Capabilities [<cite><a class="bibref" data-link-type="biblio" href="#bib-zcap" title="Authorization Capabilities for Linked Data">ZCAP</a></cite>] specification for more detail.
          </dd>
          <dt>capabilityInvocation</dt>
          <dd>
Indicates that the proof can only be used for invoking capabilities. See the
Authorization Capabilities [<cite><a class="bibref" data-link-type="biblio" href="#bib-zcap" title="Authorization Capabilities for Linked Data">ZCAP</a></cite>] specification for more detail.
          </dd>
        </dl>

        <p>
Note: The Authorization Capabilities [<cite><a class="bibref" data-link-type="biblio" href="#bib-zcap" title="Authorization Capabilities for Linked Data">ZCAP</a></cite>] specification defines additional
proof purposes for that use case, such as <code>capabilityInvocation</code> and
<code>capabilityDelegation</code>.
        </p>
      </section>

      <section id="controller-documents"><div class="header-wrapper"><h3 id="x2-3-controller-documents"><bdi class="secno">2.3 </bdi>Controller Documents</h3><a class="self-link" href="#controller-documents" aria-label="Permalink for Section 2.3"></a></div>
        

        <p>
A <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-6">controller document</a> is a set of data that specifies one or more
relationships between a <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-3">controller</a> and a set of data, such as a set of
public cryptographic keys. The <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-7">controller document</a> <em class="rfc2119">SHOULD</em>
contain <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-1">verification relationships</a> that explicitly permit the use of
certain <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-5">verification methods</a> for specific purposes.
        </p>

        <div class="issue" id="issue-container-number-7"><div role="heading" class="issue-title marker" id="h-issue-5" aria-level="4"><span>Issue 7</span></div><div class="">Add examples of common Controller documents, such as
controller documents published on a ledger-based registry, or on a mutable medium in
combination with an integrity protection mechanism such as Hashlinks.
        </div></div>

        <section id="verification-methods"><div class="header-wrapper"><h4 id="x2-3-1-verification-methods"><bdi class="secno">2.3.1 </bdi>Verification Methods</h4><a class="self-link" href="#verification-methods" aria-label="Permalink for Section 2.3.1"></a></div>
          
          <p>
A <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-8">controller document</a> can express <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-6">verification methods</a>, such as
cryptographic public keys, which can be used to <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-1">authenticate</a> or authorize
interactions with the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-4">controller</a> or associated parties. For example, a
cryptographic public key can be used as a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-7">verification method</a> with
respect to a digital signature; in such usage, it verifies that the signer
could use the associated cryptographic private key. <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-8">Verification methods</a>
might take many parameters. An example of this is a set of five cryptographic
keys from which any three are required to contribute to a cryptographic
threshold signature.
          </p>

          <dl>
            <dt><a href="#dfn-verificationmethod" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verificationmethod-1">verificationMethod</a></dt>
            <dd>
              <p>
The <code>verificationMethod</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the value
<em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-9">verification
methods</a>, where each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-10">verification method</a> is expressed using a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a>. The <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-11">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> <em class="rfc2119">MUST</em> include the <code>id</code>,
<code>type</code>, <code>controller</code>, and specific verification material
properties that are determined by the value of <code>type</code> and are defined
in <a href="#verification-material" class="sec-ref"><bdi class="secno">2.3.1.1 </bdi>Verification Material</a>. A <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-12">verification method</a> <em class="rfc2119">MAY</em>
include additional properties. <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-13">Verification methods</a> <em class="rfc2119">SHOULD</em> be registered
in the Data Integrity Specification Registries [TBD - DIS-REGISTRIES].
              </p>

              <dl>
                <dt>id</dt>
                <dd>
                  <p>
The value of the <code>id</code> property for a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-14">verification
method</a> <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that conforms to the
[<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>] syntax.
                  </p>
                </dd>
                <dt>type</dt>
                <dd>
The value of the <code>type</code> property <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that references exactly one <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-15">verification
method</a> type. In order to maximize global interoperability, the
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-16">verification method</a> type <em class="rfc2119">SHOULD</em> be registered in the Data Integrity Specification
Registries [TBD -- DIS-REGISTRIES].
                </dd>
                <dt>controller</dt>
                <dd>
The value of the <code>controller</code> property <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that conforms to the [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>] syntax.
                </dd>
              </dl>
            </dd>
          </dl>

          <div class="example" id="example-example-verification-method-structure">
        <div class="marker">
    <a class="self-link" href="#example-example-verification-method-structure">Example<bdi> 6</bdi></a><span class="example-title">: Example verification method structure</span>
  </div> <pre aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"@context"</span>: [
    <span class="hljs-string">"https://www.w3.org/ns/did/v1"</span>,
    <span class="hljs-string">"https://w3id.org/security/suites/jws-2020/v1"</span>
    <span class="hljs-string">"https://w3id.org/security/suites/ed25519-2020/v1"</span>
  ]
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"did:example:123456789abcdefghi"</span>,
  ...
  <span class="hljs-string">"verificationMethod"</span>: [{
    <span class="hljs-string">"id"</span>: ...,
    <span class="hljs-string">"type"</span>: ...,
    <span class="hljs-string">"controller"</span>: ...,
    <span class="hljs-string">"publicKeyJwk"</span>: ...
  }, {
    <span class="hljs-string">"id"</span>: ...,
    <span class="hljs-string">"type"</span>: ...,
    <span class="hljs-string">"controller"</span>: ...,
    <span class="hljs-string">"publicKeyMultibase"</span>: ...
  }]
}</code></pre>
      </div>

          <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="5"><span>Note</span><span class="issue-label">: Verification method controller(s) and controller(s)</span></div><p class="">
The semantics of the <code>controller</code> property are the same when the
subject of the relationship is the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-9">controller document</a> as when the subject of
the relationship is a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-17">verification method</a>, such as a cryptographic public
key. Since a key can't control itself, and the key controller cannot be inferred
from the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-10">controller document</a>, it is necessary to explicitly express the identity
of the controller of the key. The difference is that the value of
<code>controller</code> for a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-18">verification method</a> is <em>not</em>
necessarily a <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-5">controller</a>. <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-6">controllers</a> are expressed
using the <code><a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-7">controller</a></code> property at the highest level of the
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-11">controller document</a>.
          </p></div>

          <section id="verification-material"><div class="header-wrapper"><h5 id="x2-3-1-1-verification-material"><bdi class="secno">2.3.1.1 </bdi>Verification Material</h5><a class="self-link" href="#verification-material" aria-label="Permalink for Section 2.3.1.1"></a></div>
            

            <p>
Verification material is any information that is used by a process that applies
a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-19">verification method</a>. The <code>type</code> of a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-20">verification
method</a> is expected to be used to determine its compatibility with such
processes. Examples of verification material properties are
<code><a href="#dfn-publickeyjwk" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-publickeyjwk-1">publicKeyJwk</a></code> or <code><a href="#dfn-publickeymultibase" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-publickeymultibase-1">publicKeyMultibase</a></code>. A
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-3">cryptographic suite</a> specification is responsible for specifying the
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-21">verification method</a> <code>type</code> and its associated verification
material. For example, see <a href="https://w3c-ccg.github.io/lds-jws2020/">JSON
Web Signature 2020</a> and <a href="https://w3c-ccg.github.io/lds-ed25519-2020/">Ed25519 Signature 2020</a>.
For all registered <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-22">verification method</a> types and associated verification
material available for <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-8">controllers</a>, please see the Data Integrity
Specification Registries [TBD - DIS-REGISTRIES].
            </p>

            <div class="issue" id="issue-container-number-8"><div role="heading" class="issue-title marker" id="h-issue-6" aria-level="6"><span>Issue 8</span></div><p class="">
Ensuring that cryptographic suites are versioned and tightly scoped to a very
small set of possible key types and signature schemes (ideally one key type and
size and one signature output type) is a design goal for most Data Integrity
cryptographic suites. Historically, this has been done by defining both the
key type and the cryptographic suite that uses the key type in the same
specification. The downside of doing so, however, is that there might be a
proliferation of different key types in multikey that result in different
cryptosuites defining the same key material differently. For example, one
cryptosuite might use compressed Curve P-256 keys while another uses
uncompressed values. If that occurs, it will harm interoperability. It will be
important in the coming months to years to ensure that this does not happen
by fully defining the multikey format in a separate specification so
cryptosuite specifications, such as this one, can refer to the multikey
specification, thus reducing the chances of multikey type proliferation and
improving the chances of maximum interoperability for the multikey format.
            </p></div>

            <p>
To increase the likelihood of interoperable implementations, this specification
limits the number of formats for expressing verification material in a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-12">controller
document</a>. The fewer formats that implementers have to
implement, the more likely it will be that they will support all of them. This
approach attempts to strike a delicate balance between ease of implementation
and supporting formats that have historically had broad deployment.
Two supported verification material properties are listed below:
            </p>

            <dl>
              <dt><dfn id="dfn-publickeyjwk" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">publicKeyJwk</dfn></dt>
              <dd>
                <p>
The <code>publicKeyJwk</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the value <em class="rfc2119">MUST</em>
be a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> representing a JSON Web Key that
conforms to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>]. The <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> <em class="rfc2119">MUST NOT</em>
contain "d", or any other members of the private information class as described
in <a href="https://tools.ietf.org/html/rfc7517#section-8.1.1">Registration
Template</a>. It is <em class="rfc2119">RECOMMENDED</em> that verification methods that use JWKs
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>] to represent their public keys use the value of <code>kid</code> as
their fragment identifier. It is <em class="rfc2119">RECOMMENDED</em> that JWK
<code>kid</code> values are set to the public key fingerprint [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7638" title="JSON Web Key (JWK) Thumbprint">RFC7638</a></cite>]. See
the first key in <a href="#example-various-verification-method-types" class="box-ref">Example<bdi> 7</bdi></a> for
an example of a public key with a compound key identifier.
                </p>
              </dd>
              <dt><dfn id="dfn-publickeymultibase" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">publicKeyMultibase</dfn></dt>
              <dd>
                <p>
The <code>publicKeyMultibase</code> property is <em class="rfc2119">OPTIONAL</em>. This feature is
non-normative. If present, the value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> representation of a [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] encoded
public key.
                </p>
                <p class="advisement">
Note that the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] specification is not yet a standard and is
subject to change. There might be some use cases for this data format
where <code><b>public</b>KeyMultibase</code> is defined, to allow for
expression of public keys, but <code><b>private</b>KeyMultibase</code>
is not defined, to protect against accidental leakage of secret keys.
                </p>
              </dd>
          </dl>

            <p>
A <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-23">verification method</a> <em class="rfc2119">MUST NOT</em> contain multiple verification material
properties for the same material. For example, expressing key material in a
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-24">verification method</a> using both <code>publicKeyJwk</code> and
<code>publicKeyMultibase</code> at the same time is prohibited.
            </p>

            <p>
An example of a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-13">controller document</a> containing <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-25">verification methods</a> using
both properties above is shown below.
            </p>

            <div class="example" id="example-various-verification-method-types">
        <div class="marker">
    <a class="self-link" href="#example-various-verification-method-types">Example<bdi> 7</bdi></a><span class="example-title">: Verification methods using publicKeyJwk and publicKeyMultibase</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/jws-2020/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ]
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "verificationMethod": [{
    "id": "did:example:123#_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A",
    "type": "JsonWebKey2020", <span class="comment">// external (property value)</span>
    "controller": "did:example:123",
    "publicKeyJwk": {
      "crv": "Ed25519", <span class="comment">// external (property name)</span>
      "x": "VCpo2LMLhn6iWku8MKvSLg2ZAoC-nlOyPVQaO3FxVeQ", <span class="comment">// external (property name)</span>
      "kty": "OKP", <span class="comment">// external (property name)</span>
      "kid": "_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A" <span class="comment">// external (property name)</span>
    }
  }, {
    "id": "did:example:123456789abcdefghi#keys-1",
    "type": "Ed25519VerificationKey2020", <span class="comment">// external (property value)</span>
    "controller": "did:example:pqrstuvwxyz0987654321",
    "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
  }],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="multikey"><div class="header-wrapper"><h5 id="x2-3-1-2-multikey"><bdi class="secno">2.3.1.2 </bdi>Multikey</h5><a class="self-link" href="#multikey" aria-label="Permalink for Section 2.3.1.2"></a></div>
            
            <p>
The Multikey data model is a specific type of <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-26">verification method</a> that
utilizes the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="The Multi Codec Encoding Scheme">MULTICODEC</a></cite>] specification to encode key types into a single
binary stream that is then encoded using the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] specification.
To encode a Multikey, the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-27">verification method</a> <code>type</code> <em class="rfc2119">MUST</em> be set to
<code>Multikey</code> and the <code>publicKeyMultibase</code> value <em class="rfc2119">MUST</em> be a [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] encoded
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="The Multi Codec Encoding Scheme">MULTICODEC</a></cite>] value. An example of a Multikey is provided below:
            </p>

            <div class="example" id="example-multikey-encoding-of-a-ed25519-public-key">
        <div class="marker">
    <a class="self-link" href="#example-multikey-encoding-of-a-ed25519-public-key">Example<bdi> 8</bdi></a><span class="example-title">: Multikey encoding of a Ed25519 public key</span>
  </div> <pre class="nohighlight">{
  "@context": ["https://w3id.org/security/suites/multikey/v1"],
  "id": "did:example:123456789abcdefghi#keys-1",
  "type": "Multikey",
  "controller": "did:example:123456789abcdefghi",
  "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
}</pre>
      </div>

            <p>
In the example above, the <code>publicKeyMultibase</code> value starts with the letter <code>z</code>,
which is the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] header that conveys that the binary data is
base58-encoded using the Bitcoin base-encoding alphabet. The decoded binary data
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="The Multi Codec Encoding Scheme">MULTICODEC</a></cite>] header is <code>0xed</code>, which specifies that the remaining data
is a 32-byte raw Ed25519 public key.
            </p>

            <p>
The Multikey data model is also capable of encoding secret keys, sometimes
referred to as <em>private keys</em>.
            </p>

            <div class="example" id="example-multikey-encoding-of-a-ed25519-secret-key">
        <div class="marker">
    <a class="self-link" href="#example-multikey-encoding-of-a-ed25519-secret-key">Example<bdi> 9</bdi></a><span class="example-title">: Multikey encoding of a Ed25519 secret key</span>
  </div> <pre class="nohighlight">{
  "@context": ["https://w3id.org/security/suites/secrets/v1"],
  "id": "did:example:123456789abcdefghi#keys-1",
  "type": "Multikey",
  "controller": "did:example:123456789abcdefghi",
  "secretKeyMultibase": "z3u2fprgdREFtGakrHr6zLyTeTEZtivDnYCPZmcSt16EYCER"
}</pre>
      </div>

            <p>
In the example above, the <code>secretKeyMultibase</code> value starts with the letter <code>z</code>,
which is the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] header that conveys that the binary data is
base58-encoded using the Bitcoin base-encoding alphabet. The decoded binary data
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="The Multi Codec Encoding Scheme">MULTICODEC</a></cite>] header is <code>0x1300</code>, which specifies that the remaining data
is a 32-byte raw Ed25519 private key.
            </p>

          </section>

          <section id="referring-to-verification-methods"><div class="header-wrapper"><h5 id="x2-3-1-3-referring-to-verification-methods"><bdi class="secno">2.3.1.3 </bdi>Referring to Verification Methods</h5><a class="self-link" href="#referring-to-verification-methods" aria-label="Permalink for Section 2.3.1.3"></a></div>
            
            <p>
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-28">Verification methods</a> can be embedded in or referenced from properties
associated with various <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-2">verification relationships</a> as described in <a href="#verification-relationships" class="sec-ref"><bdi class="secno">2.3.2 </bdi>Verification Relationships</a>. Referencing <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-29">verification methods</a>
allows them to be used by more than one <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-3">verification relationship</a>.
            </p>

            <p>
If the value of a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-30">verification method</a> property is a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a>, the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-31">verification method</a> has been
embedded and its properties can be accessed directly. However, if the value is a
URL <a href="https://infra.spec.whatwg.org/#string">string</a>, the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-32">verification method</a> has
been included by reference and its properties will need to be retrieved from
elsewhere in the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-14">controller document</a> or from another <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-15">controller document</a>. This
is done by dereferencing the URL and searching the resulting <a href="#dfn-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-resources-1">resource</a> for a
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-33">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> with an
<code>id</code> property whose value matches the URL.
            </p>

            <div class="example" id="example-embedding-and-referencing-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-embedding-and-referencing-verification-methods">Example<bdi> 10</bdi></a><span class="example-title">: Embedding and referencing verification methods</span>
  </div> <pre class="nohighlight">    {
<span class="comment">...</span>

      "authentication": [
        <span class="comment">// this key is referenced and might be used by</span>
        <span class="comment">// more than one verification relationship</span>
        "did:example:123456789abcdefghi#keys-1",
        <span class="comment">// this key is embedded and may *only* be used for authentication</span>
        {
          "id": "did:example:123456789abcdefghi#keys-2",
          "type": "Ed25519VerificationKey2020", <span class="comment">// external (property value)</span>
          "controller": "did:example:123456789abcdefghi",
          "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
        }
      ],

<span class="comment">...</span>
    }</pre>
      </div>
          </section>
        </section>

        <section id="verification-relationships"><div class="header-wrapper"><h4 id="x2-3-2-verification-relationships"><bdi class="secno">2.3.2 </bdi>Verification Relationships</h4><a class="self-link" href="#verification-relationships" aria-label="Permalink for Section 2.3.2"></a></div>
          

          <p>
A <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-4">verification relationship</a> expresses the relationship between the
<a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-9">controller</a> and a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-34">verification method</a>.
          </p>
          <p>
Different <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-5">verification relationships</a> enable the associated
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-35">verification methods</a> to be used for different purposes. It is up to a
<em>verifier</em> to ascertain the validity of a verification attempt by
checking that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-36">verification method</a> used is contained in the
appropriate <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-6">verification relationship</a> property of the
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-16">controller document</a>.
          </p>
          <p>
The <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-7">verification relationship</a> between the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-10">controller</a> and the
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-37">verification method</a> is explicit in the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-17">controller document</a>.
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-38">Verification methods</a> that are not associated with a particular
<a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-8">verification relationship</a> cannot be used for that <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-9">verification
relationship</a>. For example, a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-39">verification method</a> in the value of
the <code><a href="#dfn-authentication" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authentication-1">authentication</a></code> property cannot be used to engage in
key agreement protocols with the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-11">controller</a>—the value of the
<code><a href="#dfn-keyagreement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-keyagreement-1">keyAgreement</a></code> property needs to be used for that.
          </p>
          <p>
The <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-18">controller document</a> does not express revoked keys using a <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-10">verification
relationship</a>. If a referenced verification method is not in the latest
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-19">controller document</a> used to dereference it, then that verification method is
considered invalid or revoked.
          </p>
          <p>
The following sections define several useful <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-11">verification relationships</a>.
A <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-20">controller document</a> <em class="rfc2119">MAY</em> include any of these, or other properties, to
express a specific <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-12">verification relationship</a>. In order to maximize global
interoperability, any such properties used <em class="rfc2119">SHOULD</em> be registered in the
Data Integrity Specification Registries [TBD: DIS-REGISTRIES].
          </p>

          <section id="authentication"><div class="header-wrapper"><h5 id="x2-3-2-1-authentication"><bdi class="secno">2.3.2.1 </bdi>Authentication</h5><a class="self-link" href="#authentication" aria-label="Permalink for Section 2.3.2.1"></a></div>
            

            <p>
The <code>authentication</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-13">verification relationship</a> is used to
specify how the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-12">controller</a> is expected to be <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-2">authenticated</a>, for
purposes such as logging into a website or engaging in any sort of
challenge-response protocol.
            </p>

            <dl>
              <dt><dfn id="dfn-authentication" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">authentication</dfn></dt>
              <dd>
The <code>authentication</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the associated
value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of one or more
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-40">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-41">verification method</a> <em class="rfc2119">MAY</em> be embedded or
referenced.
              </dd>
            </dl>

            <div class="example" id="example-authentication-property-containing-three-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-authentication-property-containing-three-verification-methods">Example<bdi> 11</bdi></a><span class="example-title">: Authentication property
                          containing three verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "authentication": [
    <span class="comment">// this method can be used to authenticate as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for authentication, it may not</span>
    <span class="comment">// be used for any other proof purpose, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
      "id": "did:example:123456789abcdefghi#keys-2",
      "type": "Ed25519VerificationKey2020",
      "controller": "did:example:123456789abcdefghi",
      "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>

            <p>
If authentication is established, it is up to the application to decide what to
do with that information.
            </p>
            <p>
This is useful to any <em>authentication verifier</em> that needs to check to
see if an entity that is attempting to <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-3">authenticate</a> is, in fact,
presenting a valid proof of authentication. When a <em>verifier</em> receives
some data (in some protocol-specific format) that contains a proof that was made
for the purpose of "authentication", and that says that an entity is identified
by the <code>id</code>, then that <em>verifier</em> checks to ensure that the proof can be
verified using a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-42">verification method</a> (e.g., public key) listed under
<code><a href="#dfn-authentication" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authentication-2">authentication</a></code> in the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-21">controller document</a>.
            </p>
            <p>
Note that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-43">verification method</a> indicated by the
<code><a href="#dfn-authentication" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authentication-3">authentication</a></code> property of a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-22">controller document</a> can
only be used to <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-4">authenticate</a> the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-13">controller</a>. To
<a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-5">authenticate</a> a different <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-14">controller</a>, the entity associated with
the value of <code>controller</code> needs to <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-6">authenticate</a> with its
<em>own</em> <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-23">controller document</a> and associated
<code><a href="#dfn-authentication" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authentication-4">authentication</a></code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-14">verification relationship</a>.
            </p>
          </section>

          <section id="assertion"><div class="header-wrapper"><h5 id="x2-3-2-2-assertion"><bdi class="secno">2.3.2.2 </bdi>Assertion</h5><a class="self-link" href="#assertion" aria-label="Permalink for Section 2.3.2.2"></a></div>
            

            <p>
The <code>assertionMethod</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-15">verification relationship</a> is used to
specify how the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-15">controller</a> is expected to express claims, such as for
the purposes of issuing a Verifiable Credential [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model" title="Verifiable Credentials Data Model v1.1">VC-DATA-MODEL</a></cite>].
            </p>

            <dl>
              <dt><dfn id="dfn-assertionmethod" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">assertionMethod</dfn></dt>
              <dd>
The <code>assertionMethod</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the
associated value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
one or more <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-44">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-45">verification method</a> <em class="rfc2119">MAY</em> be
embedded or referenced.
              </dd>
            </dl>

            <p>
This property is useful, for example, during the processing of a <a href="#dfn-verifiable-credentials" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verifiable-credentials-1">verifiable
credential</a> by a verifier. During verification, a verifier checks to see if a
<a href="#dfn-verifiable-credentials" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verifiable-credentials-2">verifiable credential</a> contains a proof created by the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-16">controller</a>
by checking that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-46">verification method</a> used to assert the proof is
associated with the <code><a href="#dfn-assertionmethod" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-assertionmethod-1">assertionMethod</a></code> property in the
corresponding <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-24">controller document</a>.
            </p>

            <div class="example" id="example-assertion-method-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-assertion-method-property-containing-two-verification-methods">Example<bdi> 12</bdi></a><span class="example-title">: Assertion method property
                        containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "assertionMethod": [
    <span class="comment">// this method can be used to assert statements as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for assertion of statements, it is not</span>
    <span class="comment">// used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using a reference</span>
    {
      "id": "did:example:123456789abcdefghi#keys-2",
      "type": "Ed25519VerificationKey2020", <span class="comment">// external (property value)</span>
      "controller": "did:example:123456789abcdefghi",
      "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="key-agreement"><div class="header-wrapper"><h5 id="x2-3-2-3-key-agreement"><bdi class="secno">2.3.2.3 </bdi>Key Agreement</h5><a class="self-link" href="#key-agreement" aria-label="Permalink for Section 2.3.2.3"></a></div>
            

            <p>
The <code>keyAgreement</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-16">verification relationship</a> is used to
specify how an entity can generate encryption material in order to transmit
confidential information intended for the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-17">controller</a>, such as for
the purposes of establishing a secure communication channel with the recipient.
            </p>

            <dl>
              <dt><dfn id="dfn-keyagreement" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">keyAgreement</dfn></dt>
              <dd>
The <code>keyAgreement</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the associated
value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of one or more
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-47">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-48">verification method</a> <em class="rfc2119">MAY</em> be embedded or
referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when encrypting a message intended
for the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-18">controller</a>. In this case, the counterparty uses the
cryptographic public key information in the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-49">verification method</a> to wrap a
decryption key for the recipient.
            </p>

            <div class="example" id="example-key-agreement-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-key-agreement-property-containing-two-verification-methods">Example<bdi> 13</bdi></a><span class="example-title">: Key agreement property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/did/v1",
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "keyAgreement": [
    <span class="comment">// this method can be used to perform key agreement as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for key agreement usage, it will not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
      "id": "did:example:123#zC9ByQ8aJs8vrNXyDhPHHNNMSHPcaSgNpjjsBYpMMjsTdS",
      "type": "X25519KeyAgreementKey2019", <span class="comment">// external (property value)</span>
      "controller": "did:example:123",
      "publicKeyMultibase": "z6LSn6p3HRxx1ZZk1dT9VwcfTBCYgtNWdzdDMKPZjShLNWG7"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="capability-invocation"><div class="header-wrapper"><h5 id="x2-3-2-4-capability-invocation"><bdi class="secno">2.3.2.4 </bdi>Capability Invocation</h5><a class="self-link" href="#capability-invocation" aria-label="Permalink for Section 2.3.2.4"></a></div>
            

            <p>
The <code>capabilityInvocation</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-17">verification relationship</a> is used
to specify a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-50">verification method</a> that might be used by the
<a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-19">controller</a> to invoke a cryptographic capability, such as the
authorization to update the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-25">controller document</a>.
            </p>

            <dl>
              <dt><dfn id="dfn-capabilityinvocation" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">capabilityInvocation</dfn></dt>
              <dd>
The <code>capabilityInvocation</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the
associated value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
one or more <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-51">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-52">verification method</a> <em class="rfc2119">MAY</em> be
embedded or referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when a <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-20">controller</a> needs to
access a protected HTTP API that requires authorization in order to use it. In
order to authorize when using the HTTP API, the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-21">controller</a>
uses a capability that is associated with a particular URL that is
exposed via the HTTP API. The invocation of the capability could be
expressed in a number of ways, e.g., as a digitally signed
message that is placed into the HTTP Headers.
            </p>
            <p>
The server providing the HTTP API is the <em>verifier</em> of the capability and
it would need to verify that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-53">verification method</a> referred to by the
invoked capability exists in the <code><a href="#dfn-capabilityinvocation" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-capabilityinvocation-1">capabilityInvocation</a></code>
property of the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-26">controller document</a>. The verifier would also check to make sure
that the action being performed is valid and the capability is appropriate for
the resource being accessed. If the verification is successful, the server has
cryptographically determined that the invoker is authorized to access the
protected resource.
            </p>

            <div class="example" id="example-capability-invocation-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-capability-invocation-property-containing-two-verification-methods">Example<bdi> 14</bdi></a><span class="example-title">: Capability invocation property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "capabilityInvocation": [
    <span class="comment">// this method can be used to invoke capabilities as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for capability invocation usage, it will not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
    "id": "did:example:123456789abcdefghi#keys-2",
    "type": "Ed25519VerificationKey2020", <span class="comment">// external (property value)</span>
    "controller": "did:example:123456789abcdefghi",
    "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="capability-delegation"><div class="header-wrapper"><h5 id="x2-3-2-5-capability-delegation"><bdi class="secno">2.3.2.5 </bdi>Capability Delegation</h5><a class="self-link" href="#capability-delegation" aria-label="Permalink for Section 2.3.2.5"></a></div>
            

            <p>
The <code>capabilityDelegation</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-18">verification relationship</a> is used
to specify a mechanism that might be used by the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-22">controller</a> to delegate
a cryptographic capability to another party, such as delegating the authority
to access a specific HTTP API to a subordinate.
            </p>

            <dl>
              <dt><dfn class="lint-ignore" id="dfn-capabilitydelegation" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">capabilityDelegation</dfn></dt>
              <dd>
The <code>capabilityDelegation</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the
associated value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
one or more <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-54">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-55">verification method</a> <em class="rfc2119">MAY</em> be
embedded or referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when a <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-23">controller</a> chooses
to delegate their capability to access a protected HTTP API to a party other
than themselves. In order to delegate the capability, the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-24">controller</a>
would use a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-56">verification method</a> associated with the
<code>capabilityDelegation</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-19">verification relationship</a> to
cryptographically sign the capability over to another <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-25">controller</a>. The
delegate would then use the capability in a manner that is similar to the
example described in <a href="#capability-invocation" class="sec-ref"><bdi class="secno">2.3.2.4 </bdi>Capability Invocation</a>.
            </p>

            <div class="example" id="example-capability-delegation-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-capability-delegation-property-containing-two-verification-methods">Example<bdi> 15</bdi></a><span class="example-title">: Capability Delegation property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "capabilityDelegation": [
    <span class="comment">// this method can be used to perform capability delegation as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for granting capabilities; it will not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
    "id": "did:example:123456789abcdefghi#keys-2",
    "type": "Ed25519VerificationKey2020", <span class="comment">// external (property value)</span>
    "controller": "did:example:123456789abcdefghi",
    "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>
        </section>
      </section>

    </section>

    <section id="multiple-proofs"><div class="header-wrapper"><h2 id="x3-multiple-proofs"><bdi class="secno">3. </bdi>Multiple Proofs</h2><a class="self-link" href="#multiple-proofs" aria-label="Permalink for Section 3."></a></div>
      
      <p>
The Data Integrity specification supports the concept of multiple
proofs in a single document. There are two types of multi-proof
approaches that are identified: Proof Sets (un-ordered) and Proof Chains
(ordered).
      </p>

      <section id="proof-sets"><div class="header-wrapper"><h3 id="x3-1-proof-sets"><bdi class="secno">3.1 </bdi>Proof Sets</h3><a class="self-link" href="#proof-sets" aria-label="Permalink for Section 3.1"></a></div>
        
        <p>
A proof set is useful when the same data needs to be secured by multiple
entities, but where the order of proofs does not matter,
such as in the case of a set of signatures on a contract. A proof set,
which has no order, is represented by associating a set of proofs
with the <code>proof</code> key in a document.
        </p>
        <div class="example" id="example-a-proof-set-in-a-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-proof-set-in-a-data-document">Example<bdi> 16</bdi></a><span class="example-title">: A proof set in a data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs">{
  "@context": [
    {"title": "https://schema.org#title"},
    "https://w3id.org/security/suites/ed25519-2020/v1"
],
  "title": "Hello world!",
  "proof": [{
    "type": "Ed25519Signature2020",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://ldi.example/issuer/1#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4oey5q2M3XKaxup3tmzN4DRFTLVqpLMweBrSxMY2xHX5XTYVQeVbY8nQA
      VHMrXFkXJpmEcqdoDwLWxaqA3Q1geV6"
  }, {
    "type": "Ed25519Signature2020",
    "created": "2020-11-05T13:08:49Z",
    "verificationMethod": "https://pfps.example/issuer/2#z6MkGskxnGjLrk3gKS2mes
      DpuwRBokeWcmrgHxUXfnncxiZP",
    "proofPurpose": "assertionMethod",
    "proofValue": "z5QLBrp19KiWXerb8ByPnAZ9wujVFN8PDsxxXeMoyvDqhZ6Qnzr5CG9876
      zNht8BpStWi8H2Mi7XCY3inbLrZrm95"
  }]
}</code></pre>
      </div>

      </section>

      <section id="proof-chains"><div class="header-wrapper"><h3 id="x3-2-proof-chains"><bdi class="secno">3.2 </bdi>Proof Chains</h3><a class="self-link" href="#proof-chains" aria-label="Permalink for Section 3.2"></a></div>
        
        <p>
A proof chain is useful when the same data needs to be signed by
multiple entities and the order of when the proofs occurred matters,
such as in the case of a notary counter-signing a proof that had been
created on a document. A proof chain, where order needs to be preserved, is
represented by associating an ordered list of proofs with the
<code>proofChain</code> key in a document.
        </p>
        <div class="example" id="example-a-proof-chain-in-a-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-proof-chain-in-a-data-document">Example<bdi> 17</bdi></a><span class="example-title">: A proof chain in a data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs">{
  "@context": [
    {"title": "https://schema.org#title"},
    "https://w3id.org/security/suites/ed25519-2020/v1"
],
  "title": "Hello world!",
  "proofChain": [{
    "type": "Ed25519Signature2020",
    "created": "2020-11-05T19:23:42Z",
    "verificationMethod": "https://ldi.example/issuer/1#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "zVbY8nQAVHMrXFkXJpmEcqdoDwLWxaqA3Q1geV64oey5q2M3XKaxup3tmzN4
      DRFTLVqpLMweBrSxMY2xHX5XTYVQe"
  }, {
    "type": "Ed25519Signature2020",
    "created": "2020-11-05T21:28:14Z",
    "verificationMethod": "https://pfps.example/issuer/2#z6MkGskxnGjLrk3gKS2mes
      DpuwRBokeWcmrgHxUXfnncxiZP",
    "proofPurpose": "assertionMethod",
    "proofValue": "z6Qnzr5CG9876zNht8BpStWi8H2Mi7XCY3inbLrZrm955QLBrp19KiWXerb8
      ByPnAZ9wujVFN8PDsxxXeMoyvDqhZ"
  }]
}</code></pre>
      </div>

      </section>

    </section>

    <section class="normative" id="proof-types"><div class="header-wrapper"><h2 id="x4-proof-types"><bdi class="secno">4. </bdi>Proof Types</h2><a class="self-link" href="#proof-types" aria-label="Permalink for Section 4."></a></div>
      

      <section id="signatures"><div class="header-wrapper"><h3 id="x4-1-signatures"><bdi class="secno">4.1 </bdi>Signatures</h3><a class="self-link" href="#signatures" aria-label="Permalink for Section 4.1"></a></div>
        

        <p>
A <dfn id="dfn-data-integrity-signature" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">data integrity signature</dfn> is a type of cryptographic proof, and is
comprised of information about the signature, parameters required to verify
it, and the signature value itself. All of this information is provided using
Linked Data vocabularies such as the [<cite><a class="bibref" data-link-type="biblio" href="#bib-security-vocabulary" title="The Security Vocabulary">SECURITY-VOCABULARY</a></cite>].
        </p>

        <p>
          A <a href="#dfn-data-integrity-signature" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-signature-1">data integrity signature</a> typically includes at least the
          following attributes:
        </p>

        <dl style="margin-left: 1em;">
          <dt>type (required)</dt><dt>
          </dt><dd>
A URI that identifies the digital <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-4">cryptographic suite</a> that was used to create the
signature. For example: <code>Ed25519Signature2020</code>.</dd>
          <dt>created (required)</dt><dt>
          </dt><dd>
The string value of an [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso8601" title="Representation of dates and times. ISO 8601:2004.">ISO8601</a></cite>] combined date and time string generated
by the <a href="#proof-algorithm">Proof Algorithm</a>.
          </dd>

          <dt>domain (optional)</dt><dt>
          </dt><dd>
A string value specifying the restricted <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-6">domain</a> of the signature.
          </dd>
          <dt><dfn class="lint-ignore" id="dfn-nonce" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">nonce</dfn> (optional, but strongly recommended)</dt><dt>
          </dt><dd>
A string value that is included in the digital signature and <em class="rfc2119">MUST</em> only be
used once for a particular <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-7">domain</a> and window of time. This
value is used to mitigate replay attacks.
          </dd>
          <dt><dfn class="lint-ignore" id="dfn-signature-value" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">signature value</dfn> (required)</dt><dt>
          </dt><dd>
One of any number of valid representations of <em>signature value</em>
generated by the <a href="#proof-algorithm">Proof Algorithm</a>.
Example: <code>jws</code> for detached JSON Web Signatures.
</dd>
        </dl>

        <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span>Note</span></div><p class="">
The terms <code>type</code>, <code>created</code>, <code>domain</code>,
<code>nonce</code>, and <code>jws</code> above map to URLs. The vocabulary where
these terms are defined is the [<cite><a class="bibref" data-link-type="biblio" href="#bib-security-vocabulary" title="The Security Vocabulary">SECURITY-VOCABULARY</a></cite>].
        </p></div>

        <p>
A signature can be added to a data document like the following:
        </p>

        <div class="example" id="example-a-simple-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-data-document">Example<bdi> 18</bdi></a><span class="example-title">: A simple data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"@context"</span>: {<span class="hljs-attr">"title"</span>: <span class="hljs-string">"https://schema.org#title"</span>},
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Hello world!"</span>,
}</code></pre>
      </div>

        <p>
by adding the parameters outlined in this section:
        </p>

        <div class="example" id="example-a-simple-signed-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-signed-data-document">Example<bdi> 19</bdi></a><span class="example-title">: A simple signed data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs">{
  "@context": [
    {"title": "https://schema.org#title"},
    "https://w3id.org/security/suites/ed25519-2020/v1"
],
  "title": "Hello world!",
  "proof": {
    "type": "Ed25519Signature2020",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://ldi.example/issuer#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4oey5q2M3XKaxup3tmzN4DRFTLVqpLMweBrSxMY2xHX5XTYVQeVbY8nQA
      VHMrXFkXJpmEcqdoDwLWxaqA3Q1geV6"
  }
}</code></pre>
      </div>

        <p>
The signature example above uses the <code>Ed25519Signature2020</code>
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-5">cryptographic suite</a> to produce a verifiable digital signature.
        </p>

<div class="issue" id="issue-container-number-9"><div role="heading" class="issue-title marker" id="h-issue-7" aria-level="4"><span>Issue 9</span></div><div class="">Create a separate section detailing an optional mechanism
for authenticating public key control via bi-directional links. How
to establish trust in key controller entities is out of scope but examples can
be given.</div></div>

<div class="issue" id="issue-container-number-10"><div role="heading" class="issue-title marker" id="h-issue-8" aria-level="4"><span>Issue 10</span></div><div class="">Specify algorithm agility mechanisms (additional attributes
from the security vocab can be used to indicate other signing and hash
algorithms). Rewrite algorithms to be parameterized on this basis and
move <code>RsaSignature2018</code> definition to a single supported
mechanism; specify its identifier as a URL. In order to make it easy to
specify a variety of combinations of algorithms, introduce a core
type <code>LinkedDataSignature</code> that allows for easy filtering/discover of
signature nodes, but that type on its own doesn't specify any default
signature or hash algorithms, those must be given via other properties in the
nodes.</div></div>

<div class="issue" id="issue-container-number-11"><div role="heading" class="issue-title marker" id="h-issue-9" aria-level="4"><span>Issue 11</span></div><div class="">Add a note indicating that this specification should not
be construed to indicate that public key controllers should be restricted to a
single public key or that systems that use this spec and involve real people
should identify each person as only ever being a single entity rather than
perhaps N entities with M keys. There are no such restrictions and in many
cases those kinds of restrictions are ill-advised due to privacy
considerations.</div></div>

<div class="issue" id="issue-container-number-12"><div role="heading" class="issue-title marker" id="h-issue-10" aria-level="4"><span>Issue 12</span></div><div class="">Add an explicit check on key type to prevent an
attacker from selecting an algorithm that may abuse how the key is
used/interpreted.</div></div>

<div class="issue" id="issue-container-number-13"><div role="heading" class="issue-title marker" id="h-issue-11" aria-level="4"><span>Issue 13</span></div><div class="">Add a note indicating that selective disclosure signature
mechanisms can be compatible with data integrity signatures; for example,
an algorithm could produce a merkle tree from a canonicalized set of
N-Quads and then sign the root hash. Disclosure would involve including
the merkle paths for each N-Quad that is to be revealed. This mechanism
would merely consume the normalized output differently (this, and the
proof mechanism would be modifications to this core spec). It may also
be necessary to generate signature parameters such as a private key/seed
that can be used along with an algorithm to deterministically generate
nonces that are concatenated with each N-Quad to prevent rainbow
table or similar attacks.</div></div>

      </section>

      <section id="other-proof-types"><div class="header-wrapper"><h3 id="x4-2-other-proof-types"><bdi class="secno">4.2 </bdi>Other Proof Types</h3><a class="self-link" href="#other-proof-types" aria-label="Permalink for Section 4.2"></a></div>
        

        <div class="issue" id="issue-container-number-14"><div role="heading" class="issue-title marker" id="h-issue-12" aria-level="4"><span>Issue 14</span></div><div class="">TODO: Add links and examples to proof types that
are not data integrity signatures, such as proof of existence, proof of work,
proof of elapsed time, and proof of registration.</div></div>
      </section>
    </section>

    <section id="advanced-terminology"><div class="header-wrapper"><h2 id="x5-advanced-terminology"><bdi class="secno">5. </bdi>Advanced Terminology</h2><a class="self-link" href="#advanced-terminology" aria-label="Permalink for Section 5."></a></div>
      
      <p>
These terms are relevant only to implementors of new <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-6">cryptographic suite</a>s.
      </p>

      <dl>
        <dt><dfn id="dfn-canonicalization-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">canonicalization algorithm</dfn></dt>
        <dd>
An algorithm that takes an input document that has more than one possible
representation and always transforms it into a deterministic representation. For
example, alphabetically sorting a list of items is a type canonicalization. This
process is sometimes also called <em>normalization</em>.
        </dd>
        <dt><dfn id="dfn-message-digest-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">message digest algorithm</dfn></dt>
        <dd>
An algorithm that takes an input message and produces a cryptographic
output message that is often many orders of magnitude smaller than the
input message. These algorithms are often 1) very fast, 2)
non-reversible, 3) cause the output to change significantly when even one
bit of the input message changes, and 4) make it infeasible to find two
different inputs for the same output.
        </dd>
        <dt><dfn id="dfn-proof-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof algorithm</dfn></dt>
        <dd>
An algorithm that takes an input message and produces an output value where the
receiver of the message can mathematically verify that the message has not
been modified in transit and came from someone possessing a particular secret.
        </dd>
      </dl>
    </section>

    <section id="creating-new-proof-types"><div class="header-wrapper"><h2 id="x6-creating-new-proof-types"><bdi class="secno">6. </bdi>Creating New Proof Types</h2><a class="self-link" href="#creating-new-proof-types" aria-label="Permalink for Section 6."></a></div>
      
      <p>
A data integrity proof is designed to be easy to use by developers and therefore
strives to minimize the amount of information one has to remember to generate a
proof. Often, just the <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-7">cryptographic suite</a> name (e.g.
<code>Ed25519Signature2020</code>) is required from developers to initiate the
creation of a proof. These <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-8">cryptographic suite</a>s are often created or
reviewed by people that have the requisite cryptographic training to ensure that
safe combinations of cryptographic primitives are used.
      </p>
      <p>
This section details the cryptographic primitives that are available to
<a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-5">proof type</a> developers.
      </p>

      <p>
At a minimum, a <a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-6">proof type</a> is expected have the following attributes:
      </p>

      <dl style="margin-left: 1em;">
        <dt>id</dt>
        <dd>
A URL that identifies the <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-9">cryptographic suite</a>.
For example: <code>https://w3id.org/security#Ed25519Signature2020</code>.
        </dd>
        <dt>type</dt>
        <dd>
The value <code>ProofSuite</code>.
        </dd>
        <dt>canonicalizationAlgorithm</dt>
        <dd>
A URL that identifies the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-2">canonicalization algorithm</a> to use on the
<var>document</var>. For example:
<code>https://w3id.org/security#URDNA2015</code>.
        </dd>
        <dt>digestAlgorithm</dt>
        <dd>
A URL that identifies the <a href="#dfn-message-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-message-digest-algorithm-2">message digest algorithm</a> to use on the
<var>canonicalized document</var>. For example:
<code>https://www.ietf.org/assignments/jwa-parameters#SHA256</code>
        </dd>
        <dt>proofAlgorithm</dt>
        <dd>
A URL that identifies the <a href="#dfn-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-algorithm-2">proof algorithm</a> to use on the
<var>data to be signed</var>. For example:
<code>https://w3id.org/security#ed25519</code>
        </dd>
      </dl>

      <p>
A complete example of a <a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-7">proof type</a> is shown in the next example:
      </p>

      <div class="example" id="example-20">
        <div class="marker">
    <a class="self-link" href="#example-20">Example<bdi> 20</bdi></a>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"https://w3id.org/security#Ed25519Signature2020"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Ed25519VerificationKey2020"</span>,
  <span class="hljs-attr">"canonicalizationAlgorithm"</span>: <span class="hljs-string">"https://w3id.org/security#URDNA2015"</span>,
  <span class="hljs-attr">"digestAlgorithm"</span>: <span class="hljs-string">"https://www.ietf.org/assignments/jwa-parameters#SHA256"</span>,
  <span class="hljs-attr">"signatureAlgorithm"</span>: <span class="hljs-string">"https://w3id.org/security#ed25519"</span>
}</code></pre>
      </div>
    </section>

    <section id="algorithms"><div class="header-wrapper"><h2 id="x7-algorithms"><bdi class="secno">7. </bdi>Algorithms</h2><a class="self-link" href="#algorithms" aria-label="Permalink for Section 7."></a></div>
      

      <p>
The algorithms defined below are generalized in that they require a specific
<a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-3">canonicalization algorithm</a>, <a href="#dfn-message-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-message-digest-algorithm-3">message digest algorithm</a>, and
<a href="#dfn-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-algorithm-3">proof algorithm</a> to be used to achieve the algorithm's intended
outcome.
      </p>

      <section class="normative" id="proof-algorithm"><div class="header-wrapper"><h3 id="x7-1-proof-algorithm"><bdi class="secno">7.1 </bdi>Proof Algorithm</h3><a class="self-link" href="#proof-algorithm" aria-label="Permalink for Section 7.1"></a></div>
        

<div class="issue" id="issue-container-number-15"><div role="heading" class="issue-title marker" id="h-issue-13" aria-level="4"><span>Issue 15</span></div><div class="">The proof parameters should be included as headers
and values in the data to be signed.</div></div>

        <p>
The following algorithm specifies how to create a digital proof that can
be later used to verify the authenticity and integrity of a
<a href="#dfn-unsigned-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-unsigned-data-document-2">unsigned data document</a>. A <a href="#dfn-unsigned-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-unsigned-data-document-3">unsigned data document</a>,
<var>document</var>, <a href="#dfn-proof-options" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-options-1">proof options</a>, <var>options</var>,
and a <a href="#dfn-private-key" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-private-key-2">private key</a>, <var>privateKey</var>, are required inputs.
The <a href="#dfn-proof-options" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-options-2">proof options</a> <em class="rfc2119">MUST</em> contain an identifier for the
public/private key pair, and an [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso8601" title="Representation of dates and times. ISO 8601:2004.">ISO8601</a></cite>] combined date and
time string, <var>created</var>, containing the current date and time,
accurate to at least one second, in Universal Time Code format. A <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-8">domain</a> might also be specified in the <var>options</var>. A
<a href="#dfn-signed-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signed-data-document-1">signed data document</a> is produced as output. Whenever this
algorithm encodes strings, it <em class="rfc2119">MUST</em> use UTF-8 encoding.
        </p>

        <ol class="algorithm">
          <li>
Create a copy of <var>document</var>, hereafter referred to as <var>output</var>.
          </li>
          <li>
Generate a <var>canonicalized document</var> by canonicalizing
<var>document</var> according to a <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-4">canonicalization algorithm</a>
(e.g. the <em>URDNA2015</em> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-c14n" title="RDF Dataset Normalization">RDF-DATASET-C14N</a></cite>] algorithm).
        </li>
          <li>
Create a value <var>tbs</var> that represents the data to be signed, and
set it to the result of running the
<a href="#create-verify-hash-algorithm">Create Verify Hash Algorithm</a>,
passing the information in <var>options</var>.
          </li>
          <li>
Digitally sign <var>tbs</var> using the <var>privateKey</var> and the
the <var>digital proof algorithm</var> (e.g. JSON Web Proof using
<em>RSASSA-PKCS1-v1_5</em> algorithm). The resulting string is the
<a href="#dfn-proofvalue" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proofvalue-1">proofValue</a>.
          </li>
          <li>
Add a <code>proof</code> node to <var>output</var> containing
a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-6">data integrity proof</a> using the appropriate
<var>type</var> and <a href="#dfn-proofvalue" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proofvalue-2">proofValue</a> values as well as
all of the data in the <var>proof options</var> (e.g.
<var>created</var>, and if given, any additional proof
options such as <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-9">domain</a>).
          </li>
          <li>
Return <var>output</var> as the <a href="#dfn-signed-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signed-data-document-2">signed data document</a>.
          </li>
        </ol>

      </section>

      <section id="proof-verification-algorithm"><div class="header-wrapper"><h3 id="x7-2-proof-verification-algorithm"><bdi class="secno">7.2 </bdi>Proof Verification Algorithm</h3><a class="self-link" href="#proof-verification-algorithm" aria-label="Permalink for Section 7.2"></a></div>
        
        <div class="issue" id="issue-container-number-16"><div role="heading" class="issue-title marker" id="h-issue-14" aria-level="4"><span>Issue 16</span></div><p class="">
This algorithm is highly specific to digital signatures and needs to be
generalized to other proof mechanisms such as Equihash.
        </p></div>

        <p>
The following algorithm specifies how to check the authenticity and
integrity of a <a href="#dfn-signed-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signed-data-document-3">signed data document</a> by verifying its
digital proof. This algorithm takes a
<a href="#dfn-signed-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signed-data-document-4">signed data document</a>, <var>signed document</var> and
outputs a <code>true</code> or <code>false</code> value based on whether or
not the digital proof on <var>signed document</var> was verified. Whenever
this algorithm encodes strings, it <em class="rfc2119">MUST</em> use UTF-8 encoding.
        </p>

<div class="issue" id="issue-container-number-17"><div role="heading" class="issue-title marker" id="h-issue-15" aria-level="4"><span>Issue 17</span></div><div class="">Specify how the public key can be obtained, through
some out-of-band process and passed in or it can be retrieved by
derefencing its URL identifier, etc.</div></div>

        <ol class="algorithm">
          <li>
Get the <a href="#dfn-public-key" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-public-key-1">public key</a> by dereferencing its URL identifier in the
<code>proof</code> node of the default graph of <var>signed document</var>.
Confirm that the <a href="#dfn-unsigned-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-unsigned-data-document-4">unsigned data document</a> that describes the <a href="#dfn-public-key" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-public-key-2">public
key</a> specifies its controller and that its controllers's URL identifier can
be dereferenced to reveal a bi-directional link back to the key. Ensure that the
key's controller is a trusted entity before proceeding to the next step.
          </li>
          <li>
Let <var>document</var> be a copy of <var>signed document</var>.
          </li>
          <li>
Remove any <code>proof</code> nodes from the default graph in
<var>document</var> and save it as <var>proof</var>.
          </li>
          <li>
Generate a <var>canonicalized document</var> by canonicalizing
<var>document</var> according to the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-5">canonicalization algorithm</a>
(e.g. the <em>URDNA2015</em> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-c14n" title="RDF Dataset Normalization">RDF-DATASET-C14N</a></cite>] algorithm).
          </li>
          <li>
Create a value <var>tbv</var> that represents the data to be verified, and
set it to the result of running the
<a href="#create-verify-hash-algorithm">Create Verify Hash Algorithm</a>,
passing the information in <var>proof</var>.
          </li>
          <li>
Pass the <a href="#dfn-proofvalue" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proofvalue-3">proofValue</a>, <var>tbv</var>,
and the <a href="#dfn-public-key" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-public-key-3">public key</a> to the <a href="#dfn-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-algorithm-4">proof algorithm</a>
(e.g. JSON Web Proof using <em>RSASSA-PKCS1-v1_5</em> algorithm).
Return the resulting boolean value.
          </li>
        </ol>
      </section>

      <section id="create-verify-hash-algorithm"><div class="header-wrapper"><h3 id="x7-3-create-verify-hash-algorithm"><bdi class="secno">7.3 </bdi>Create Verify Hash Algorithm</h3><a class="self-link" href="#create-verify-hash-algorithm" aria-label="Permalink for Section 7.3"></a></div>
        

        <div class="issue" id="issue-container-number-18"><div role="heading" class="issue-title marker" id="h-issue-16" aria-level="4"><span>Issue 18</span></div><p class="">
This algorithm is too specific to digital signatures and needs to be
generalized for algorithms such as Equihash.
        </p></div>
        <p>
The following algorithm specifies how to create the data that is used
to generate or verify a digital proof. It takes a canonicalized
<a href="#dfn-unsigned-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-unsigned-data-document-5">unsigned data document</a>, <var>canonicalized document</var>,
<a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-6">canonicalization algorithm</a>, a <a href="#dfn-message-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-message-digest-algorithm-4">message digest algorithm</a>, and
<a href="#dfn-proof-options" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-options-3">proof options</a>, <var>input options</var> (by reference).
The <a href="#dfn-proof-options" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-options-4">proof options</a> <em class="rfc2119">MUST</em> contain an identifier for the
public/private key pair, and an [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso8601" title="Representation of dates and times. ISO 8601:2004.">ISO8601</a></cite>] combined date and
time string, <var>created</var>, containing the current date and time,
accurate to at least one second, in Universal Time Code format. A <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-10">domain</a>
might also be specified in the <var>options</var>.
Its output is a data that can be used to generate or verify a
digital proof (it is usually further hashed as part of the
verification or signing process).
        </p>

        <ol class="algorithm">
          <li>
Let <var>options</var> be a copy of <var>input options</var>.
          </li>
          <li>
If the <a href="#dfn-proofvalue" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proofvalue-4">proofValue</a> parameter, such as <code>jws</code>,
exists in <var>options</var>, remove the entry.
          </li>
          <li>
If <var>created</var> does not exist in <var>options</var>, add an
entry with a value that is an [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso8601" title="Representation of dates and times. ISO 8601:2004.">ISO8601</a></cite>] combined date and
time string containing the current date and time accurate to at least one
second, in Universal Time Code format. For example:
<code>2017-11-13T20:21:34Z</code>.
          </li>
          <li>
Generate <var>output</var> by:
            <ol class="algorithm">
              <li>
Creating a <var>canonicalized options document</var> by canonicalizing
<var>options</var> according to the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-7">canonicalization algorithm</a>
(e.g. the <em>URDNA2015</em> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-c14n" title="RDF Dataset Normalization">RDF-DATASET-C14N</a></cite>] algorithm).
              </li>
              <li>
Hash <var>canonicalized options document</var> using the
<a href="#dfn-message-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-message-digest-algorithm-5">message digest algorithm</a> (e.g. SHA-256) and set <var>output</var>
to the result.
              </li>
              <li>
Hash <var>canonicalized document</var> using the <a href="#dfn-message-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-message-digest-algorithm-6">message digest algorithm</a>
(e.g. SHA-256) and append it to <var>output</var>.
              </li>
            </ol>
          </li>
          <li>
<div class="issue" id="issue-container-number-19"><div role="heading" class="issue-title marker" id="h-issue-17" aria-level="4"><span>Issue 19</span></div><div class="">This last step needs further clarification. Signing
implementations usually automatically perform their own integrated
hashing of an input message, i.e. signing algorithms are a combination
of a raw signing mechanism and a hashing mechanism such as
RS256 (RSA + SHA-256). Current implementations of RSA-based
data integrity proof suites therefore do not perform this last step
before passing the data to a signing algorithm as it will be performed
internally. The Ed25519Proof2018 algorithm also does not perform
this last step -- and, in fact, uses SHA-512 internally. In short,
this last step should better communicate that the 64 bytes produced
from concatenating the SHA-256 of the canonicalized options with the
SHA-256 of the canonicalized document are passed into the signing
algorithm with a presumption that the signing algorithm will include
hashing of its own.</div></div>
Note: It is presumed that the 64-byte <var>output</var> will be used
in a signing algorithm that includes its own hashing algorithm, such
as RS256 (RSA + SHA-256) or EdDsa (Ed25519 which uses SHA-512).
          </li>
          <li>
Return <var>output</var>.
          </li>
        </ol>
      </section>
    </section>

    <section id="security-considerations"><div class="header-wrapper"><h2 id="x8-security-considerations"><bdi class="secno">8. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 8."></a></div>
      
      <p>
The following section describes security considerations that developers
implementing this specification should be aware of in order to create secure
software.
      </p>

<div class="issue" id="issue-container-number-20"><div role="heading" class="issue-title marker" id="h-issue-18" aria-level="3"><span>Issue 20</span></div><div class="">TODO: We need to add a complete list of security
considerations.</div></div>

      <section id="verification-method-binding"><div class="header-wrapper"><h3 id="x8-1-verification-method-binding"><bdi class="secno">8.1 </bdi>Verification Method Binding</h3><a class="self-link" href="#verification-method-binding" aria-label="Permalink for Section 8.1"></a></div>
        

        <div class="issue" id="issue-container-number-21"><div role="heading" class="issue-title marker" id="h-issue-19" aria-level="4"><span>Issue 21</span></div><p class="">
Implementers must ensure that a verification method is bound to a particular
controller by going from the verification method to the controller document,
and then ensuring that the controller document also contains the verification
method.
        </p></div>
      </section>

      <section id="verification-relationship-validation"><div class="header-wrapper"><h3 id="x8-2-verification-relationship-validation"><bdi class="secno">8.2 </bdi>Verification Relationship Validation</h3><a class="self-link" href="#verification-relationship-validation" aria-label="Permalink for Section 8.2"></a></div>
        

        <div class="issue" id="issue-container-number-22"><div role="heading" class="issue-title marker" id="h-issue-20" aria-level="4"><span>Issue 22</span></div><p class="">
Implementers need to ensure that when a verification method is used, that
it matches the verification relationship associated with it and that it lines
up with the proof purpose.
        </p></div>
      </section>

      <section id="canonicalization-method-correctness"><div class="header-wrapper"><h3 id="x8-3-canonicalization-method-correctness"><bdi class="secno">8.3 </bdi>Canonicalization Method Correctness</h3><a class="self-link" href="#canonicalization-method-correctness" aria-label="Permalink for Section 8.3"></a></div>
        

        <div class="issue" id="issue-container-number-23"><div role="heading" class="issue-title marker" id="h-issue-21" aria-level="4"><span>Issue 23</span></div><p class="">
Canonicalization mechanisms utilized for normalizing input to hashing functions
need to have vetted mathematical proofs associted with them. Canonicalization
mechanisms that create collisions in hash functions can be used to attack
digital signatures.
        </p></div>
      </section>

    </section>

    <section id="privacy-considerations"><div class="header-wrapper"><h2 id="x9-privacy-considerations"><bdi class="secno">9. </bdi>Privacy Considerations</h2><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Section 9."></a></div>
      
      <p>
The following section describes privacy considerations that developers
implementing this specification should be aware of in order to create
privacy enhancing software.
      </p>

<div class="issue" id="issue-container-number-24"><div role="heading" class="issue-title marker" id="h-issue-22" aria-level="3"><span>Issue 24</span></div><div class="">TODO: We need to add a complete list of privacy
considerations.</div></div>

      <section id="unlinkability"><div class="header-wrapper"><h3 id="x9-1-unlinkability"><bdi class="secno">9.1 </bdi>Unlinkability</h3><a class="self-link" href="#unlinkability" aria-label="Permalink for Section 9.1"></a></div>
        

        <div class="issue" id="issue-container-number-25"><div role="heading" class="issue-title marker" id="h-issue-23" aria-level="4"><span>Issue 25</span></div><p class="">
When the contents of a digitally signed payload contains correlatable
identifiers, those identifiers can be used to track individuals. A static
digital signature is a correlatable identifier. There are digital signature
schemes that provide uncorrelatable digital signatures.
        </p></div>
      </section>

      <section id="selective-disclosure"><div class="header-wrapper"><h3 id="x9-2-selective-disclosure"><bdi class="secno">9.2 </bdi>Selective Disclosure</h3><a class="self-link" href="#selective-disclosure" aria-label="Permalink for Section 9.2"></a></div>
        

        <div class="issue" id="issue-container-number-26"><div role="heading" class="issue-title marker" id="h-issue-24" aria-level="4"><span>Issue 26</span></div><p class="">
When the contents of a digitally signed payload contains correlatable
identifiers, those identifiers can be used to track individuals. A static
digital signature is a correlatable identifier. There are selective
disclosure digital signature schemes, such as BBS+, that are capable of
not disclosing correlatable identifiers and ensuring that a different
but valid digital signature is re-created upon every presentation.
        </p></div>
      </section>

    </section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="a-references"><bdi class="secno">A. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix A."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="a-1-normative-references"><bdi class="secno">A.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix A.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-did-core">[DID-CORE]</dt><dd>
      <a href="https://www.w3.org/TR/did-core/"><cite>Decentralized Identifiers (DIDs) v1.0</cite></a>. Manu Sporny; Amy Guy; Markus Sabadello; Drummond Reed.  W3C. 3 August 2021. W3C Proposed Recommendation. URL: <a href="https://www.w3.org/TR/did-core/">https://www.w3.org/TR/did-core/</a>
    </dd><dt id="bib-infra">[INFRA]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-iso8601">[ISO8601]</dt><dd>
      <a href="http://www.iso.org/iso/catalogue_detail?csnumber=40874"><cite>Representation of dates and times. ISO 8601:2004.</cite></a>.  International Organization for Standardization (ISO). 2004. ISO 8601:2004. URL: <a href="http://www.iso.org/iso/catalogue_detail?csnumber=40874">http://www.iso.org/iso/catalogue_detail?csnumber=40874</a>
    </dd><dt id="bib-multibase">[MULTIBASE]</dt><dd>
      <a href="https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-03"><cite>The Multibase Encoding Scheme</cite></a>. Juan Benet; Manu Sporny.  IETF. February 2021. Internet-Draft. URL: <a href="https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-03">https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-03</a>
    </dd><dt id="bib-multicodec">[MULTICODEC]</dt><dd>
      <a href="https://github.com/multiformats/multicodec/blob/master/table.csv"><cite>The Multi Codec Encoding Scheme</cite></a>. The Multiformats Community.  IETF. February 2022. Internet-Draft. URL: <a href="https://github.com/multiformats/multicodec/blob/master/table.csv">https://github.com/multiformats/multicodec/blob/master/table.csv</a>
    </dd><dt id="bib-rdf-dataset-c14n">[RDF-DATASET-C14N]</dt><dd>
      <a href="https://json-ld.github.io/normalization/spec/"><cite>RDF Dataset Normalization</cite></a>. David Longley; Manu Sporny.  JSON-LD Community Group. CGDRAFT. URL: <a href="https://json-ld.github.io/normalization/spec/">https://json-ld.github.io/normalization/spec/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc3986">[RFC3986]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3986"><cite>Uniform Resource Identifier (URI): Generic Syntax</cite></a>. T. Berners-Lee; R. Fielding; L. Masinter.  IETF. January 2005. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>
    </dd><dt id="bib-rfc7517">[RFC7517]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-rfc7638">[RFC7638]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7638"><cite>JSON Web Key (JWK) Thumbprint</cite></a>. M. Jones; N. Sakimura.  IETF. September 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7638">https://www.rfc-editor.org/rfc/rfc7638</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8785">[RFC8785]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8785"><cite>JSON Canonicalization Scheme (JCS)</cite></a>. A. Rundgren; B. Jordan; S. Erdtman.  IETF. June 2020. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8785">https://www.rfc-editor.org/rfc/rfc8785</a>
    </dd><dt id="bib-security-vocabulary">[SECURITY-VOCABULARY]</dt><dd>
      <a href="https://w3c-ccg.github.io/security-vocab/"><cite>The Security Vocabulary</cite></a>. Manu Sporny; David Longley.  Credentials Community Group. CGDRAFT. URL: <a href="https://w3c-ccg.github.io/security-vocab/">https://w3c-ccg.github.io/security-vocab/</a>
    </dd><dt id="bib-url">[URL]</dt><dd>
      <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
    </dd><dt id="bib-vc-data-model">[VC-DATA-MODEL]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-model/"><cite>Verifiable Credentials Data Model v1.1</cite></a>. Manu Sporny; Grant Noble; Dave Longley; Daniel Burnett; Brent Zundel; Kyle Den Hartog.  W3C. 3 March 2022. W3C Recommendation. URL: <a href="https://www.w3.org/TR/vc-data-model/">https://www.w3.org/TR/vc-data-model/</a>
    </dd><dt id="bib-zcap">[ZCAP]</dt><dd>
      <a href="https://w3c-ccg.github.io/zcap-ld/"><cite>Authorization Capabilities for Linked Data</cite></a>.  Credentials Community Group. CGDRAFT. URL: <a href="https://w3c-ccg.github.io/zcap-ld/">https://w3c-ccg.github.io/zcap-ld/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data-integrity-proof" aria-label="Links in this document to definition: data integrity proof">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-data-integrity-proof" aria-label="Permalink for definition: data integrity proof. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-data-integrity-proof-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> <a href="#ref-for-dfn-data-integrity-proof-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-3" title="§ 2. Data Model">§ 2. Data Model</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-4" title="§ 2.1 Proofs">§ 2.1 Proofs</a> <a href="#ref-for-dfn-data-integrity-proof-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-6" title="§ 7.1 Proof Algorithm">§ 7.1 Proof Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-unsigned-data-document" aria-label="Links in this document to definition: unsigned data document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-unsigned-data-document" aria-label="Permalink for definition: unsigned data document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-unsigned-data-document-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-unsigned-data-document-2" title="§ 7.1 Proof Algorithm">§ 7.1 Proof Algorithm</a> <a href="#ref-for-dfn-unsigned-data-document-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-unsigned-data-document-4" title="§ 7.2 Proof Verification Algorithm">§ 7.2 Proof Verification Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-unsigned-data-document-5" title="§ 7.3 Create Verify Hash Algorithm">§ 7.3 Create Verify Hash Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-signed-data-document" aria-label="Links in this document to definition: signed data document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-signed-data-document" aria-label="Permalink for definition: signed data document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-signed-data-document-1" title="§ 7.1 Proof Algorithm">§ 7.1 Proof Algorithm</a> <a href="#ref-for-dfn-signed-data-document-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-signed-data-document-3" title="§ 7.2 Proof Verification Algorithm">§ 7.2 Proof Verification Algorithm</a> <a href="#ref-for-dfn-signed-data-document-4" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-public-key" aria-label="Links in this document to definition: public key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-public-key" aria-label="Permalink for definition: public key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-public-key-1" title="§ 7.2 Proof Verification Algorithm">§ 7.2 Proof Verification Algorithm</a> <a href="#ref-for-dfn-public-key-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-public-key-3" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-private-key" aria-label="Links in this document to definition: private key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-private-key" aria-label="Permalink for definition: private key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-private-key-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-private-key-2" title="§ 7.1 Proof Algorithm">§ 7.1 Proof Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-type" aria-label="Links in this document to definition: proof type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-type" aria-label="Permalink for definition: proof type. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-type-1" title="§ 1.1 Design Goals and Rationale">§ 1.1 Design Goals and Rationale</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-type-2" title="§ 2.1 Proofs">§ 2.1 Proofs</a> <a href="#ref-for-dfn-proof-type-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-proof-type-4" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-type-5" title="§ 6. Creating New Proof Types">§ 6. Creating New Proof Types</a> <a href="#ref-for-dfn-proof-type-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-proof-type-7" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-options" aria-label="Links in this document to definition: proof options">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-options" aria-label="Permalink for definition: proof options. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-options-1" title="§ 7.1 Proof Algorithm">§ 7.1 Proof Algorithm</a> <a href="#ref-for-dfn-proof-options-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-options-3" title="§ 7.3 Create Verify Hash Algorithm">§ 7.3 Create Verify Hash Algorithm</a> <a href="#ref-for-dfn-proof-options-4" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-purpose" aria-label="Links in this document to definition: proof purpose">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-purpose" aria-label="Permalink for definition: proof purpose. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-purpose-1" title="§ 2.2 Proof Purposes">§ 2.2 Proof Purposes</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-challenge" aria-label="Links in this document to definition: challenge">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-challenge" aria-label="Permalink for definition: challenge. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-challenge-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-domain" aria-label="Links in this document to definition: domain">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-domain" aria-label="Permalink for definition: domain. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-domain-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> <a href="#ref-for-dfn-domain-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-domain-3" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-domain-4" title="§ 2.1 Proofs">§ 2.1 Proofs</a> <a href="#ref-for-dfn-domain-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-domain-6" title="§ 4.1 Signatures">§ 4.1 Signatures</a> <a href="#ref-for-dfn-domain-7" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-domain-8" title="§ 7.1 Proof Algorithm">§ 7.1 Proof Algorithm</a> <a href="#ref-for-dfn-domain-9" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-domain-10" title="§ 7.3 Create Verify Hash Algorithm">§ 7.3 Create Verify Hash Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-authenticated" aria-label="Links in this document to definition: authenticate">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-authenticated" aria-label="Permalink for definition: authenticate. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-authenticated-1" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> 
  </li><li>
    <a href="#ref-for-dfn-authenticated-2" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-authenticated-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-authenticated-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-authenticated-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-authenticated-6" title="Reference 5">(5)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cryptosuite" aria-label="Links in this document to definition: cryptographic suite">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cryptosuite" aria-label="Permalink for definition: cryptographic suite. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-cryptosuite-1" title="§ 1.1 Design Goals and Rationale">§ 1.1 Design Goals and Rationale</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-2" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-3" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-4" title="§ 4.1 Signatures">§ 4.1 Signatures</a> <a href="#ref-for-dfn-cryptosuite-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-6" title="§ 5. Advanced Terminology">§ 5. Advanced Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-7" title="§ 6. Creating New Proof Types">§ 6. Creating New Proof Types</a> <a href="#ref-for-dfn-cryptosuite-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cryptosuite-9" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-decentralized-identifiers" aria-label="Links in this document to definition: decentralized identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-decentralized-identifiers" aria-label="Permalink for definition: decentralized identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-decentralized-identifiers-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> <a href="#ref-for-dfn-decentralized-identifiers-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-decentralized-identifiers-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-decentralized-identifiers-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-decentralized-identifiers-5" title="Reference 5">(5)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controller-s" aria-label="Links in this document to definition: controller">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controller-s" aria-label="Permalink for definition: controller. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-controller-s-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> <a href="#ref-for-dfn-controller-s-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-3" title="§ 2.3 Controller Documents">§ 2.3 Controller Documents</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-4" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> <a href="#ref-for-dfn-controller-s-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-s-7" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-8" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-9" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> <a href="#ref-for-dfn-controller-s-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-11" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-12" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-controller-s-13" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-14" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-15" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> <a href="#ref-for-dfn-controller-s-16" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-17" title="§ 2.3.2.3 Key Agreement">§ 2.3.2.3 Key Agreement</a> <a href="#ref-for-dfn-controller-s-18" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-19" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> <a href="#ref-for-dfn-controller-s-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-21" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-22" title="§ 2.3.2.5 Capability Delegation">§ 2.3.2.5 Capability Delegation</a> <a href="#ref-for-dfn-controller-s-23" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-24" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-s-25" title="Reference 4">(4)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controller-documents" aria-label="Links in this document to definition: controller document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controller-documents" aria-label="Permalink for definition: controller document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-controller-documents-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> <a href="#ref-for-dfn-controller-documents-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-documents-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-documents-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controller-documents-5" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-6" title="§ 2.3 Controller Documents">§ 2.3 Controller Documents</a> <a href="#ref-for-dfn-controller-documents-7" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-8" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> <a href="#ref-for-dfn-controller-documents-9" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-documents-10" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-documents-11" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-12" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> <a href="#ref-for-dfn-controller-documents-13" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-14" title="§ 2.3.1.3 Referring to Verification Methods">§ 2.3.1.3 Referring to Verification Methods</a> <a href="#ref-for-dfn-controller-documents-15" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-16" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> <a href="#ref-for-dfn-controller-documents-17" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-documents-18" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-documents-19" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controller-documents-20" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-21" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-controller-documents-22" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-documents-23" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-24" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-25" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> <a href="#ref-for-dfn-controller-documents-26" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-resolution" aria-label="Links in this document to definition: resolution">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-resolution" aria-label="Permalink for definition: resolution. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-resolution-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-resolvers" aria-label="Links in this document to definition: resolver">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-resolvers" aria-label="Permalink for definition: resolver. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-resolvers-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-subjects" aria-label="Links in this document to definition: subject">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-subjects" aria-label="Permalink for definition: subject. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-subjects-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> <a href="#ref-for-dfn-subjects-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-distributed-ledger-technology" aria-label="Links in this document to definition: distributed ledger">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-distributed-ledger-technology" aria-label="Permalink for definition: distributed ledger. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-distributed-ledger-technology-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-resources" aria-label="Links in this document to definition: resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-resources" aria-label="Permalink for definition: resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-resources-1" title="§ 2.3.1.3 Referring to Verification Methods">§ 2.3.1.3 Referring to Verification Methods</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verifiable-credentials" aria-label="Links in this document to definition: verifiable credential">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verifiable-credentials" aria-label="Permalink for definition: verifiable credential. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verifiable-credentials-1" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> <a href="#ref-for-dfn-verifiable-credentials-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-method" aria-label="Links in this document to definition: verification method">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-method" aria-label="Permalink for definition: verification method. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verification-method-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> <a href="#ref-for-dfn-verification-method-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-3" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-4" title="§ 2. Data Model">§ 2. Data Model</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-5" title="§ 2.3 Controller Documents">§ 2.3 Controller Documents</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-6" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> <a href="#ref-for-dfn-verification-method-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-10" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-11" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-12" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-method-13" title="Reference 8">(8)</a> <a href="#ref-for-dfn-verification-method-14" title="Reference 9">(9)</a> <a href="#ref-for-dfn-verification-method-15" title="Reference 10">(10)</a> <a href="#ref-for-dfn-verification-method-16" title="Reference 11">(11)</a> <a href="#ref-for-dfn-verification-method-17" title="Reference 12">(12)</a> <a href="#ref-for-dfn-verification-method-18" title="Reference 13">(13)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-19" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> <a href="#ref-for-dfn-verification-method-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-21" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-22" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-23" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-24" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-25" title="Reference 7">(7)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-26" title="§ 2.3.1.2 Multikey">§ 2.3.1.2 Multikey</a> <a href="#ref-for-dfn-verification-method-27" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-28" title="§ 2.3.1.3 Referring to Verification Methods">§ 2.3.1.3 Referring to Verification Methods</a> <a href="#ref-for-dfn-verification-method-29" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-30" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-31" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-32" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-33" title="Reference 6">(6)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-34" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> <a href="#ref-for-dfn-verification-method-35" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-36" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-37" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-38" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-39" title="Reference 6">(6)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-40" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-verification-method-41" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-42" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-43" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-44" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> <a href="#ref-for-dfn-verification-method-45" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-46" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-47" title="§ 2.3.2.3 Key Agreement">§ 2.3.2.3 Key Agreement</a> <a href="#ref-for-dfn-verification-method-48" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-49" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-50" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> <a href="#ref-for-dfn-verification-method-51" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-52" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-53" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-54" title="§ 2.3.2.5 Capability Delegation">§ 2.3.2.5 Capability Delegation</a> <a href="#ref-for-dfn-verification-method-55" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-56" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-relationship" aria-label="Links in this document to definition: verification relationship">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-relationship" aria-label="Permalink for definition: verification relationship. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verification-relationship-1" title="§ 2.3 Controller Documents">§ 2.3 Controller Documents</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-2" title="§ 2.3.1.3 Referring to Verification Methods">§ 2.3.1.3 Referring to Verification Methods</a> <a href="#ref-for-dfn-verification-relationship-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-4" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> <a href="#ref-for-dfn-verification-relationship-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-relationship-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-relationship-7" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-relationship-8" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-relationship-9" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-relationship-10" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-relationship-11" title="Reference 8">(8)</a> <a href="#ref-for-dfn-verification-relationship-12" title="Reference 9">(9)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-13" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-verification-relationship-14" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-15" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-16" title="§ 2.3.2.3 Key Agreement">§ 2.3.2.3 Key Agreement</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-17" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-18" title="§ 2.3.2.5 Capability Delegation">§ 2.3.2.5 Capability Delegation</a> <a href="#ref-for-dfn-verification-relationship-19" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-type" aria-label="Links in this document to definition: type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-type" aria-label="Permalink for definition: type. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-type-1" title="§ 2.1 Proofs">§ 2.1 Proofs</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verificationmethod" aria-label="Links in this document to definition: verificationMethod">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verificationmethod" aria-label="Permalink for definition: verificationMethod. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verificationmethod-1" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-created" aria-label="Links in this document to definition: created">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-created" aria-label="Permalink for definition: created. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-created-1" title="§ 2.1 Proofs">§ 2.1 Proofs</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proofvalue" aria-label="Links in this document to definition: proofValue">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proofvalue" aria-label="Permalink for definition: proofValue. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proofvalue-1" title="§ 7.1 Proof Algorithm">§ 7.1 Proof Algorithm</a> <a href="#ref-for-dfn-proofvalue-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-proofvalue-3" title="§ 7.2 Proof Verification Algorithm">§ 7.2 Proof Verification Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-proofvalue-4" title="§ 7.3 Create Verify Hash Algorithm">§ 7.3 Create Verify Hash Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-publickeyjwk" aria-label="Links in this document to definition: publicKeyJwk">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-publickeyjwk" aria-label="Permalink for definition: publicKeyJwk. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-publickeyjwk-1" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-publickeymultibase" aria-label="Links in this document to definition: publicKeyMultibase">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-publickeymultibase" aria-label="Permalink for definition: publicKeyMultibase. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-publickeymultibase-1" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-authentication" aria-label="Links in this document to definition: authentication">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-authentication" aria-label="Permalink for definition: authentication. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-authentication-1" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> 
  </li><li>
    <a href="#ref-for-dfn-authentication-2" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-authentication-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-authentication-4" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-assertionmethod" aria-label="Links in this document to definition: assertionMethod">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-assertionmethod" aria-label="Permalink for definition: assertionMethod. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-assertionmethod-1" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keyagreement" aria-label="Links in this document to definition: keyAgreement">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-keyagreement" aria-label="Permalink for definition: keyAgreement. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-keyagreement-1" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-capabilityinvocation" aria-label="Links in this document to definition: capabilityInvocation">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-capabilityinvocation" aria-label="Permalink for definition: capabilityInvocation. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-capabilityinvocation-1" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data-integrity-signature" aria-label="Links in this document to definition: data integrity signature">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-data-integrity-signature" aria-label="Permalink for definition: data integrity signature. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-data-integrity-signature-1" title="§ 4.1 Signatures">§ 4.1 Signatures</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-canonicalization-algorithm" aria-label="Links in this document to definition: canonicalization algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-canonicalization-algorithm" aria-label="Permalink for definition: canonicalization algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-canonicalization-algorithm-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-2" title="§ 6. Creating New Proof Types">§ 6. Creating New Proof Types</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-3" title="§ 7. Algorithms">§ 7. Algorithms</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-4" title="§ 7.1 Proof Algorithm">§ 7.1 Proof Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-5" title="§ 7.2 Proof Verification Algorithm">§ 7.2 Proof Verification Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-6" title="§ 7.3 Create Verify Hash Algorithm">§ 7.3 Create Verify Hash Algorithm</a> <a href="#ref-for-dfn-canonicalization-algorithm-7" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-message-digest-algorithm" aria-label="Links in this document to definition: message digest algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-message-digest-algorithm" aria-label="Permalink for definition: message digest algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-message-digest-algorithm-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-message-digest-algorithm-2" title="§ 6. Creating New Proof Types">§ 6. Creating New Proof Types</a> 
  </li><li>
    <a href="#ref-for-dfn-message-digest-algorithm-3" title="§ 7. Algorithms">§ 7. Algorithms</a> 
  </li><li>
    <a href="#ref-for-dfn-message-digest-algorithm-4" title="§ 7.3 Create Verify Hash Algorithm">§ 7.3 Create Verify Hash Algorithm</a> <a href="#ref-for-dfn-message-digest-algorithm-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-message-digest-algorithm-6" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-algorithm" aria-label="Links in this document to definition: proof algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-algorithm" aria-label="Permalink for definition: proof algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-algorithm-1" title="§ 1.3 Terminology">§ 1.3 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-algorithm-2" title="§ 6. Creating New Proof Types">§ 6. Creating New Proof Types</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-algorithm-3" title="§ 7. Algorithms">§ 7. Algorithms</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-algorithm-4" title="§ 7.2 Proof Verification Algorithm">§ 7.2 Proof Verification Algorithm</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>