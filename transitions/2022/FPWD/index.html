<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="generator" content="ReSpec 32.3.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>Verifiable Credential Data Integrity 1.0</title>
    
    
    
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
    

    
    
<style>

ol.algorithm { counter-reset:numsection; list-style-type: none; }
ol.algorithm li { margin: 0.5em 0; }
ol.algorithm li:before { font-weight: bold; counter-increment: numsection; content: counters(numsection, ".") ") "; }
    
</style>

<meta name="description" content="This specification describes mechanisms for ensuring the authenticity and
integrity of Verifiable Credentials and similar types of constrained digital
documents using cryptography, especially through the use of digital
signatures and related mathematical proofs.">
<link rel="canonical" href="https://www.w3.org/TR/vc-data-integrity/">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "FPWD",
  "shortName": "vc-data-integrity",
  "subtitle": "Securing the Integrity of Verifiable Credential Data",
  "publishDate": "2022-11-10",
  "edDraftURI": "https://w3c.github.io/vc-data-integrity/",
  "editors": [
    {
      "name": "Manu Sporny",
      "url": "https://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/",
      "w3cid": 41758
    },
    {
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/",
      "note": "2014-2022",
      "w3cid": 48025
    },
    {
      "name": "Mike Prorock",
      "url": "https://www.linkedin.com/in/mprorock",
      "company": "Mesur.io",
      "companyURL": "https://mesur.io/",
      "w3cid": 130636
    }
  ],
  "authors": [
    {
      "name": "Dave Longley",
      "url": "http://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/"
    },
    {
      "name": "Manu Sporny",
      "url": "http://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "http://digitalbazaar.com/"
    }
  ],
  "group": "vc",
  "wgPublicList": "public-credentials",
  "github": "w3c/vc-data-integrity",
  "wgPatentURI": "",
  "maxTocLevel": 3,
  "localBiblio": {
    "RDF-DATASET-C14N": {
      "title": "RDF Dataset Canonicalization",
      "href": "https://w3c-ccg.github.io/rdf-dataset-canonicalization/spec/index.html",
      "authors": [
        "David Longley",
        "Manu Sporny"
      ],
      "status": "CGFINAL",
      "publisher": "Credentials Community Group",
      "id": "rdf-dataset-c14n"
    },
    "SECURITY-VOCABULARY": {
      "title": "The Security Vocabulary",
      "href": "https://w3id.org/security",
      "authors": [
        "Ivan Herman",
        "Manu Sporny",
        "David Longley"
      ],
      "status": "ED",
      "publisher": "Verifiable Credentials Working Group",
      "id": "security-vocabulary"
    },
    "ZCAP": {
      "title": "Authorization Capabilities for Linked Data",
      "href": "https://w3c-ccg.github.io/zcap-spec",
      "status": "CGDRAFT",
      "publisher": "Credentials Community Group",
      "id": "zcap"
    },
    "MULTIBASE": {
      "title": "The Multibase Encoding Scheme",
      "date": "February 2021",
      "href": "https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-03",
      "authors": [
        "Juan Benet",
        "Manu Sporny"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF",
      "id": "multibase"
    },
    "MULTICODEC": {
      "title": "The Multi Codec Encoding Scheme",
      "date": "February 2022",
      "href": "https://github.com/multiformats/multicodec/blob/master/table.csv",
      "authors": [
        "The Multiformats Community"
      ],
      "status": "Internet-Draft",
      "publisher": "IETF",
      "id": "multicodec"
    },
    "VC-EXTENSION-REGISTRY": {
      "title": "Verifiable Credentials Extension Registry",
      "href": "https://w3c-ccg.github.io/vc-extension-registry/",
      "authors": [
        "Manu Sporny"
      ],
      "status": "CG-DRAFT",
      "publisher": "Credentials Community Group",
      "id": "vc-extension-registry"
    },
    "VC-DATA-MODEL-2": {
      "title": "Verifiable Credentials Data Model v2.0",
      "href": "https://www.w3.org/TR/vc-data-model-2.0/",
      "authors": [
        "Manu Sporny",
        "Dave Longley",
        "Grant Noble",
        "Dan Burnett",
        "Ted Thibodeau",
        "Brent Zundel",
        "David Chadwick",
        "Kyle Den Hartog"
      ],
      "status": "Working Draft",
      "publisher": "W3C Verifiable Credentials Working Group",
      "id": "vc-data-model-2"
    }
  },
  "postProcess": [
    null
  ],
  "publishISODate": "2022-11-10T00:00:00.000Z",
  "generatedSubtitle": "W3C First Public Working Draft 10 November 2022"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD"></head>
<body class="h-entry"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">Verifiable Credential Data Integrity 1.0</h1> <h2 id="subtitle" class="subtitle">Securing the Integrity of Verifiable Credential Data</h2>
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#FPWD">W3C First Public Working Draft</a> <time class="dt-published" datetime="2022-11-10">10 November 2022</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://www.w3.org/TR/2022/WD-vc-data-integrity-20221110/">https://www.w3.org/TR/2022/WD-vc-data-integrity-20221110/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/vc-data-integrity/">https://www.w3.org/TR/vc-data-integrity/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/vc-data-integrity/">https://w3c.github.io/vc-data-integrity/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/vc-data-integrity">https://www.w3.org/standards/history/vc-data-integrity</a>
                  </dd><dd>
                    <a href="https://github.com/w3c/vc-data-integrity/commits/">Commit history</a>
                  </dd>
        
        
        
        
        
        <dt>Editors:</dt><dd class="editor p-author h-card vcard" data-editor-id="41758">
    <a class="u-url url p-name fn" href="https://digitalbazaar.com/">Manu Sporny</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="48025">
    <a class="u-url url p-name fn" href="https://digitalbazaar.com/">Dave Longley</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>) (2014-2022)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="130636">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/mprorock">Mike Prorock</a> (<a class="p-org org h-org" href="https://mesur.io/">Mesur.io</a>)
  </dd>
        
        <dt>Authors:</dt><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="http://digitalbazaar.com/">Dave Longley</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="http://digitalbazaar.com/">Manu Sporny</a> (<a class="p-org org h-org" href="http://digitalbazaar.com/">Digital Bazaar</a>)
  </dd>
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/vc-data-integrity/">GitHub w3c/vc-data-integrity</a>
        (<a href="https://github.com/w3c/vc-data-integrity/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/vc-data-integrity/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/vc-data-integrity/issues/">open issues</a>)
      </dd><dd><a href="mailto:public-credentials@w3.org?subject=%5Bvc-data-integrity%5D%20YOUR%20TOPIC%20HERE">public-credentials@w3.org</a> with subject line <kbd>[vc-data-integrity] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-credentials">archives</a>)</dd>
        
        
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    ©
    2022
    
    <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>,
    <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
This specification describes mechanisms for ensuring the authenticity and
integrity of Verifiable Credentials and similar types of constrained digital
documents using cryptography, especially through the use of digital
signatures and related mathematical proofs.
      </p>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p>
    <p>
    This document was published by the <a href="https://www.w3.org/groups/wg/vc">Verifiable Credentials Working Group</a> as
    a First Public Working Draft using the
        <a href="https://www.w3.org/2021/Process-20211102/#recs-and-notes">Recommendation track</a>. 
  </p><p>Publication as a First Public Working Draft does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/vc/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                  This document is governed by the
                  <a id="w3c_process_revision" href="https://www.w3.org/2021/Process-20211102/">2 November 2021 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#how-it-works"><bdi class="secno">1.1 </bdi>How it Works</a></li><li class="tocline"><a class="tocxref" href="#design-goals-and-rationale"><bdi class="secno">1.2 </bdi>Design Goals and Rationale</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.3 </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.4 </bdi>Terminology</a></li></ol></li><li class="tocline"><a class="tocxref" href="#data-model"><bdi class="secno">2. </bdi>Data Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proofs"><bdi class="secno">2.1 </bdi>Proofs</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proof-sets"><bdi class="secno">2.1.1 </bdi>Proof Sets</a></li><li class="tocline"><a class="tocxref" href="#proof-chains"><bdi class="secno">2.1.2 </bdi>Proof Chains</a></li></ol></li><li class="tocline"><a class="tocxref" href="#proof-purposes"><bdi class="secno">2.2 </bdi>Proof Purposes</a></li><li class="tocline"><a class="tocxref" href="#controller-documents"><bdi class="secno">2.3 </bdi>Controller Documents</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#verification-methods"><bdi class="secno">2.3.1 </bdi>Verification Methods</a><ol class="toc"></ol></li><li class="tocline"><a class="tocxref" href="#verification-relationships"><bdi class="secno">2.3.2 </bdi>Verification Relationships</a><ol class="toc"></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#relationship-to-linked-data"><bdi class="secno">2.4 </bdi>Relationship to Linked Data</a></li></ol></li><li class="tocline"><a class="tocxref" href="#cryptographic-suites"><bdi class="secno">3. </bdi>Cryptographic Suites</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dataintegrityproof"><bdi class="secno">3.1 </bdi>DataIntegrityProof</a></li></ol></li><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">4. </bdi>Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#generate-proof"><bdi class="secno">4.1 </bdi>Generate Proof</a></li><li class="tocline"><a class="tocxref" href="#verify-proof"><bdi class="secno">4.2 </bdi>Verify Proof</a></li></ol></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">5. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#versioning-cryptography-suites"><bdi class="secno">5.1 </bdi>Versioning Cryptography Suites</a></li><li class="tocline"><a class="tocxref" href="#protecting-application-developers"><bdi class="secno">5.2 </bdi>Protecting Application Developers</a></li><li class="tocline"><a class="tocxref" href="#agility-and-layering"><bdi class="secno">5.3 </bdi>Agility and Layering</a></li><li class="tocline"><a class="tocxref" href="#transformations"><bdi class="secno">5.4 </bdi>Transformations</a></li><li class="tocline"><a class="tocxref" href="#data-opacity"><bdi class="secno">5.5 </bdi>Data Opacity</a></li><li class="tocline"><a class="tocxref" href="#verification-method-binding"><bdi class="secno">5.6 </bdi>Verification Method Binding</a></li><li class="tocline"><a class="tocxref" href="#verification-relationship-validation"><bdi class="secno">5.7 </bdi>Verification Relationship Validation</a></li><li class="tocline"><a class="tocxref" href="#canonicalization-method-correctness"><bdi class="secno">5.8 </bdi>Canonicalization Method Correctness</a></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">6. </bdi>Privacy Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#unlinkability"><bdi class="secno">6.1 </bdi>Unlinkability</a></li><li class="tocline"><a class="tocxref" href="#selective-disclosure"><bdi class="secno">6.2 </bdi>Selective Disclosure</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">A.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">A.2 </bdi>Informative references</a></li></ol></li></ol></nav>

    <section class="informative" id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
This specification describes mechanisms for ensuring the authenticity and
integrity of Verifiable Credentials and similar types of constrained digital
documents using cryptography, especially through the use of digital signatures
and related mathematical proofs. Cryptographic proofs enable functionality that
is useful to implementors of distributed systems. For example, proofs can be
used to:
      </p>

      <ul>
        <li>
Make statements that can be shared without loss of trust, because their
authorship can be verified by a third party, for example as part of Verifiable
Credentials [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2</a></cite>] or social media posts.
        </li>
        <li>
Authenticate as an entity identified by a particular identifier, for example, as
the subject identified by a Decentralized Identifier (DID) [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>].
        </li>
        <li>
Delegate authorization for actions in a remote execution environment, via
mechanisms such as Authorization Capabilities [<cite><a class="bibref" data-link-type="biblio" href="#bib-zcap" title="Authorization Capabilities for Linked Data">ZCAP</a></cite>].
        </li>
        <li>
Agree to contracts where the agreement can be verified by another party.
        </li>
        <li>
Additionally, many proofs that are based on cryptographic digital signatures
provide the benefit of integrity protection, making documents and data
tamper-evident.
        </li>
      </ul>

      <section class="informative" id="how-it-works"><div class="header-wrapper"><h3 id="x1-1-how-it-works"><bdi class="secno">1.1 </bdi>How it Works</h3><a class="self-link" href="#how-it-works" aria-label="Permalink for Section 1.1"></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
The operation of Data Integrity is conceptually simple. To create a
cryptographic proof, the following steps are performed: 1) Transformation,
2) Hashing, and 3) Proof Generation.
        </p>

        <figure id="hiw-creation">
          <img style="margin: auto; display: block; width: 100%;" src="diagrams/hiw-creation.svg" alt="
Diagram showing the three steps involved in the creation of a cryptographic
proof. The diagram is laid out left to right with a blue box labeled 'Data'
on the far left. The blue box travels, left to right, through three subsequent
yellow arrows labeled 'Transform Data', 'Hash Data', and 'Generate Proof'. The
resulting blue box at the far right is labeled 'Data with Proof'.
               " height="51" width="300">
          <figcaption style="text-align: center;">Figure <bdi class="figno">1</bdi> <span class="fig-title">
To create a cryptographic proof, data is transformed, hashed, and
cryptographically protected.
          </span></figcaption>
        </figure>

        <p>
<dfn id="dfn-transformation" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Transformation</dfn> is a process described by a <dfn data-plurals="transformation algorithms" id="dfn-transformation-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">transformation
algorithm</dfn> that takes input data and prepares it for the hashing process.
One example of a possible transformation is to take a record of people's names
that attended a meeting, sort the list alphabetically by the individual's family
name, and rewrite the names on a piece of paper, one per line, in sorted order.
Possible transformations include
<a href="https://en.wikipedia.org/wiki/Canonicalization">canonicalization</a>
and
<a href="https://en.wikipedia.org/wiki/Binary-to-text_encoding">
binary-to-text</a> encoding.
        </p>

        <p>
<dfn id="dfn-hashing" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Hashing</dfn> is a process described by a <dfn data-plurals="hashing algorithms" id="dfn-hashing-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">hashing algorithm</dfn> that
calculates an identifier for the transformed data using a
<a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">
cryptographic hash function</a>. This process is conceptually similar to how a
phone address book functions, where one takes a person's name (the input data)
and maps that name to that individual's phone number (the hash). Possible
cryptographic hash functions include
<a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function#SHA-3">
SHA-3</a> and
<a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function#BLAKE3">
BLAKE-3</a>.
        </p>

        <p>
<dfn class="lint-ignore" id="dfn-proof-generation" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Proof Generation</dfn> is a process described by a
<dfn data-plurals="proof generation algorithms" id="dfn-proof-generation-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof generation algorithm</dfn> that calculates a value that protects the
integrity of the input data from modification or otherwise proves a certain
desired threshold of trust. This process is conceptually similar to the way a
wax seal can be used on an envelope containing a letter to establish trust in
the sender and show that the letter has not been tampered with in transit.
Possible proof generation functions include
<a href="https://en.wikipedia.org/wiki/Digital_signature">digital signatures</a>
and
<a href="https://en.wikipedia.org/wiki/Proof_of_stake">proofs of stake</a>.
        </p>

        <p>
To verify a cryptographic proof, the following steps are performed:
1) Transformation, 2) Hashing, and 3) Proof Verification.
        </p>

        <figure id="hiw-verification">
          <img style="margin: auto; display: block; width: 100%;" src="diagrams/hiw-verification.svg" alt="
Diagram showing the three steps involved in the verification of a cryptographic
proof. The diagram is laid out left to right with a blue box labeled
'Data with Proof' on the far left. The blue box travels, left to right, through
three subsequent yellow arrows labeled 'Transform Data', 'Hash Data', and
'Verify Proof'. The resulting blue box at the far right is labeled 'Data with
Proof'.
               " height="49" width="300">
          <figcaption style="text-align: center;">Figure <bdi class="figno">2</bdi> <span class="fig-title">
To verify a cryptographic proof, data is transformed, hashed, and
checked for correctness.
          </span></figcaption>
        </figure>

        <p>
During verification, the <a href="#dfn-transformation" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transformation-1">transformation</a> and <a href="#dfn-hashing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hashing-1">hashing</a> steps are
conceptually the same as described above.
        </p>

        <p>
<dfn class="lint-ignore" id="dfn-proof-verification" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Proof Verification</dfn> is a process that is described
by a <dfn data-plurals="proof verification algorithms" id="dfn-proof-verification-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof verification algorithm</dfn> that applies a cryptographic proof
verification function to see if the input data can be trusted. Possible proof
verification functions include
<a href="https://en.wikipedia.org/wiki/Digital_signature">digital signatures</a>
and
<a href="https://en.wikipedia.org/wiki/Proof_of_stake">proofs of stake</a>.
        </p>

        <p>
This specification details how cryptographic software architects and
implementers can package these processes together into things called
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-1">cryptographic suites</a> and provide them to application developers for the
purposes of protecting the integrity of application data in transit and at rest.
        </p>

      </section>

      <section class="informative" id="design-goals-and-rationale"><div class="header-wrapper"><h3 id="x1-2-design-goals-and-rationale"><bdi class="secno">1.2 </bdi>Design Goals and Rationale</h3><a class="self-link" href="#design-goals-and-rationale" aria-label="Permalink for Section 1.2"></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
This specification optimizes for the following design goals:
        </p>

        <dl>
          <dt>Simplicity</dt>
          <dd>
The technology is designed to be easy to use for application developers,
without requiring significant training in cryptography. It optimizes for the
following priority of constituencies: application developers over cryptographic
suite implementers, over cryptographic suite designers, over cryptographic
algorithm specification authors.  The solution focuses on sensible defaults to
prevent the selection of ineffective protection mechanisms. See section
<a href="#protecting-application-developers" class="sec-ref"><bdi class="secno">5.2 </bdi>Protecting Application Developers</a> and
<a href="#versioning-cryptography-suites" class="sec-ref"><bdi class="secno">5.1 </bdi>Versioning Cryptography Suites</a> for further details.
          </dd>
          <dt>Composability</dt>
          <dd>
A number of historical digital signature mechanisms have had monolithic
designs which limited use cases by combining data transformation, syntax,
digital signature, and serialization into a single specification. This
specification layers each component such that a broader range of use cases are
enabled, including generalized selective disclosure and serialization-agnostic
signatures. See section <a href="#transformations" class="sec-ref"><bdi class="secno">5.4 </bdi>Transformations</a>, section
<a href="#data-opacity" class="sec-ref"><bdi class="secno">5.5 </bdi>Data Opacity</a>, and <a href="#versioning-cryptography-suites" class="sec-ref"><bdi class="secno">5.1 </bdi>Versioning Cryptography Suites</a>
for further rationale.
          </dd>
          <dt>Resilience</dt>
          <dd>
Since digital proof mechanisms might be compromised without warning due to
technological advancements, it is important that <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-2">cryptographic suites</a>
provide multiple layers of protection and can be rapidly upgraded. This
specification provides for both algorithmic agility and cryptographic layering,
while still keeping the digital proof format easy for developers to understand
and use. See section <a href="#agility-and-layering" class="sec-ref"><bdi class="secno">5.3 </bdi>Agility and Layering</a> to understand the
particulars.
          </dd>
          <dt>Progressive Extensibility</dt>
          <dd>
Creating and deploying new cryptographic protection mechanisms is designed to be
a deliberate, iterative, and careful process that acknowledges that extension
happens in phases from experimentation, to implementation, to standardization.
This specification strives to balance the need for an increase in the rate of
innovation in cryptography with the need for stable production-grade
cryptography suites. See section <a href="#cryptographic-suites" class="sec-ref"><bdi class="secno">3. </bdi>Cryptographic Suites</a> for
instructions on establishing new types of cryptographic proofs.
          </dd>
          <dt>Serialization Flexibility</dt>
          <dd>
Cryptographic proofs can be serialized in many different but equivalent ways and
have often been tightly bound to the original document syntax. This
specification enables one to create cryptographic proofs that are not
bound to the original document syntax, which enables more advanced use cases
such as being able to use a single digital signature across a variety of
serialization syntaxes such as JSON and CBOR without the need to regenerate the
cryptographic proof. See section <a href="#transformations" class="sec-ref"><bdi class="secno">5.4 </bdi>Transformations</a> for an
explanation of the benefits of such an approach.
          </dd>
        </dl>

      <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span><span class="issue-label">: Application of technology to broader use cases</span></div><p class="">
While this specification primarily focuses on Verifiable Credentials, the
design of this technology is generalized, such that it can be used for
non-Verifiable Credential use cases. In these instances, implementers are
expected to perform their own due diligence and expert review as to the
applicability of the technology to their use case.
      </p></div>

      </section>

      <section id="conformance"><div class="header-wrapper"><h3 id="x1-3-conformance"><bdi class="secno">1.3 </bdi>Conformance</h3><a class="self-link" href="#conformance" aria-label="Permalink for Section 1.3"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">OPTIONAL</em>, <em class="rfc2119">RECOMMENDED</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>
      </section>

      <section class="informative" id="terminology"><div class="header-wrapper"><h3 id="x1-4-terminology"><bdi class="secno">1.4 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.4"></a></div><p><em>This section is non-normative.</em></p>
        

        <div><p>
This section defines the terms used in this specification. A link to these terms
is included whenever they appear in this specification.
</p>

<dl class="termlist">
  <dt><dfn data-plurals="data integrity proofs" id="dfn-data-integrity-proof" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">data integrity proof</dfn></dt>
  <dd>
A set of attributes that represent a digital proof and the parameters required
to verify it.
  </dd>
  <dt><dfn id="dfn-public-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">public key</dfn></dt>
  <dd>
Cryptographic material that can be used to verify digital proofs created with a
corresponding <a href="#dfn-private-key" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-private-key-1">private key</a>.
  </dd>
  <dt><dfn id="dfn-private-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">private key</dfn></dt>
  <dd>
Cryptographic material that can be used to generate digital proofs.
  </dd>
  <dt><dfn id="dfn-proof-type" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof type</dfn></dt>
  <dd>
A specified set of cryptographic primitives bundled together into a
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-3">cryptographic suite</a> for the purposes of safety and convenience, by
cryptographers for developers (see section
<a href="#cryptographic-suites" class="sec-ref"><bdi class="secno">3. </bdi>Cryptographic Suites</a>).
  </dd>
  <dt><dfn id="dfn-proof-options" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof options</dfn></dt>
  <dd>
A set of options that is included in the proof data. These options might
include <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-1">controller</a>, <a href="#dfn-challenge" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-challenge-1">challenge</a>, <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-1">domain</a>, or other data
that is specific to the proof format.
  </dd>
  <dt><dfn id="dfn-proof-purpose" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">proof purpose</dfn></dt>
  <dd>
The specific intent for the proof; the reason why an entity created it. The
protected declaration acts as a safeguard to prevent the proof from being
misused for a purpose other than the one it was intended for.
  </dd>
  <dt><dfn id="dfn-challenge" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">challenge</dfn></dt>
  <dd>
A random or pseudo-random value used by some authentication protocols to
mitigate replay attacks.
  </dd>
  <dt><dfn id="dfn-domain" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">domain</dfn></dt>
  <dd>
A string value that specifies the operational domain of a digital proof.
This could be an Internet domain name like <code>example.com</code>, an
ad-hoc value such as <code>mycorp-level3-access</code>, or a very
specific transaction value like <code>8zF6T8J34qP3mqP</code>. A signer could
include a <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-2">domain</a> in its digital proof to restrict its use
to particular target, identified by the specified <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-3">domain</a>.
  </dd>

  <dt><dfn data-lt="authenticated|authenticate" id="dfn-authenticated" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">authenticate</dfn></dt>
  <dd>
Authentication is a process by which an entity can prove it has a specific
attribute or controls a specific secret using one or more <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-1">verification
methods</a>.
  </dd>

  <dt><dfn data-lt="cryptosuite|cryptographic suite" data-plurals="cryptographic suites" id="dfn-cryptosuite" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">cryptographic suite</dfn></dt>
  <dd>
A specification defining the usage of specific cryptographic primitives in
order to achieve a particular security goal. These documents are often used
to specify <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-2">verification methods</a>, digital signature types,
their identifiers, and other related properties.
  </dd>

  <dt><dfn data-lt="decentralized identifiers|DID|DIDs|decentralized identifier" data-plurals="did" id="dfn-decentralized-identifiers" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">decentralized identifier</dfn> (DID)</dt>

  <dd>
A globally unique persistent identifier that does not require a centralized
registration authority and is often generated and/or registered
cryptographically. The generic format of a is defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>]. Many—but
not all—methods make use of <a href="#dfn-distributed-ledger-technology" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-distributed-ledger-technology-1">distributed ledger technology</a> (DLT) or some
other form of decentralized network.
  </dd>

  <dt><dfn data-lt="controller(s)|controller" data-plurals="controllers" id="dfn-controller-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controller</dfn></dt>

  <dd>
An entity that has the capability to make changes to a
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-1">controller document</a>.
  </dd>

  <dt><dfn data-lt="controller documents|controller document" id="dfn-controller-documents" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controller document</dfn></dt>

  <dd>
A set of data that specifies one or more relationships between a
<a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-2">controller</a> and a set of data, such as a set of public cryptographic keys.
  </dd>

  <dt><dfn data-lt="subjects|subject" id="dfn-subjects" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">subject</dfn></dt>

  <dd>
The entity identified by the <code>id</code> property in a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-2">controller document</a>.
Anything can be a subject: person, group, organization, physical thing, digital
thing, logical thing, etc.
  </dd>

  <dt><dfn data-lt="distributed ledger technology|DLT|distributed ledger" id="dfn-distributed-ledger-technology" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">distributed ledger</dfn> (DLT)</dt>

  <dd>
A non-centralized system for recording events. These systems establish
sufficient confidence for participants to rely upon the data recorded by others
to make operational decisions. They typically use distributed databases where
different nodes use a consensus protocol to confirm the ordering of
cryptographically signed transactions. The linking of digitally signed
transactions over time often makes the history of the ledger effectively
immutable.
  </dd>

  <dt><dfn data-lt="resources|resource" id="dfn-resources" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">resource</dfn></dt>

  <dd>
As defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3986" title="Uniform Resource Identifier (URI): Generic Syntax">RFC3986</a></cite>]: "...the term 'resource' is used in a general sense
for whatever might be identified by a URI." Similarly, any resource might serve
as a <a href="#dfn-subjects" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subjects-1">subject</a> identified by a <a href="#dfn-decentralized-identifiers" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-decentralized-identifiers-1">DID</a>.
  </dd>


  <dt><dfn data-lt="verifiable credentials|verifiable credential" id="dfn-verifiable-credentials" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verifiable credential</dfn></dt>

  <dd>
A standard data model and representation format for cryptographically-verifiable
digital credentials as defined by the <abbr title="World Wide Web Consortium">W3C</abbr> Verifiable Credentials specification
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2</a></cite>].
  </dd>

  <dt><dfn data-lt="" data-plurals="verification methods" id="dfn-verification-method" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification method</dfn></dt>

  <dd>
    <p>
A set of parameters that can be used together with a process to independently
verify a proof. For example, a cryptographic public key can be used as a
verification method with respect to a digital signature; in such usage, it
verifies that the signer possessed the associated cryptographic private key.
    </p>
    <p>
"Verification" and "proof" in this definition are intended to apply broadly. For
example, a cryptographic public key might be used during Diffie-Hellman key
exchange to negotiate a shared symmetric key for encryption. This guarantees the
integrity of the key agreement process. It is thus another type of verification
method, even though descriptions of the process might not use the words
"verification" or "proof."
    </p>
  </dd>

  <dt><dfn data-lt="" data-plurals="verification relationships" id="dfn-verification-relationship" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification relationship</dfn></dt>

  <dd>
    <p>
An expression of the relationship between the <a href="#dfn-subjects" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-subjects-2">subject</a> and a
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-3">verification method</a>. An example of a verification relationship is
<a href="#authentication" class="sec-ref"><bdi class="secno">2.3.2.1 </bdi>Authentication</a>.
    </p>
  </dd>

</dl>
</div>
      </section>
    </section>

    <section id="data-model"><div class="header-wrapper"><h2 id="x2-data-model"><bdi class="secno">2. </bdi>Data Model</h2><a class="self-link" href="#data-model" aria-label="Permalink for Section 2."></a></div>
      

      <p>
This section specifies the data model that is used for expressing
<a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-1">data integrity proofs</a> and <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-4">verification methods</a>.
      </p>

      <section id="proofs"><div class="header-wrapper"><h3 id="x2-1-proofs"><bdi class="secno">2.1 </bdi>Proofs</h3><a class="self-link" href="#proofs" aria-label="Permalink for Section 2.1"></a></div>
        
        <p>
A <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-2">data integrity proof</a> provides information about the proof mechanism,
parameters required to verify that proof, and the proof value itself. All of this
information is provided using Linked Data vocabularies such as the
[<cite><a class="bibref" data-link-type="biblio" href="#bib-security-vocabulary" title="The Security Vocabulary">SECURITY-VOCABULARY</a></cite>].
        </p>

        <p>
The following attributes are defined for use in a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-3">data integrity proof</a>:
        </p>

        <dl style="margin-left: 1em;">
          <dt>type</dt>
          <dd>
The specific <a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-1">proof type</a> used for the cryptographic proof <em class="rfc2119">MUST</em> be
specified as a string that maps to a URL [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>]. Examples of proof types
include <code>DataIntegrityProof</code> and <code>Ed25519Signature2020</code>.
Proof types determine what other fields are required to secure and
verify the proof.
          </dd>

          <dt>proofPurpose</dt>
          <dd>
The reason the proof was created <em class="rfc2119">MUST</em> be specified as a string that maps to a
URL [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>]. The proof purpose acts as a safeguard to prevent the proof from
being misused by being applied to a purpose other than the one that was
intended. For example, without this value the creator of a proof could be
tricked into using cryptographic material typically used to create a Verifiable
Credential (<code>assertionMethod</code>) during a login process
(<code>authentication</code>) which would then result in the creation of a
Verifiable Credential they never meant to create instead of the intended action,
which was to merely logging into a website.
          </dd>

          <dt>verificationMethod</dt>
          <dd>
The means and information needed to verify the proof <em class="rfc2119">MUST</em> be specified as a
string that maps to a [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>]. An example of a verification method is a
link to a public key which includes cryptographic material that is used by a
verifier during the verification process.
          </dd>

          <dt>created</dt>
          <dd>
The date and time the proof was created <em class="rfc2119">MUST</em> be specified as an
[<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>] combined date and time string.
          </dd>

          <dt>domain</dt>
          <dd>
The creator of a proof <em class="rfc2119">SHOULD</em> include a string value that indicates its intended usage, which a verifier <em class="rfc2119">SHOULD</em> use to ensure the proof was intended to be used by them. The
specification of the <code>domain</code> parameter is useful in challenge-response
protocols where the verifier is operating from within a security domain known to
the creator of the proof. Examples of a domain parameter include:
<code>domain.example</code> (DNS domain), <code>https://domain.example:8443</code> (full Web origin),
<code>mycorp-intranet</code> (well-known text string), and
<code>b31d37d4-dd59-47d3-9dd8-c973da43b63a</code> (UUID).
          </dd>

          <dt>challenge</dt>
          <dd>
A string value that <em class="rfc2119">SHOULD</em> be included in a proof if a <code>domain</code> is specified.
The value is used once for a particular <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-4">domain</a> and window of time. This
value is used to mitigate replay attacks. Examples of a challenge value include:
<code>1235abcd6789</code>, <code>79d34551-ae81-44ae-823b-6dadbab9ebd4</code>, and <code>ruby</code>.
          </dd>

          <dt>proofValue</dt>
          <dd>
A string value that contains the data necessary to verify the digital proof
using the <code>verificationMethod</code> specified. The contents of the value <em class="rfc2119">MUST</em> be a
multibase-encoded binary value. Alternative fields with different encodings <em class="rfc2119">MAY</em>
be used to encode the data necessary to verify the digital proof instead of this
value. The contents of this value are determined by a cryptosuite and set to the
<em>proof value</em> generated by the
<a href="#generate-proof">Generate Proof Algorithm</a>.
          </dd>
        </dl>

        <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>Note</span></div><p class="">
All of the terms above map to URLs. The vocabulary where these terms are defined
is the [<cite><a class="bibref" data-link-type="biblio" href="#bib-security-vocabulary" title="The Security Vocabulary">SECURITY-VOCABULARY</a></cite>].
        </p></div>

        <p>
A proof can be added to a JSON document like the following:
        </p>

        <div class="example" id="example-a-simple-json-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-json-data-document">Example<bdi> 1</bdi></a><span class="example-title">: A simple JSON data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs css">{
  "title": <span class="hljs-string">"Hello world!"</span>
};</code></pre>
      </div>

        <p>
by adding the parameters outlined in this section:
        </p>

        <div class="example" id="example-a-simple-signed-json-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-signed-json-data-document">Example<bdi> 2</bdi></a><span class="example-title">: A simple signed JSON data document</span>
  </div> <pre class="highlight" style="overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" aria-busy="false"><code class="hljs">{
  "title": "Hello world!",
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "example-signature-2022",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://di.example/issuer#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "zQeVbY4oey5q2M3XKaxup3tmzN4DRFTLVqpLMweBrSxMY2xHX5XTYV8nQA
      pmEcqaqA3Q1gVHMrXFkXJeV6doDwLWx"
  }
}</code></pre>
      </div>

        <p>
The example proof above suggests a ficticious
<code>example-signature-2022</code> cryptography suite that produces a
verifiable digital proof by presumptively transforming the input data using the
JSON Canonicalization Scheme [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>] and then digitally signing it using an
Ed25519 elliptic curve signature.
        </p>

        <p>
Similarly, a proof can be added to a JSON-LD data document like the following:
        </p>

        <div class="example" id="example-a-simple-json-ld-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-json-ld-data-document">Example<bdi> 3</bdi></a><span class="example-title">: A simple JSON-LD data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"@context"</span>: {<span class="hljs-string">"title"</span>: <span class="hljs-string">"https://schema.org/title"</span>},
  <span class="hljs-string">"title"</span>: <span class="hljs-string">"Hello world!"</span>
};</code></pre>
      </div>

        <p>
by adding the parameters outlined in this section:
        </p>

        <div class="example" id="example-a-simple-signed-json-ld-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-simple-signed-json-ld-data-document">Example<bdi> 4</bdi></a><span class="example-title">: A simple signed JSON-LD data document</span>
  </div> <pre class="highlight" style="overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" aria-busy="false"><code class="hljs">{
  "@context": [
    {"title": "https://schema.org/title"},
    "https://w3id.org/security/data-integrity/v1"
  ],
  "title": "Hello world!",
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-2022",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://ldi.example/issuer#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4oey5q2M3XKaxup3tmzN4DRFTLVqpLMweBrSxMY2xHX5XTYVQeVbY8nQA
      VHMrXFkXJpmEcqdoDwLWxaqA3Q1geV6"
  }
}</code></pre>
      </div>

        <p>
The proof example above uses the <code>Ed25519Signature2020</code> <a href="#dfn-proof-type" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-type-2">proof
type</a> to produce a verifiable digital proof by canonicalizing the input data
using the RDF Dataset Canonicalization algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-c14n" title="RDF Dataset Canonicalization">RDF-DATASET-C14N</a></cite>] and then
digitally signing it using an Ed25519 elliptic curve signature.
        </p>

<div class="issue" id="issue-container-generatedID-1"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><span>Issue</span></div><div class="">Create a separate section detailing an optional mechanism
for authenticating public key control via bi-directional links. How
to establish trust in controllers is out of scope but examples can
be given.</div></div>

<div class="issue" id="issue-container-generatedID-2"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="4"><span>Issue</span></div><div class="">Specify algorithm agility mechanisms (additional attributes
from the security vocab can be used to indicate other signing and hash
algorithms). Rewrite algorithms to be parameterized on this basis and
move <code>Ed25519Signature2020</code> definition to a single supported
mechanism; specify its identifier as a URL. In order to make it easy to
specify a variety of combinations of algorithms, introduce a core
type <code>DataIntegrityProof</code> that allows for easy filtering/discover of
proof nodes, but that type on its own doesn't specify any default
proof or hash algorithms, those need to be given via other properties in the
nodes.</div></div>

      <div class="issue" id="issue-container-generatedID-3"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="4"><span>Issue</span><span class="issue-label">: Avoid signature format proliferation by using text-based suite value</span></div><p class="">
The pattern that Data Integrity Signatures use presently leads to a
proliferation in signature types and JSON-LD Contexts. This proliferation can be
avoided without any loss of the security characteristics of tightly binding a
cryptography suite version to one or more acceptable public keys. The
following signature suites are currently being contemplated: eddsa-2022,
nist-ecdsa-2022, koblitz-ecdsa-2022, rsa-2022, pgp-2022, bbs-2022, eascdsa-2022,
ibsa-2022, and jws-2022.
      </p></div>

      <div class="example" id="example-a-dataintegrityproof-example-using-a-nist-ecdsa-2022-cryptosuite">
        <div class="marker">
    <a class="self-link" href="#example-a-dataintegrityproof-example-using-a-nist-ecdsa-2022-cryptosuite">Example<bdi> 5</bdi></a><span class="example-title">: A DataIntegrityProof example using a NIST ECDSA 2022 Cryptosuite</span>
  </div> <pre aria-busy="false"><code class="hljs">{
  "@context": ["https://w3id.org/security/data-integrity/v1"],
  "type": "DataIntegrityProof",
  "cryptosuite": "ecdsa-2022",
  "created": "2022-11-29T20:35:38Z",
  "verificationMethod": "did:example:123456789abcdefghi#keys-1",
  "proofPurpose": "assertionMethod",
  "proofValue": "z2rb7doJxczUFBTdV5F5pehtbUXPDUgKVugZZ99jniVXCUpojJ9PqLYV
                 evMeB1gCyJ4HqpnTyQwaoRPWaD3afEZboXCBTdV5F5pehtbUXPDUgKVugUpoj"
}</code></pre>
      </div>

<div class="issue" id="issue-container-generatedID-4"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="4"><span>Issue</span></div><div class="">Add an explicit check on key type to prevent an
attacker from selecting an algorithm that could abuse how the key is
used/interpreted.</div></div>

<div class="issue" id="issue-container-generatedID-5"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="4"><span>Issue</span></div><div class="">Add a note indicating that selective disclosure proof
mechanisms can be compatible with Data Integrity; for example,
an algorithm could produce a merkle tree from a canonicalized set of
N-Quads and then sign the root hash. Disclosure would involve including
the merkle paths for each N-Quad that is to be revealed. This mechanism
would merely consume the normalized output differently (this, and the
proof mechanism would be modifications to this core spec). It might also
be necessary to generate proof parameters such as a private key/seed
that can be used along with an algorithm to deterministically generate
nonces that are concatenated with each N-Quad to prevent rainbow
table or similar attacks.</div></div>

  <div class="issue" id="issue-container-generatedID-6"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="4"><span>Issue</span></div><div class="">Add a note indicating that this specification should not
  be construed to indicate that public key controllers should be restricted to a
  single public key or that systems that use this spec and involve real people
  should identify each person as only ever being a single entity rather than
  perhaps N entities with M keys. There are no such restrictions and in many
  cases those kinds of restrictions are ill-advised due to privacy
  considerations.</div></div>

      <p>
The Data Integrity specification supports the concept of multiple
proofs in a single document. There are two types of multi-proof
approaches that are identified: Proof Sets (un-ordered) and Proof Chains
(ordered).
      </p>

      <section id="proof-sets"><div class="header-wrapper"><h4 id="x2-1-1-proof-sets"><bdi class="secno">2.1.1 </bdi>Proof Sets</h4><a class="self-link" href="#proof-sets" aria-label="Permalink for Section 2.1.1"></a></div>
        
        <p>
A proof set is useful when the same data needs to be secured by multiple
entities, but where the order of proofs does not matter,
such as in the case of a set of signatures on a contract. A proof set,
which has no order, is represented by associating a set of proofs
with the <code>proof</code> key in a document.
        </p>
        <div class="example" id="example-a-proof-set-in-a-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-proof-set-in-a-data-document">Example<bdi> 6</bdi></a><span class="example-title">: A proof set in a data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs">{
  "@context": [
    {"title": "https://schema.org/title"},
    "https://w3id.org/security/data-integrity/v1"
],
  "title": "Hello world!",
  "proof": [{
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-2022",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://ldi.example/issuer/1#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4oey5q2M3XKaxup3tmzN4DRFTLVqpLMweBrSxMY2xHX5XTYVQeVbY8nQA
      VHMrXFkXJpmEcqdoDwLWxaqA3Q1geV6"
  }, {
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-2022",
    "created": "2020-11-05T13:08:49Z",
    "verificationMethod": "https://pfps.example/issuer/2#z6MkGskxnGjLrk3gKS2mes
      DpuwRBokeWcmrgHxUXfnncxiZP",
    "proofPurpose": "assertionMethod",
    "proofValue": "z5QLBrp19KiWXerb8ByPnAZ9wujVFN8PDsxxXeMoyvDqhZ6Qnzr5CG9876
      zNht8BpStWi8H2Mi7XCY3inbLrZrm95"
  }]
}</code></pre>
      </div>

      </section>

      <section id="proof-chains"><div class="header-wrapper"><h4 id="x2-1-2-proof-chains"><bdi class="secno">2.1.2 </bdi>Proof Chains</h4><a class="self-link" href="#proof-chains" aria-label="Permalink for Section 2.1.2"></a></div>
        
        <p>
A proof chain is useful when the same data needs to be signed by
multiple entities and the order of when the proofs occurred matters,
such as in the case of a notary counter-signing a proof that had been
created on a document. A proof chain, where order needs to be preserved, is
represented by associating an ordered list of proofs with the
<code>proofChain</code> key in a document.
        </p>
        <div class="example" id="example-a-proof-chain-in-a-data-document">
        <div class="marker">
    <a class="self-link" href="#example-a-proof-chain-in-a-data-document">Example<bdi> 7</bdi></a><span class="example-title">: A proof chain in a data document</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs">{
  "@context": [
    {"title": "https://schema.org/title"},
    "https://w3id.org/security/data-integrity/v1"
],
  "title": "Hello world!",
  "proofChain": [{
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-2022",
    "created": "2020-11-05T19:23:42Z",
    "verificationMethod": "https://ldi.example/issuer/1#z6MkjLrk3gKS2nnkeWcmcxi
      ZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "zVbY8nQAVHMrXFkXJpmEcqdoDwLWxaqA3Q1geV64oey5q2M3XKaxup3tmzN4
      DRFTLVqpLMweBrSxMY2xHX5XTYVQe"
  }, {
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-2022",
    "created": "2020-11-05T21:28:14Z",
    "verificationMethod": "https://pfps.example/issuer/2#z6MkGskxnGjLrk3gKS2mes
      DpuwRBokeWcmrgHxUXfnncxiZP",
    "proofPurpose": "assertionMethod",
    "proofValue": "z6Qnzr5CG9876zNht8BpStWi8H2Mi7XCY3inbLrZrm955QLBrp19KiWXerb8
      ByPnAZ9wujVFN8PDsxxXeMoyvDqhZ"
  }]
}</code></pre>
      </div>

      </section>
      </section>

      <section id="proof-purposes"><div class="header-wrapper"><h3 id="x2-2-proof-purposes"><bdi class="secno">2.2 </bdi>Proof Purposes</h3><a class="self-link" href="#proof-purposes" aria-label="Permalink for Section 2.2"></a></div>
        

        <p>
A proof that describes its purpose helps prevent it from being misused for some
other purpose.
        </p>

        <div class="issue" id="issue-container-generatedID-7"><div role="heading" class="issue-title marker" id="h-issue-5" aria-level="4"><span>Issue</span></div><p class="">
Add a mention of JWK's <code>key_ops</code> parameter and WebCrypto's
<code>KeyUsage</code> restrictions; explain that Proof Purpose serves a
different goal and allows for finer-grained restrictions.
<br><br>
Dave Longley suggested that proof purposes enable verifiers to know what the
proof creator's intent was so the message can't be accidentally abused for
another purpose, e.g., a message signed for the purpose of merely making an
assertion (and thus perhaps intended to be widely shared) being abused as a
message to authenticate to a service or take some action (invoke a capability).
It's a goal to keep the number of them limited to as few categories as are
really needed to accomplish this goal.
        </p></div>

        <p>
The following is a list of commonly used <a href="#dfn-proof-purpose" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-purpose-1">proof purpose</a> values.
        </p>

        <dl>
          <dt>authentication</dt>
          <dd>
Indicates that a given proof is only to be used for the purposes of an
authentication protocol.
          </dd>
          <dt>assertionMethod</dt>
          <dd>
Indicates that a proof can only be used for making assertions, for example
signing a Verifiable Credential.
          </dd>
          <dt>keyAgreement</dt>
          <dd>
Indicates that a proof is used for for key agreement protocols, such as
Elliptic Curve Diffie Hellman key agreement used by popular encryption
libraries.
          </dd>
          <dt>capabilityDelegation</dt>
          <dd>
Indicates that the proof can only be used for delegating capabilities. See the
Authorization Capabilities [<cite><a class="bibref" data-link-type="biblio" href="#bib-zcap" title="Authorization Capabilities for Linked Data">ZCAP</a></cite>] specification for more detail.
          </dd>
          <dt>capabilityInvocation</dt>
          <dd>
Indicates that the proof can only be used for invoking capabilities. See the
Authorization Capabilities [<cite><a class="bibref" data-link-type="biblio" href="#bib-zcap" title="Authorization Capabilities for Linked Data">ZCAP</a></cite>] specification for more detail.
          </dd>
        </dl>

        <p>
Note: The Authorization Capabilities [<cite><a class="bibref" data-link-type="biblio" href="#bib-zcap" title="Authorization Capabilities for Linked Data">ZCAP</a></cite>] specification defines additional
proof purposes for that use case, such as <code>capabilityInvocation</code> and
<code>capabilityDelegation</code>.
        </p>
      </section>

      <section id="controller-documents"><div class="header-wrapper"><h3 id="x2-3-controller-documents"><bdi class="secno">2.3 </bdi>Controller Documents</h3><a class="self-link" href="#controller-documents" aria-label="Permalink for Section 2.3"></a></div>
        

        <p>
A <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-3">controller document</a> is a set of data that specifies one or more
relationships between a <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-3">controller</a> and a set of data, such as a set of
public cryptographic keys. The <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-4">controller document</a> <em class="rfc2119">SHOULD</em>
contain <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-1">verification relationships</a> that explicitly permit the use of
certain <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-5">verification methods</a> for specific purposes.
        </p>

        <div class="issue" id="issue-container-generatedID-8"><div role="heading" class="issue-title marker" id="h-issue-6" aria-level="4"><span>Issue</span></div><div class="">Add examples of common Controller documents, such as
controller documents published on a ledger-based registry, or on a mutable medium in
combination with an integrity protection mechanism such as Hashlinks.
        </div></div>

        <section id="verification-methods"><div class="header-wrapper"><h4 id="x2-3-1-verification-methods"><bdi class="secno">2.3.1 </bdi>Verification Methods</h4><a class="self-link" href="#verification-methods" aria-label="Permalink for Section 2.3.1"></a></div>
          
          <p>
A <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-5">controller document</a> can express <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-6">verification methods</a>, such as
cryptographic public keys, which can be used to <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-1">authenticate</a> or authorize
interactions with the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-4">controller</a> or associated parties. For example, a
cryptographic public key can be used as a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-7">verification method</a> with
respect to a digital signature; in such usage, it verifies that the signer
could use the associated cryptographic private key. <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-8">Verification methods</a>
might take many parameters. An example of this is a set of five cryptographic
keys from which any three are required to contribute to a cryptographic
threshold signature.
          </p>

          <dl>
            <dt>verificationMethod</dt>
            <dd>
              <p>
The <code>verificationMethod</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the value
<em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-9">verification
methods</a>, where each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-10">verification method</a> is expressed using a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a>. The <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-11">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> <em class="rfc2119">MUST</em> include the <code>id</code>,
<code>type</code>, <code>controller</code>, and specific verification material
properties that are determined by the value of <code>type</code> and are defined
in <a href="#verification-material" class="sec-ref"><bdi class="secno">2.3.1.1 </bdi>Verification Material</a>. A <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-12">verification method</a> <em class="rfc2119">MAY</em>
include additional properties. <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-13">Verification methods</a> <em class="rfc2119">SHOULD</em> be registered
in the Data Integrity Specification Registries [TBD - DIS-REGISTRIES].
              </p>

              <dl>
                <dt>id</dt>
                <dd>
                  <p>
The value of the <code>id</code> property for a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-14">verification
method</a> <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that conforms to the
conforms to the [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>] syntax.
                  </p>
                </dd>
                <dt>type</dt>
                <dd>
The value of the <code>type</code> property <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that references exactly one <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-15">verification
method</a> type. In order to maximize global interoperability, the
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-16">verification method</a> type <em class="rfc2119">SHOULD</em> be registered in the Data Integrity Specification
Registries [TBD -- DIS-REGISTRIES].
                </dd>
                <dt>controller</dt>
                <dd>
The value of the <code>controller</code> property <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> that conforms to the [<cite><a class="bibref" data-link-type="biblio" href="#bib-url" title="URL Standard">URL</a></cite>] syntax.
                </dd>
              </dl>
            </dd>
          </dl>

          <div class="example" id="example-example-verification-method-structure">
        <div class="marker">
    <a class="self-link" href="#example-example-verification-method-structure">Example<bdi> 8</bdi></a><span class="example-title">: Example verification method structure</span>
  </div> <pre aria-busy="false"><code class="hljs javascript">{
  <span class="hljs-string">"@context"</span>: [
    <span class="hljs-string">"https://www.w3.org/ns/did/v1"</span>,
    <span class="hljs-string">"https://w3id.org/security/data-integrity/v1"</span>
  ]
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"did:example:123456789abcdefghi"</span>,
  ...
  <span class="hljs-string">"verificationMethod"</span>: [{
    <span class="hljs-string">"id"</span>: ...,
    <span class="hljs-string">"type"</span>: ...,
    <span class="hljs-string">"controller"</span>: ...,
    <span class="hljs-string">"publicKeyJwk"</span>: ...
  }, {
    <span class="hljs-string">"id"</span>: ...,
    <span class="hljs-string">"type"</span>: ...,
    <span class="hljs-string">"controller"</span>: ...,
    <span class="hljs-string">"publicKeyMultibase"</span>: ...
  }]
}</code></pre>
      </div>

          <div class="note" role="note" id="issue-container-generatedID-9"><div role="heading" class="note-title marker" id="h-note-1" aria-level="5"><span>Note</span><span class="issue-label">: Verification method controller(s) and controller(s)</span></div><p class="">
The semantics of the <code>controller</code> property are the same when the
subject of the relationship is the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-6">controller document</a> as when the subject of
the relationship is a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-17">verification method</a>, such as a cryptographic public
key. Since a key can't control itself, and the key controller cannot be inferred
from the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-7">controller document</a>, it is necessary to explicitly express the identity
of the controller of the key. The difference is that the value of
<code>controller</code> for a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-18">verification method</a> is <em>not</em>
necessarily a <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-5">controller</a>. <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-6">controllers</a> are expressed
using the <code><a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-7">controller</a></code> property at the highest level of the
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-8">controller document</a>.
          </p></div>

          <section id="verification-material"><div class="header-wrapper"><h5 id="x2-3-1-1-verification-material"><bdi class="secno">2.3.1.1 </bdi>Verification Material</h5><a class="self-link" href="#verification-material" aria-label="Permalink for Section 2.3.1.1"></a></div>
            

            <p>
Verification material is any information that is used by a process that applies
a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-19">verification method</a>. The <code>type</code> of a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-20">verification
method</a> is expected to be used to determine its compatibility with such
processes. Examples of verification material properties are
<code><a href="#dfn-publickeyjwk" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-publickeyjwk-1">publicKeyJwk</a></code> or <code><a href="#dfn-publickeymultibase" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-publickeymultibase-1">publicKeyMultibase</a></code>. A
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-4">cryptographic suite</a> specification is responsible for specifying the
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-21">verification method</a> <code>type</code> and its associated verification
material. For example, see <a href="https://w3c-ccg.github.io/lds-jws2020/">JSON
Web Signature 2020</a> and <a href="https://w3c-ccg.github.io/lds-ed25519-2020/">Ed25519 Signature 2020</a>.
For all registered <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-22">verification method</a> types and associated verification
material available for <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-8">controllers</a>, please see the Data Integrity
Specification Registries [TBD - DIS-REGISTRIES].
            </p>

            <div class="issue" id="issue-container-generatedID-10"><div role="heading" class="issue-title marker" id="h-issue-7" aria-level="6"><span>Issue</span></div><p class="">
Ensuring that cryptographic suites are versioned and tightly scoped to a very
small set of possible key types and signature schemes (ideally one key type and
size and one signature output type) is a design goal for most Data Integrity
cryptographic suites. Historically, this has been done by defining both the
key type and the cryptographic suite that uses the key type in the same
specification. The downside of doing so, however, is that there might be a
proliferation of different key types in multikey that result in different
cryptosuites defining the same key material differently. For example, one
cryptosuite might use compressed Curve P-256 keys while another uses
uncompressed values. If that occurs, it will harm interoperability. It will be
important in the coming months to years to ensure that this does not happen
by fully defining the multikey format in a separate specification so
cryptosuite specifications, such as this one, can refer to the multikey
specification, thus reducing the chances of multikey type proliferation and
improving the chances of maximum interoperability for the multikey format.
            </p></div>

            <p>
To increase the likelihood of interoperable implementations, this specification
limits the number of formats for expressing verification material in a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-9">controller
document</a>. The fewer formats that implementers have to
implement, the more likely it will be that they will support all of them. This
approach attempts to strike a delicate balance between ease of implementation
and supporting formats that have historically had broad deployment.
Two supported verification material properties are listed below:
            </p>

            <dl>
              <dt><dfn id="dfn-publickeyjwk" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">publicKeyJwk</dfn></dt>
              <dd>
                <p>
The <code>publicKeyJwk</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the value <em class="rfc2119">MUST</em>
be a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> representing a JSON Web Key that
conforms to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>]. The <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> <em class="rfc2119">MUST NOT</em>
contain "d", or any other members of the private information class as described
in <a href="https://tools.ietf.org/html/rfc7517#section-8.1.1">Registration
Template</a>. It is <em class="rfc2119">RECOMMENDED</em> that verification methods that use JWKs
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>] to represent their public keys use the value of <code>kid</code> as
their fragment identifier. It is <em class="rfc2119">RECOMMENDED</em> that JWK
<code>kid</code> values are set to the public key fingerprint [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7638" title="JSON Web Key (JWK) Thumbprint">RFC7638</a></cite>]. See
the first key in <a href="#example-various-verification-method-types" class="box-ref">Example<bdi> 9</bdi></a> for
an example of a public key with a compound key identifier.
                </p>
              </dd>
              <dt><dfn id="dfn-publickeymultibase" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">publicKeyMultibase</dfn></dt>
              <dd>
                <p>
The <code>publicKeyMultibase</code> property is <em class="rfc2119">OPTIONAL</em>. This feature is
non-normative. If present, the value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#string">string</a> representation of a [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] encoded
public key.
                </p>
                <p class="advisement">
Note that the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] specification is not yet a standard and is
subject to change. There might be some use cases for this data format
where <code><b>public</b>KeyMultibase</code> is defined, to allow for
expression of public keys, but <code><b>private</b>KeyMultibase</code>
is not defined, to protect against accidental leakage of secret keys.
                </p>
              </dd>
          </dl>

            <p>
A <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-23">verification method</a> <em class="rfc2119">MUST NOT</em> contain multiple verification material
properties for the same material. For example, expressing key material in a
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-24">verification method</a> using both <code>publicKeyJwk</code> and
<code>publicKeyMultibase</code> at the same time is prohibited.
            </p>

            <p>
An example of a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-10">controller document</a> containing <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-25">verification methods</a> using
both properties above is shown below.
            </p>

            <div class="example" id="example-various-verification-method-types">
        <div class="marker">
    <a class="self-link" href="#example-various-verification-method-types">Example<bdi> 9</bdi></a><span class="example-title">: Verification methods using publicKeyJwk and publicKeyMultibase</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/jws-2020/v1",
    "https://w3id.org/security/multikey/v1"
  ]
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "verificationMethod": [{
    "id": "did:example:123#_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A",
    "type": "JsonWebKey2020", <span class="comment">// external (property value)</span>
    "controller": "did:example:123",
    "publicKeyJwk": {
      "crv": "Ed25519", <span class="comment">// external (property name)</span>
      "x": "VCpo2LMLhn6iWku8MKvSLg2ZAoC-nlOyPVQaO3FxVeQ", <span class="comment">// external (property name)</span>
      "kty": "OKP", <span class="comment">// external (property name)</span>
      "kid": "_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A" <span class="comment">// external (property name)</span>
    }
  }, {
    "id": "did:example:123456789abcdefghi#keys-1",
    "type": "Multikey", <span class="comment">// external (property value)</span>
    "controller": "did:example:pqrstuvwxyz0987654321",
    "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
  }],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="multikey"><div class="header-wrapper"><h5 id="x2-3-1-2-multikey"><bdi class="secno">2.3.1.2 </bdi>Multikey</h5><a class="self-link" href="#multikey" aria-label="Permalink for Section 2.3.1.2"></a></div>
            
            <p>
The Multikey data model is a specific type of <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-26">verification method</a> that
utilizes the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="The Multi Codec Encoding Scheme">MULTICODEC</a></cite>] specification to encode key types into a single
binary stream that is then encoded using the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] specification.
To encode a Multikey, the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-27">verification method</a> <code>type</code> <em class="rfc2119">MUST</em> be set to
<code>Multikey</code> and the <code>publicKeyMultibase</code> value <em class="rfc2119">MUST</em> be a [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] encoded
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="The Multi Codec Encoding Scheme">MULTICODEC</a></cite>] value. An example of a Multikey is provided below:
            </p>

            <div class="example" id="example-multikey-encoding-of-a-ed25519-public-key">
        <div class="marker">
    <a class="self-link" href="#example-multikey-encoding-of-a-ed25519-public-key">Example<bdi> 10</bdi></a><span class="example-title">: Multikey encoding of a Ed25519 public key</span>
  </div> <pre class="nohighlight">{
  "@context": ["https://w3id.org/security/multikey/v1"],
  "id": "did:example:123456789abcdefghi#keys-1",
  "type": "Multikey",
  "controller": "did:example:123456789abcdefghi",
  "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
}</pre>
      </div>

            <p>
In the example above, the <code>publicKeyMultibase</code> value starts with the letter <code>z</code>,
which is the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] header that conveys that the binary data is
base58-encoded using the Bitcoin base-encoding alphabet. The decoded binary data
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="The Multi Codec Encoding Scheme">MULTICODEC</a></cite>] header is <code>0xed</code>, which specifies that the remaining data
is a 32-byte raw Ed25519 public key.
            </p>

            <p>
The Multikey data model is also capable of encoding secret keys, sometimes
referred to as <em>private keys</em>.
            </p>

            <div class="example" id="example-multikey-encoding-of-a-ed25519-secret-key">
        <div class="marker">
    <a class="self-link" href="#example-multikey-encoding-of-a-ed25519-secret-key">Example<bdi> 11</bdi></a><span class="example-title">: Multikey encoding of a Ed25519 secret key</span>
  </div> <pre class="nohighlight">{
  "@context": ["https://w3id.org/security/suites/secrets/v1"],
  "id": "did:example:123456789abcdefghi#keys-1",
  "type": "Multikey",
  "controller": "did:example:123456789abcdefghi",
  "secretKeyMultibase": "z3u2fprgdREFtGakrHr6zLyTeTEZtivDnYCPZmcSt16EYCER"
}</pre>
      </div>

            <p>
In the example above, the <code>secretKeyMultibase</code> value starts with the letter <code>z</code>,
which is the [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="The Multibase Encoding Scheme">MULTIBASE</a></cite>] header that conveys that the binary data is
base58-encoded using the Bitcoin base-encoding alphabet. The decoded binary data
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="The Multi Codec Encoding Scheme">MULTICODEC</a></cite>] header is <code>0x1300</code>, which specifies that the remaining data
is a 32-byte raw Ed25519 private key.
            </p>

          </section>

          <section id="referring-to-verification-methods"><div class="header-wrapper"><h5 id="x2-3-1-3-referring-to-verification-methods"><bdi class="secno">2.3.1.3 </bdi>Referring to Verification Methods</h5><a class="self-link" href="#referring-to-verification-methods" aria-label="Permalink for Section 2.3.1.3"></a></div>
            
            <p>
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-28">Verification methods</a> can be embedded in or referenced from properties
associated with various <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-2">verification relationships</a> as described in <a href="#verification-relationships" class="sec-ref"><bdi class="secno">2.3.2 </bdi>Verification Relationships</a>. Referencing <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-29">verification methods</a>
allows them to be used by more than one <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-3">verification relationship</a>.
            </p>

            <p>
If the value of a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-30">verification method</a> property is a <a href="https://infra.spec.whatwg.org/#ordered-map">map</a>, the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-31">verification method</a> has been
embedded and its properties can be accessed directly. However, if the value is a
URL <a href="https://infra.spec.whatwg.org/#string">string</a>, the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-32">verification method</a> has
been included by reference and its properties will need to be retrieved from
elsewhere in the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-11">controller document</a> or from another <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-12">controller document</a>. This
is done by dereferencing the URL and searching the resulting <a href="#dfn-resources" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-resources-1">resource</a> for a
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-33">verification method</a> <a href="https://infra.spec.whatwg.org/#ordered-map">map</a> with an
<code>id</code> property whose value matches the URL.
            </p>

            <div class="example" id="example-embedding-and-referencing-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-embedding-and-referencing-verification-methods">Example<bdi> 12</bdi></a><span class="example-title">: Embedding and referencing verification methods</span>
  </div> <pre class="nohighlight">    {
<span class="comment">...</span>

      "authentication": [
        <span class="comment">// this key is referenced and might be used by</span>
        <span class="comment">// more than one verification relationship</span>
        "did:example:123456789abcdefghi#keys-1",
        <span class="comment">// this key is embedded and may *only* be used for authentication</span>
        {
          "id": "did:example:123456789abcdefghi#keys-2",
          "type": "Multikey", <span class="comment">// external (property value)</span>
          "controller": "did:example:123456789abcdefghi",
          "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
        }
      ],

<span class="comment">...</span>
    }</pre>
      </div>
          </section>
        </section>

        <section id="verification-relationships"><div class="header-wrapper"><h4 id="x2-3-2-verification-relationships"><bdi class="secno">2.3.2 </bdi>Verification Relationships</h4><a class="self-link" href="#verification-relationships" aria-label="Permalink for Section 2.3.2"></a></div>
          

          <p>
A <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-4">verification relationship</a> expresses the relationship between the
<a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-9">controller</a> and a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-34">verification method</a>.
          </p>
          <p>
Different <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-5">verification relationships</a> enable the associated
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-35">verification methods</a> to be used for different purposes. It is up to a
<em>verifier</em> to ascertain the validity of a verification attempt by
checking that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-36">verification method</a> used is contained in the
appropriate <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-6">verification relationship</a> property of the
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-13">controller document</a>.
          </p>
          <p>
The <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-7">verification relationship</a> between the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-10">controller</a> and the
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-37">verification method</a> is explicit in the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-14">controller document</a>.
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-38">Verification methods</a> that are not associated with a particular
<a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-8">verification relationship</a> cannot be used for that <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-9">verification
relationship</a>. For example, a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-39">verification method</a> in the value of
the <code><a href="#dfn-authentication" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authentication-1">authentication</a></code> property cannot be used to engage in
key agreement protocols with the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-11">controller</a>—the value of the
<code><a href="#dfn-keyagreement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-keyagreement-1">keyAgreement</a></code> property needs to be used for that.
          </p>
          <p>
The <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-15">controller document</a> does not express revoked keys using a <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-10">verification
relationship</a>. If a referenced verification method is not in the latest
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-16">controller document</a> used to dereference it, then that verification method is
considered invalid or revoked.
          </p>
          <p>
The following sections define several useful <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-11">verification relationships</a>.
A <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-17">controller document</a> <em class="rfc2119">MAY</em> include any of these, or other properties, to
express a specific <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-12">verification relationship</a>. In order to maximize global
interoperability, any such properties used <em class="rfc2119">SHOULD</em> be registered in the
Data Integrity Specification Registries [TBD: DIS-REGISTRIES].
          </p>

          <section id="authentication"><div class="header-wrapper"><h5 id="x2-3-2-1-authentication"><bdi class="secno">2.3.2.1 </bdi>Authentication</h5><a class="self-link" href="#authentication" aria-label="Permalink for Section 2.3.2.1"></a></div>
            

            <p>
The <code>authentication</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-13">verification relationship</a> is used to
specify how the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-12">controller</a> is expected to be <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-2">authenticated</a>, for
purposes such as logging into a website or engaging in any sort of
challenge-response protocol.
            </p>

            <dl>
              <dt><dfn id="dfn-authentication" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">authentication</dfn></dt>
              <dd>
The <code>authentication</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the associated
value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of one or more
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-40">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-41">verification method</a> <em class="rfc2119">MAY</em> be embedded or
referenced.
              </dd>
            </dl>

            <div class="example" id="example-authentication-property-containing-three-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-authentication-property-containing-three-verification-methods">Example<bdi> 13</bdi></a><span class="example-title">: Authentication property
                          containing three verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/multikey/v1"
  ],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "authentication": [
    <span class="comment">// this method can be used to authenticate as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for authentication, it may not</span>
    <span class="comment">// be used for any other proof purpose, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
      "id": "did:example:123456789abcdefghi#keys-2",
      "type": "Multikey",
      "controller": "did:example:123456789abcdefghi",
      "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>

            <p>
If authentication is established, it is up to the application to decide what to
do with that information.
            </p>
            <p>
This is useful to any <em>authentication verifier</em> that needs to check to
see if an entity that is attempting to <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-3">authenticate</a> is, in fact,
presenting a valid proof of authentication. When a <em>verifier</em> receives
some data (in some protocol-specific format) that contains a proof that was made
for the purpose of "authentication", and that says that an entity is identified
by the <code>id</code>, then that <em>verifier</em> checks to ensure that the proof can be
verified using a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-42">verification method</a> (e.g., public key) listed under
<code><a href="#dfn-authentication" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authentication-2">authentication</a></code> in the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-18">controller document</a>.
            </p>
            <p>
Note that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-43">verification method</a> indicated by the
<code><a href="#dfn-authentication" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authentication-3">authentication</a></code> property of a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-19">controller document</a> can
only be used to <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-4">authenticate</a> the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-13">controller</a>. To
<a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-5">authenticate</a> a different <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-14">controller</a>, the entity associated with
the value of <code>controller</code> needs to <a href="#dfn-authenticated" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authenticated-6">authenticate</a> with its
<em>own</em> <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-20">controller document</a> and associated
<code><a href="#dfn-authentication" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-authentication-4">authentication</a></code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-14">verification relationship</a>.
            </p>
          </section>

          <section id="assertion"><div class="header-wrapper"><h5 id="x2-3-2-2-assertion"><bdi class="secno">2.3.2.2 </bdi>Assertion</h5><a class="self-link" href="#assertion" aria-label="Permalink for Section 2.3.2.2"></a></div>
            

            <p>
The <code>assertionMethod</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-15">verification relationship</a> is used to
specify how the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-15">controller</a> is expected to express claims, such as for
the purposes of issuing a Verifiable Credential [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2</a></cite>].
            </p>

            <dl>
              <dt><dfn id="dfn-assertionmethod" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">assertionMethod</dfn></dt>
              <dd>
The <code>assertionMethod</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the
associated value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
one or more <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-44">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-45">verification method</a> <em class="rfc2119">MAY</em> be
embedded or referenced.
              </dd>
            </dl>

            <p>
This property is useful, for example, during the processing of a <a href="#dfn-verifiable-credentials" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verifiable-credentials-1">verifiable
credential</a> by a verifier. During verification, a verifier checks to see if a
<a href="#dfn-verifiable-credentials" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verifiable-credentials-2">verifiable credential</a> contains a proof created by the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-16">controller</a>
by checking that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-46">verification method</a> used to assert the proof is
associated with the <code><a href="#dfn-assertionmethod" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-assertionmethod-1">assertionMethod</a></code> property in the
corresponding <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-21">controller document</a>.
            </p>

            <div class="example" id="example-assertion-method-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-assertion-method-property-containing-two-verification-methods">Example<bdi> 14</bdi></a><span class="example-title">: Assertion method property
                        containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/multikey/v1"
  ],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "assertionMethod": [
    <span class="comment">// this method can be used to assert statements as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for assertion of statements, it is not</span>
    <span class="comment">// used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using a reference</span>
    {
      "id": "did:example:123456789abcdefghi#keys-2",
      "type": "Multikey", <span class="comment">// external (property value)</span>
      "controller": "did:example:123456789abcdefghi",
      "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="key-agreement"><div class="header-wrapper"><h5 id="x2-3-2-3-key-agreement"><bdi class="secno">2.3.2.3 </bdi>Key Agreement</h5><a class="self-link" href="#key-agreement" aria-label="Permalink for Section 2.3.2.3"></a></div>
            

            <p>
The <code>keyAgreement</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-16">verification relationship</a> is used to
specify how an entity can generate encryption material in order to transmit
confidential information intended for the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-17">controller</a>, such as for
the purposes of establishing a secure communication channel with the recipient.
            </p>

            <dl>
              <dt><dfn id="dfn-keyagreement" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">keyAgreement</dfn></dt>
              <dd>
The <code>keyAgreement</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the associated
value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of one or more
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-47">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-48">verification method</a> <em class="rfc2119">MAY</em> be embedded or
referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when encrypting a message intended
for the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-18">controller</a>. In this case, the counterparty uses the
cryptographic public key information in the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-49">verification method</a> to wrap a
decryption key for the recipient.
            </p>

            <div class="example" id="example-key-agreement-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-key-agreement-property-containing-two-verification-methods">Example<bdi> 15</bdi></a><span class="example-title">: Key agreement property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": "https://www.w3.org/ns/did/v1",
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "keyAgreement": [
    <span class="comment">// this method can be used to perform key agreement as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for key agreement usage, it will not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
      "id": "did:example:123#zC9ByQ8aJs8vrNXyDhPHHNNMSHPcaSgNpjjsBYpMMjsTdS",
      "type": "X25519KeyAgreementKey2019", <span class="comment">// external (property value)</span>
      "controller": "did:example:123",
      "publicKeyMultibase": "z6LSn6p3HRxx1ZZk1dT9VwcfTBCYgtNWdzdDMKPZjShLNWG7"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="capability-invocation"><div class="header-wrapper"><h5 id="x2-3-2-4-capability-invocation"><bdi class="secno">2.3.2.4 </bdi>Capability Invocation</h5><a class="self-link" href="#capability-invocation" aria-label="Permalink for Section 2.3.2.4"></a></div>
            

            <p>
The <code>capabilityInvocation</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-17">verification relationship</a> is used
to specify a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-50">verification method</a> that might be used by the
<a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-19">controller</a> to invoke a cryptographic capability, such as the
authorization to update the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-22">controller document</a>.
            </p>

            <dl>
              <dt><dfn id="dfn-capabilityinvocation" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">capabilityInvocation</dfn></dt>
              <dd>
The <code>capabilityInvocation</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the
associated value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
one or more <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-51">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-52">verification method</a> <em class="rfc2119">MAY</em> be
embedded or referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when a <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-20">controller</a> needs to
access a protected HTTP API that requires authorization in order to use it. In
order to authorize when using the HTTP API, the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-21">controller</a>
uses a capability that is associated with a particular URL that is
exposed via the HTTP API. The invocation of the capability could be
expressed in a number of ways, e.g., as a digitally signed
message that is placed into the HTTP Headers.
            </p>
            <p>
The server providing the HTTP API is the <em>verifier</em> of the capability and
it would need to verify that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-53">verification method</a> referred to by the
invoked capability exists in the <code><a href="#dfn-capabilityinvocation" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-capabilityinvocation-1">capabilityInvocation</a></code>
property of the <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-23">controller document</a>. The verifier would also check to make sure
that the action being performed is valid and the capability is appropriate for
the resource being accessed. If the verification is successful, the server has
cryptographically determined that the invoker is authorized to access the
protected resource.
            </p>

            <div class="example" id="example-capability-invocation-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-capability-invocation-property-containing-two-verification-methods">Example<bdi> 16</bdi></a><span class="example-title">: Capability invocation property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/multikey/v1"
  ],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "capabilityInvocation": [
    <span class="comment">// this method can be used to invoke capabilities as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for capability invocation usage, it will not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
    "id": "did:example:123456789abcdefghi#keys-2",
    "type": "Multikey", <span class="comment">// external (property value)</span>
    "controller": "did:example:123456789abcdefghi",
    "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>

          <section id="capability-delegation"><div class="header-wrapper"><h5 id="x2-3-2-5-capability-delegation"><bdi class="secno">2.3.2.5 </bdi>Capability Delegation</h5><a class="self-link" href="#capability-delegation" aria-label="Permalink for Section 2.3.2.5"></a></div>
            

            <p>
The <code>capabilityDelegation</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-18">verification relationship</a> is used
to specify a mechanism that might be used by the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-22">controller</a> to delegate
a cryptographic capability to another party, such as delegating the authority
to access a specific HTTP API to a subordinate.
            </p>

            <dl>
              <dt><dfn class="lint-ignore" id="dfn-capabilitydelegation" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">capabilityDelegation</dfn></dt>
              <dd>
The <code>capabilityDelegation</code> property is <em class="rfc2119">OPTIONAL</em>. If present, the
associated value <em class="rfc2119">MUST</em> be a <a href="https://infra.spec.whatwg.org/#ordered-set">set</a> of
one or more <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-54">verification methods</a>. Each <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-55">verification method</a> <em class="rfc2119">MAY</em> be
embedded or referenced.
              </dd>
            </dl>

            <p>
An example of when this property is useful is when a <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-23">controller</a> chooses
to delegate their capability to access a protected HTTP API to a party other
than themselves. In order to delegate the capability, the <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-24">controller</a>
would use a <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-56">verification method</a> associated with the
<code>capabilityDelegation</code> <a href="#dfn-verification-relationship" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-relationship-19">verification relationship</a> to
cryptographically sign the capability over to another <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-25">controller</a>. The
delegate would then use the capability in a manner that is similar to the
example described in <a href="#capability-invocation" class="sec-ref"><bdi class="secno">2.3.2.4 </bdi>Capability Invocation</a>.
            </p>

            <div class="example" id="example-capability-delegation-property-containing-two-verification-methods">
        <div class="marker">
    <a class="self-link" href="#example-capability-delegation-property-containing-two-verification-methods">Example<bdi> 17</bdi></a><span class="example-title">: Capability Delegation property
                          containing two verification methods</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/multikey/v1"
  ],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "capabilityDelegation": [
    <span class="comment">// this method can be used to perform capability delegation as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* approved for granting capabilities; it will not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
    "id": "did:example:123456789abcdefghi#keys-2",
    "type": "Multikey", <span class="comment">// external (property value)</span>
    "controller": "did:example:123456789abcdefghi",
    "publicKeyMultibase": "z6MkmM42vxfqZQsv4ehtTjFFxQ4sQKS2w6WR7emozFAn5cxu"
    }
  ],
  <span class="comment">...</span>
}</pre>
      </div>
          </section>
        </section>
      </section>

      <section id="relationship-to-linked-data"><div class="header-wrapper"><h3 id="x2-4-relationship-to-linked-data"><bdi class="secno">2.4 </bdi>Relationship to Linked Data</h3><a class="self-link" href="#relationship-to-linked-data" aria-label="Permalink for Section 2.4"></a></div>
        
        <p>
The term Linked Data is used to describe a recommended best practice for
exposing, sharing, and connecting information on the Web using standards, such
as URLs, to identify things and their properties. When information is presented
as Linked Data, other related information can be easily discovered and new
information can be easily linked to it. Linked Data is extensible in a
decentralized way, greatly reducing barriers to large scale integration.
        </p>

        <p>
With the increase in usage of Linked Data for a variety of applications, there
is a need to be able to verify the authenticity and integrity of Linked Data
documents. This specification adds authentication and integrity protection to
data documents through the use of mathematical proofs without sacrificing Linked
Data features such as extensibility and composability.
        </p>

        <div class="note" role="note" id="issue-container-generatedID-11"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span>Note</span><span class="issue-label">: Use of Linked Data is an optional feature</span></div><p class="">
While  this specification provides mechanisms to digitally sign Linked Data, the
use  of Linked Data is not necessary to gain some of the advantages provided by
this specification.
        </p></div>

      </section>

    </section>

    

    <section id="cryptographic-suites"><div class="header-wrapper"><h2 id="x3-cryptographic-suites"><bdi class="secno">3. </bdi>Cryptographic Suites</h2><a class="self-link" href="#cryptographic-suites" aria-label="Permalink for Section 3."></a></div>
      
      <p>
A data integrity proof is designed to be easy to use by developers and therefore
strives to minimize the amount of information one has to remember to generate a
proof. Often, just the <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-5">cryptographic suite</a> name (e.g.
<code>eddsa-2022</code>) is required from developers to initiate the creation of
a proof. These <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-6">cryptographic suite</a>s are often created or reviewed by
people that have the requisite cryptographic training to ensure that safe
combinations of cryptographic primitives are used. This section specifies the
requirements for authoring cryptographic suite specifications.
      </p>

      <p>
The requirements for all data integrity cryptographic suite specifications are
as follows:
      </p>

      <ul>
        <li>
The specification <em class="rfc2119">MUST</em> be published as a human-readable document at a URL.
        </li>
        <li>
The specification <em class="rfc2119">MUST</em> identify a cryptographic suite <code>type</code> and any
parameters that can be used with the suite.
        </li>
        <li>
The specification <em class="rfc2119">MUST</em> detail the <a href="#dfn-transformation-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transformation-algorithm-1">transformation algorithms</a> (if any),
parameters, and other necessary details, used to modify input data into the data
to be protected.
        </li>
        <li>
The specification <em class="rfc2119">MUST</em> detail the <a href="#dfn-hashing-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hashing-algorithm-1">hashing algorithms</a>
parameters, and other necessary details used to perform cryptographic hashing to
the data to be protected.
        </li>
        <li>
The specification <em class="rfc2119">MUST</em> detail the <a href="#dfn-proof-generation-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-generation-algorithm-1">proof generation algorithms</a>,
parameters, and other necessary details used to perform cryptographic protection
of the data.
        </li>
        <li>
The specification <em class="rfc2119">MUST</em> detail the <a href="#dfn-proof-verification-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-verification-algorithm-1">proof verification algorithms</a>,
parameters, and other necessary details used to perform cryptographic
verification of the data.
        </li>
        <li>
The specification <em class="rfc2119">MUST</em> contain a Security Considerations section detailing
security considerations specific to the cryptographic suite.
        </li>
        <li>
The specification <em class="rfc2119">MUST</em> contain a Privacy Considerations section detailing
privacy considerations specific to the cryptographic suite.
        </li>
      </ul>

      <div class="issue" id="issue-container-generatedID-12"><div role="heading" class="issue-title marker" id="h-issue-8" aria-level="3"><span>Issue</span><span class="issue-label">: Require interoperability report?</span></div><p class="">
The following language was deemed to be contentious: <em>The specification <em class="rfc2119">MUST</em>
provide a link to an interoperability test report to document which
implementations are conformant with the cryptographic suite specification.</em>
        <br>
        <br>
The Working Group is seeking feedback on whether or not this is desired given
the important role that cryptographic suite specifications play in ensuring
data integrity.
      </p></div>

      <section id="dataintegrityproof"><div class="header-wrapper"><h3 id="x3-1-dataintegrityproof"><bdi class="secno">3.1 </bdi>DataIntegrityProof</h3><a class="self-link" href="#dataintegrityproof" aria-label="Permalink for Section 3.1"></a></div>
        

        <p>
A number of cryptographic suites follow the same basic pattern when expressing a
data integrity proof. This section specifies that general design pattern, a
cryptographic suite type called a <code>DataIntegrityProof</code>, which reduces the burden
of writing and implementing cryptographic suites through the reuse of design
primitives and source code.
        </p>

        <p>
When specifing a cryptographic suite that utilizes this design pattern, the
<code>proof</code> value takes the following form:
        </p>

        <dl>
          <dt>type</dt>
          <dd>
The <code>type</code> property <em class="rfc2119">MUST</em> contain the string <code>DataIntegrityProof</code>.
          </dd>
          <dt>cryptosuite</dt>
          <dd>
The <code>cryptosuite</code> property <em class="rfc2119">MUST</em> contain a string specifying the name of the
cryptosuite.
          </dd>
          <dt>proofValue</dt>
          <dd>
The <code>proofValue</code> property <em class="rfc2119">MUST</em> be used, as specified in <a href="#proofs" class="sec-ref"><bdi class="secno">2.1 </bdi>Proofs</a>.
          </dd>
        </dl>

        <p>
Cryptographic suite designers <em class="rfc2119">MUST</em> use mandatory <code>proof</code> value properties
defined in Section <a href="#proofs" class="sec-ref"><bdi class="secno">2.1 </bdi>Proofs</a>, and <em class="rfc2119">MAY</em> define other properties
specific to their cryptographic suite.
        </p>
      </section>

    </section>

    <section id="algorithms"><div class="header-wrapper"><h2 id="x4-algorithms"><bdi class="secno">4. </bdi>Algorithms</h2><a class="self-link" href="#algorithms" aria-label="Permalink for Section 4."></a></div>
      

      <p>
The algorithms defined below are generalized in that they require a specific
<a href="#dfn-transformation-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transformation-algorithm-2">transformation algorithm</a>, <a href="#dfn-hashing-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hashing-algorithm-2">hashing algorithm</a>,
<a href="#dfn-proof-generation-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-generation-algorithm-2">proof generation algorithm</a>, and <a href="#dfn-proof-verification-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-verification-algorithm-2">proof verification algorithm</a> to be
specified by a particular cryptographic suite (see Section
<a href="#cryptographic-suites" class="sec-ref"><bdi class="secno">3. </bdi>Cryptographic Suites</a>).
      </p>

      <div class="issue" id="issue-container-generatedID-13"><div role="heading" class="issue-title marker" id="h-issue-9" aria-level="3"><span>Issue</span><span class="issue-label">: Generate verification hash algorithm</span></div><p class="">
At present the creation of the verification hash is delegated to the
cryptographic suite specification when generating and verifying a proof. It is
expected that this algorithm is going to be common to most cryptographic suites.
It is predicted that the verification hash generation algorithm will eventually
be defined in this specification.
      </p></div>

      <section class="normative" id="generate-proof"><div class="header-wrapper"><h3 id="x4-1-generate-proof"><bdi class="secno">4.1 </bdi>Generate Proof</h3><a class="self-link" href="#generate-proof" aria-label="Permalink for Section 4.1"></a></div>
        

        <p>
The following algorithm specifies how to create a digital proof that can be used
to verify the authenticity and integrity of an
<dfn id="dfn-unsecured-data-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">unsecured data document</dfn>. Required inputs are an
<a href="#dfn-unsecured-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-unsecured-data-document-1">unsecured data document</a> (<var>unsecuredDocument</var>) and
<a href="#dfn-proof-options" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-options-1">proof options</a> (<var>options</var>). The
<a href="#dfn-proof-options" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-options-2">proof options</a> <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-7">cryptographic suite</a> (<var>type</var>) and any other properties needed by
the <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-8">cryptographic suite</a> type; an identifier for the
<a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-57">verification method</a> (<var>verificationMethod</var>) that can be used to
verify the authenticity of the proof; and an [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>] combined date
and time string (<var>created</var>) containing the current date and time,
accurate to at least one second, in Universal Time Code format. A
<a href="#dfn-domain" id="ref-for-dfn-domain-5">security domain</a> (<var>domain</var>) and
receiver-supplied challenge (<var>challenge</var>) might also be specified in
the <var>options</var>. A <dfn id="dfn-secured-data-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">secured data document</dfn> is produced as
output. Whenever this algorithm encodes strings, it <em class="rfc2119">MUST</em> use UTF-8 encoding.
        </p>

        <ol class="algorithm">
          <li>
Let <var>output</var> be a copy of <var>unsecuredDocument</var>.
          </li>
          <li>
Let <var>transformedDocument</var> be the result of
<a href="#dfn-transformation" id="ref-for-dfn-transformation-2">transforming</a> <var>unsecuredDocument</var>
according to a <a href="#dfn-transformation-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transformation-algorithm-3">transformation algorithm</a> associated with the
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-9">cryptographic suite</a> and the <var>options</var> parameters provided
as inputs to the algorithm.
          </li>
          <li>
Let <var>hashData</var> be the result of
<a href="#dfn-hashing" id="ref-for-dfn-hashing-2">hashing</a> the <var>transformedDocument</var>
according to a <a href="#dfn-hashing-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hashing-algorithm-3">hashing algorithm</a> associated with the
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-10">cryptographic suite</a> and the <var>options</var> parameters provided as
inputs to the algorithm.
          </li>
          <li>
Let <var>proof</var> be the result of running the
<a href="#dfn-proof-generation-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-generation-algorithm-3">proof generation algorithm</a> associated with the <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-11">cryptographic suite</a>
with the <var>hashData</var> and <var>options</var> parameters provided
as inputs to the algorithm.
          </li>
          <li>
If the <var>proof</var>.<var>type</var>,
<var>proof</var>.<var>verificationMethod</var>,
or <var>proof</var>.<var>proofPurpose</var> values are not set, a
<code>PROOF_GENERATION_ERROR</code> <em class="rfc2119">MUST</em> be raised.
          </li>
          <li>
If the <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-12">cryptographic suite</a> requires the use of a created timestamp,
and the <var>proof</var>.<var>created</var> value is not set, a
<code>PROOF_GENERATION_ERROR</code> <em class="rfc2119">MUST</em> be raised.
          </li>
          <li>
If <var>options</var>.<var>domain</var> is set, it <em class="rfc2119">MUST</em> be equal to
<var>proof</var>.<var>domain</var> or a <code>PROOF_GENERATION_ERROR</code> <em class="rfc2119">MUST</em> be raised.
          </li>
          <li>
If <var>options</var>.<var>challenge</var> is set, it <em class="rfc2119">MUST</em> be equal to
<var>proof</var>.<var>challenge</var> or a <code>PROOF_GENERATION_ERROR</code> <em class="rfc2119">MUST</em> be
raised.
          </li>
          <li>
Set <var>output</var>.<var>proof</var> to the value of <var>proof</var>.
          </li>
          <li>
Return <var>output</var> as the <a href="#dfn-secured-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-secured-data-document-1">secured data document</a>.
          </li>
        </ol>

        <div class="note" role="note" id="issue-container-generatedID-14"><div role="heading" class="note-title marker" id="h-note-3" aria-level="4"><span>Note</span><span class="issue-label">: `hashData` might not consist of a single value</span></div><p class="">
While the output of the <a href="#dfn-hashing-algorithm" id="ref-for-dfn-hashing-algorithm-4">hashing algorithm</a>
can be a single value, such as a 32 byte SHA2-256 value, implementers are
advised that some cryptographic suite(s) might define <code>hashData</code> to be
comprised of multiple values that might be processed independently in the proof
generation algorithm. For example, this approach is known to be taken in certain
cryptographic suites that allow selective disclosure or unlinkability via the
digital proof.
        </p></div>

      </section>

      <section id="verify-proof"><div class="header-wrapper"><h3 id="x4-2-verify-proof"><bdi class="secno">4.2 </bdi>Verify Proof</h3><a class="self-link" href="#verify-proof" aria-label="Permalink for Section 4.2"></a></div>
        

        <p>
The following algorithm specifies how to check the authenticity and
integrity of a <a href="#dfn-secured-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-secured-data-document-2">secured data document</a> by verifying its
digital proof. Required inputs are a
<a href="#dfn-secured-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-secured-data-document-3">secured data document</a> (<var>securedDocument</var>) and
<a href="#dfn-proof-options" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-options-3">proof options</a> (<var>options</var>). A <dfn id="dfn-verification-result" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification result</dfn> is
produced as output.
        </p>

        <ol class="algorithm">
          <li>
Let <var>proof</var> be set to <var>securedDocument</var>.<var>proof</var>.
          </li>
          <li>
If the <var>proof</var>.<var>type</var>,
<var>proof</var>.<var>verificationMethod</var>, or
<var>proof</var>.<var>proofPurpose</var> values are not set, a
<code>MALFORMED_PROOF_ERROR</code> <em class="rfc2119">MUST</em> be raised.
          </li>
          <li>
If the cryptographic suite requires the
<var>proof</var>.<var>created</var> value, and it
is not set, a <code>MALFORMED_PROOF_ERROR</code>
<em class="rfc2119">MUST</em> be raised.
          </li>
          <li>
If the <var>proof</var>.<var>proofPurpose</var> value does not match
<var>options</var>.<var>expectedProofPurpose</var>, a
<code>MISMATCHED_PROOF_PURPOSE_ERROR</code> <em class="rfc2119">MUST</em> be raised.
          </li>
          <li>
Let <var>unsecuredDocument</var> be a copy of <var>securedDocument</var> with
the <code>proof</code> value removed.
          </li>
          <li>
Let <var>transformedDocument</var> be the result of
<a href="#dfn-transformation" id="ref-for-dfn-transformation-3">transforming</a> the <var>unsecuredDocument</var>
according to a <a href="#dfn-transformation-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-transformation-algorithm-4">transformation algorithm</a> associated with the
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-13">cryptographic suite</a> specified in <var>proof</var> and the
<var>options</var> parameters provided as inputs to the algorithm.
The type of <a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-14">cryptographic suite</a> is specified by the
<var>proof.type</var> value and <em class="rfc2119">MAY</em> be further described by
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-15">cryptographic suite</a>-specific properties expressed in <var>proof</var>.
        </li>
          <li>
Let <var>hashData</var> be the result of
<a href="#dfn-hashing" id="ref-for-dfn-hashing-3">hashing</a> the <var>transformedDocument</var>
according to a <a href="#dfn-hashing-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-hashing-algorithm-5">hashing algorithm</a> associated with the
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-16">cryptographic suite</a> specified in the <var>proof</var> and
<var>options</var> parameters provided as inputs to the algorithm.
          </li>
          <li>
Let <var>isProofVerified</var> be the result of running the
<a href="#dfn-proof-verification-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-proof-verification-algorithm-3">proof verification algorithm</a> associated with the
<a href="#dfn-cryptosuite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-cryptosuite-17">cryptographic suite</a> with the <var>hashData</var> and <var>options</var>
parameters provided as inputs to the algorithm.
          </li>
          <li>
If the <var>proof</var>.<var>created</var> is set and it deviates more than
<var>options</var>.<var>acceptableCreatedTimeDeviationInSeconds</var> seconds, a
<code>CREATED_TIME_DEVIATION_ERROR</code> <em class="rfc2119">MUST</em> be raised.
          </li>
          <li>
If <var>options</var>.<var>domain</var> is set and it does not match
<var>proof</var>.<var>domain</var>, an <code>INVALID_DOMAIN_ERROR</code> <em class="rfc2119">MUST</em> be raised.
          </li>
          <li>
If <var>options</var>.<var>challenge</var> is set and it does not match
<var>proof</var>.<var>challenge</var>, an <code>INVALID_CHALLENGE_ERROR</code> <em class="rfc2119">MUST</em> be
raised.
          </li>
          <li>
Return <var>isProofVerified</var> as the <a href="#dfn-verification-result" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-result-1">verification result</a>.
          </li>
        </ol>

        <div class="issue" id="issue-container-generatedID-15"><div role="heading" class="issue-title marker" id="h-issue-10" aria-level="4"><span>Issue</span><span class="issue-label">: Define how verification material is retrieved</span></div><p class="">
Specify how <var>proof</var>.<var>verificationMethod</var> can be obtained,
e.g., through some out-of-band process, by
dereferencing its URL identifier, etc. It is expected that the <a href="#dfn-public-key" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-public-key-1">public key</a>
is retrieved by dereferencing its URL identifier in the <code>proof</code> node
of the default graph of <var>securedDocument</var>. The algorithm needs to
confirm that the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-58">verification method</a> that describes the cryptographic
material, such as the <a href="#dfn-public-key" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-public-key-2">public key</a>, specifies its <a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-26">controller</a>, and
that its controllers's URL identifier can be dereferenced to reveal a
bi-directional link back to the key. Ensure that the key's controller is a
trusted entity before proceeding to the next step.
        </p></div>

      </section>

    </section>

    <section id="security-considerations"><div class="header-wrapper"><h2 id="x5-security-considerations"><bdi class="secno">5. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 5."></a></div>
      
      <p>
The following section describes security considerations that developers
implementing this specification should be aware of in order to create secure
software.
      </p>

      <section id="versioning-cryptography-suites"><div class="header-wrapper"><h3 id="x5-1-versioning-cryptography-suites"><bdi class="secno">5.1 </bdi>Versioning Cryptography Suites</h3><a class="self-link" href="#versioning-cryptography-suites" aria-label="Permalink for Section 5.1"></a></div>
        

        <p>
Cryptography secures information through the use of secrets. Knowledge of the
necessary secret makes it computationally easy to access certain information. The
same information can be accessed if a computationally-difficult, brute-force effort
successfully guesses the secret. All modern cryptography requires the
computationally difficult approach to remain difficult throughout time, which
does not always hold due to breakthroughs in science and mathematics. That is
to say that <em>Cryptography has a shelf life</em>.
        </p>
        <p>
This specification plans for the obsolescence of all cryptographic approaches by
asserting that whatever cryptography is in use today is highly likely to be
broken over time. Software systems have to be able to change the cryptography
in use over time in order to continue to secure information. Such changes might
involve increasing required secret sizes or modifications to the cryptographic
primitives used. However, some combinations of cryptographic parameters
might actually reduce security. Given these assumptions, systems need to be able to
distinguish different combinations of safe cryptographic parameters, also known
as cryptographic suites, from one another. When identifying or versioning
cryptographic suites, there are several approaches that can be taken which
include: parameters, numbers, and dates.
        </p>
        <p>
Parametric versioning specifies the particular cryptographic parameters that are
employed in a cryptographic suite. For example, one could use an identifier such
as <code>RSASSA-PKCS1-v1_5-SHA1</code>. The benefit to this scheme is that a well-trained
cryptographer will be able to determine all of the parameters in play by the
identifier. The drawback to this scheme is that most of the population that
uses these sorts of identifiers are not well trained and thus will not understand
that the previously mentioned identifier is a cryptographic suite that is no
longer safe to use. Additionally, this lack of knowledge might lead software
developers to generalize the parsing of cryptographic suite identifiers
such that any combination of cryptographic primitives becomes acceptable,
resulting in reduced security. Ideally, cryptographic suites are implemented
in software as specific, acceptable profiles of cryptographic parameters instead.
        </p>
        <p>
Numbered versioning might specify a major and minor version number such as
<code>1.0</code> or <code>2.1</code>. Numbered versioning conveys a specific order and suggests that
higher version numbers are more capable than lower version numbers. The benefit
of this approach is that it removes complex parameters that less expert
developers might not understand with a simpler model that conveys that an
upgrade might be appropriate. The drawback of this approach is that its not
clear if an upgrade is necessary, as software version number increases often
don't require an upgrade for the software to continue functioning. This can
lead to developers thinking their usage of a particular version is safe, when
it is not. Ideally, additional signals would be given to developers that use
cryptographic suites in their software that periodic reviews of those
suites for continued security are required.
        </p>
        <p>
Date-based versioning specifies a particular release date for a specific
cryptographic suite. The benefit of a date, such as a year, is that it is
immediately clear to a developer if the date is relatively old or new. Seeing
an old date might prompt the developer to go searching for a newer
cryptographic suite, where as a parametric or number-based versioning scheme
might not. The downside of a date-based version is that some cryptographic
suites might not expire for 5-10 years, prompting the developer to go
searching for a newer cryptographic suite only to not find one that is newer.
While this might be an inconvenience, it is one that results in safer
ecosystem behavior.
        </p>
        <div class="issue" id="issue-container-number-38"><div role="heading" class="issue-title marker" id="h-issue-11" aria-level="4"><a href="https://github.com/w3c/vc-data-integrity/issues/38"><span class="issue-number">Issue 38</span></a><span class="issue-label">: Determine how cryptographic suites are versioned</span></div><p class="">
The following text is currently under debate:<br><br>
It is highly encouraged that cryptographic suite identifiers are versioned
using a year designation. For example, the cryptographic suite identifier
<code>ecdsa-2022</code> implies that the suite is probably an acceptable of ECDSA in the
year 2025, but might not be a safe choice in the year 2042. A date-based
versioning mechanism, however, is not enough by itself. All cryptographic
suites that follow this specification are intended to be registered
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-extension-registry" title="Verifiable Credentials Extension Registry">VC-EXTENSION-REGISTRY</a></cite>] in a way that clearly signal which cryptosuites
are deprecated, standardized, or experimental. Cryptosuite registration will
follow CFRG, IETF, NIST, FIPS, and safecurves guidance. Use of deprecated suites
are expected to throw errors in implementations unless a <code>useUnsafeCryptosuites</code>
option is used specifying exactly the unsafe cryptosuite to use.
Use of experimental suites are expected to throw errors in implementations
unless a <code>useExperimentalCryptosuites</code> option is used specifying exactly
the experimental cryptosuite to use.
        </p></div>

        <div class="issue" id="issue-container-generatedID-16"><div role="heading" class="issue-title marker" id="h-issue-12" aria-level="4"><span>Issue</span><span class="issue-label">: Resolve VC Extension Registry Governance</span></div><p class="">
The following text is debated due to the governance rules of the VC
Extension Registry not being finalized:<br><br>
Developers are urged to always refer to the [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-extension-registry" title="Verifiable Credentials Extension Registry">VC-EXTENSION-REGISTRY</a></cite>] for
the latest standardized cryptography suites as well as cross-checking their
usage against, at least, the
<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">
COSE Algorithms Registry</a>, the
<a href="https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms">
JOSE Algorithms Registry</a>, and the latest
<a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">
FIPS Digital Signature Standard
</a> guidance.  Depending on your jurisdiction you may also need to consider
additional guidance from
<a href="https://www.etsi.org/deliver/etsi_ts/119300_119399/119312/01.02.01_60/ts_119312v010201p.pdf">ETSI</a>
or other regional regulatory and standards bodies.
        </p></div>
      </section>

      <section id="protecting-application-developers"><div class="header-wrapper"><h3 id="x5-2-protecting-application-developers"><bdi class="secno">5.2 </bdi>Protecting Application Developers</h3><a class="self-link" href="#protecting-application-developers" aria-label="Permalink for Section 5.2"></a></div>
        

        <p>
Modern cryptographic algorithms provide a number of tunable parameters and
options to ensure that the algorithms can meet the varied requirements of different use cases.
For example, embedded systems have limited processing and memory environments
and might not have the resources to generate the strongest digital signatures
for a given algorithm. Other environments, like financial trading systems,
might only need to protect data for a day while the trade is occurring, while
other environments might need to protect data for multiple decades. To meet
these needs, cryptographic algorithm designers often provide multiple ways to
configure a cryptographic algorithm.
        </p>
        <p>
Cryptographic library implementers often take the specifications created by
cryptographic algorithm designers and specification authors and implement them
such that all options are available to the application developers that use their
libraries. This can be due to not knowing which combination of features a
particular application developer might need for a given cryptographic deployment.
All options are often exposed to application developers.
        </p>
        <p>
Application developers that use cryptographic libraries often do not have the
requisite cryptographic expertise and knowledge necessary to appropriately
select cryptographic parameters and options for a given application. This lack
of expertise can lead to an inappropriate selection of cryptographic parameters
and options for a particular application.
        </p>
        <p>
This specification sets the priority of constituencies to protect application
developers over cryptographic library implementers over cryptographic
specification authors over cryptographic algorithm designers. Given these
priorities, the following recommendations are made:
        </p>
        <ul>
          <li>
Cryptographic algorithm designers are advised [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7696" title="Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms">RFC7696</a></cite>] to minimize the
number of options and parameters to as few as possible to ensure that
cryptographic library implementers have a more easily auditable security attack
surface for their software libraries.
          </li>
          <li>
Cryptographic specification authors are advised to, if possible, further
minimize the number of options and parameters to as few as possible to ensure
cryptographic agility while also keeping the auditable security
attack surface for downstream software libraries to a minimum.
          </li>
          <li>
Cryptographic library implementers are advised to, if possible, provide known
good combinations of options and parameters to application developers. There
would ideally be two pre-set default configurations for any algorithmic
class, such as Elliptic Curve Digital Signatures, with no ability
to fine tune parameters and options when using these pre-sets. Library options can be provided to
experts to fine tune their use of the library, use of those options by the general
application developer population is to be discouraged.
          </li>
          <li>
Application developers are advised to choose from a number of pre-set
cryptography library configurations and to avoid modifying cryptographic
options and parameters, or using experimental or deprecated cryptography.
          </li>
        </ul>

        <p>
The guidance above is meant to ensure that useful cryptographic options and
parameters are provided at the lower layers of the architecture while not
exposing those options and parameters to application developers who may not
fully understand the balancing benefits and drawbacks of each option.
        </p>

        <div class="issue" id="issue-container-generatedID-17"><div role="heading" class="issue-title marker" id="h-issue-13" aria-level="4"><span>Issue</span><span class="issue-label">: Use of experimental and deprecated cryptography</span></div><p class="">
The VCWG is seeking guidance on adding language to allow the use of experimental
or deprecated cryptography. By default, those features will be disabled and will
require the application developer to specifically allow use on a per-cryptographic suite
basis. There will be requirements for all implementing libraries to throw errors
or warnings when deprecated or experimental options are selected without the
appropriate override flags.
        </p></div>
      </section>

      <section id="agility-and-layering"><div class="header-wrapper"><h3 id="x5-3-agility-and-layering"><bdi class="secno">5.3 </bdi>Agility and Layering</h3><a class="self-link" href="#agility-and-layering" aria-label="Permalink for Section 5.3"></a></div>
        

        <p>
<dfn class="lint-ignore" id="dfn-cryptographic-agility" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Cryptographic agility</dfn> is a practice by which one designs
<em>frequently connected</em> information security systems to support
<em>switching between multiple cryptographic primitives and/or algorithms</em>. The primary
goal of cryptographic agility is to enable systems to rapidly adapt to new
cryptographic primitives and algorithms without making disruptive changes to the
systems' infrastructure. Thus, when a particular cryptographic primitive, such
as the SHA-1 algorithm, is determined to be no longer safe to use, systems can
be reconfigured to use a newer primitive via a simple configuration file change.
        </p>
        <p>
Cryptographic agility is most effective when the client and the server in
the information security system are in regular contact. However, when the
messages protected by a particular cryptographic algorithm are long-lived, as
with Verifiable Credentials, and/or when the client (holder) might not be
able to easily recontact the server (issuer), then cryptographic agility does
not provide the desired protections.
        </p>
        <p>
<dfn class="lint-ignore" id="dfn-cryptographic-layering" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Cryptographic layering</dfn> is a practice where one
designs <em>rarely connected</em> information security systems to
<em>employ multiple primitives and/or algorithms at the same time</em>. The
primary goal of cryptographic layering is to enable systems to survive the
failure or one or more cryptographic algorithms or primitives without losing
cryptographic protection on the payload. For example, digitally signing a single
piece of information using RSA, ECDSA, and Falcon algorithms in parallel would
provide a mechanism that could survive the failure of two of these three digital
signature algorithms. When a particular cryptographic protection is compromised,
such as an RSA digital signature using 768-bit keys, systems can still utilize
the non-compromised cryptographic protections to continue to protect the
information. Developers are urged to take advantage of this feature for all
signed content that might need to be protected for a year or longer.
        </p>
        <p>
This specification provides for both forms of agility. It provides for
cryptographic agility, which allows one to easily switch from one algorithm to
another. It also provides for cryptographic layering, which allows one to
simultaneously use multiple cryptographic algorithms, typically in parallel,
such that any of those used to protect information can be used without reliance
on or requirement of the others, while still keeping the digital proof format
easy to use for developers.
        </p>
        <p>
        </p>
      </section>

      <section id="transformations"><div class="header-wrapper"><h3 id="x5-4-transformations"><bdi class="secno">5.4 </bdi>Transformations</h3><a class="self-link" href="#transformations" aria-label="Permalink for Section 5.4"></a></div>
        

        <p>
At times, it is beneficial to transform the data being protected during the
cryptographic protection process. Such "in-line" transformation can enable a
particular type of cryptographic protection to be agnostic to the data format it
is carried in. For example, some Data Integrity cryptographic suites utilize RDF
Dataset Canonicalization [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-c14n" title="RDF Dataset Canonicalization">RDF-DATASET-C14N</a></cite>] which transforms the initial
representation into a canonical form [<cite><a class="bibref" data-link-type="biblio" href="#bib-n-quads" title="RDF 1.1 N-Quads">N-QUADS</a></cite>] that is then serialized,
hashed, and digitally signed. As long as any syntax expressing the protected
data can be transformed into this canonical form, the digital signature can be
verified. This enables the same digital signature over the information to be
expressed in JSON, CBOR, YAML, and other compatible syntaxes without having to
create a cryptographic proof for every syntax.
        </p>
        <p>
Being able to express the same digital signature across a variety of syntaxes is
beneficial because systems often have native data formats with which they
operate. For example, some systems are written against JSON data, while others
are written against CBOR data. Without transformation, systems that process
their data internally as CBOR are required to store the digitally signed data
structures as JSON (or vice-versa). This leads to double-storing data and can
lead to increased security attack surface if the unsigned representation stored in
databases accidentally deviates from the signed representation. By using
transformations, the digital proof can live in the native data format to
help prevent otherwise undetectable database drift over time.
        </p>
        <p>
This specification is designed to avoid requiring the duplication of signed
information by utilizing "in-line" data transformations. Application developers are urged
to work with cryptographically protected data in the native data format for
their application and not separate storage of cryptographic proofs from the data
being protected. Developers are also urged to regularly confirm that the
cryptographically protected data has not been tampered with as it is written to
and read from application storage.
        </p>
        <div class="issue" id="issue-container-generatedID-18"><div role="heading" class="issue-title marker" id="h-issue-14" aria-level="4"><span>Issue</span><span class="issue-label">: Collision-resistant canonicalization requirements</span></div><p class="">
The VCWG is seeking feedback on normative language that cryptographic suite
implementers need to follow to ensure that they do not utilize data
transformation mechanisms that can map to the same output. That is, given
different inputs for canonicalization scheme #1 and canonicalization scheme #2,
they must not produce the same output value. As an analogy, this is the same
requirement for cryptographic hashing mechanisms and is why those schemes are
designed to be collision resistant. Cryptographic canonicalization mechanisms
have the same requirement. At present, this isn't a problem because the three
expected canonicalization schemes — the Universal RDF Dataset
Canonicalization Algorithm 2015 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-c14n" title="RDF Dataset Canonicalization">RDF-DATASET-C14N</a></cite>], JSON Canonicalization
Scheme [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>], and a theoretical future base-encoding canonicalization
— have entirely different outputs.
        </p></div>
        <div class="issue" id="issue-container-generatedID-19"><div role="heading" class="issue-title marker" id="h-issue-15" aria-level="4"><span>Issue</span><span class="issue-label">: Avoiding the pitfalls of XML Canonicalization</span></div><p class="">
The VCWG is seeking feedback on whether to explain why modern canonicalization
schemes are simpler than the far more complex XML Canonicalization schemes of
the early 2000s. Some readers seem to be under the impression that all
canonicalization is difficult and has to be avoided at all costs (including costs
to application developers). The WG would like to understand if it would be helpful
to include a section explaining why some simpler data syntaxes (such as JSON) are
easier to canonicalize than more complex data syntaxes (such as XML).
        </p></div>
      </section>

      <section id="data-opacity"><div class="header-wrapper"><h3 id="x5-5-data-opacity"><bdi class="secno">5.5 </bdi>Data Opacity</h3><a class="self-link" href="#data-opacity" aria-label="Permalink for Section 5.5"></a></div>
        

        <p>
The inspectability of application data has effects on system efficiency and
developer productivity. When cryptographically protected application data, such
as base-encoded binary data, is not easily processed by application subsystems,
such as databases, it increases the effort of working with the cryptographically
protected information. For example, a cryptographically protected payload that
can be natively stored and indexed by a database will result in a simpler system
that:
        </p>

        <ul>
          <li>
benefits from utilizing existing industry-standard database features with no
changes to the protected information,
          </li>
          <li>
avoids the complexity of duplicating data where one copy of the data preserves
the message and digital signature, while the other copy only stores and indexes
the message and is what drives system behaviour,
          </li>
          <li>
avoids the complexity of bespoke solutions that have to structurally modify
the protected information, such as serializing and deserializing nested
digitally signed data that has multiple nested base-encoded payloads.
          </li>
        </ul>

        <p>
Similarly, a cryptographically protected payload that can be processed by
multiple upstream networked systems increases the ability to properly layer
security architectures. For example, if upstream systems do not have to
repeatedly decode the incoming payload, it increases the ability for a system to
distribute processing load by specializing upstream subsystems to actively
combat attacks. While a digital signature needs to always be checked before
taking substantive action, other upstream checks can be performed on transparent
payloads — such as identifier-based rate limiting, signature expiration
checking, or nonce/challenge checking — to reject obviously bad requests.
        </p>
        <p>
Additionally, if a developer is not able to easily view data in a system, the
ability to easily audit or debug system correctness is hampered. For example,
requiring application developers to cut-and-paste base-encoded application data
makes development more challenging and increases the chances that obvious bugs
will be missed because every message needs to go through a manually operated
base-decoding tool.
        </p>
        <p>
There are times, however, where the correct design decision is to make data
opaque. Data that does not need to be processed by other application subsystems,
as well as data that does not need to be modified or accessed by an application
developer, can be serialized into opaque formats. Examples include digital
signature values, cryptographic key parameters, and other data fields that only
need to be accessed by a cryptographic library and need not be modified by the
application developer. There are also examples where data opacity is appropriate
when the underlying subsystem does not expose the application developer to the
underlying complexity of the opaque data, such as databases that perform
encryption at rest. In these cases, the application developer continues to
develop against transparent application data formats while the database manages
the complexity of encrypting and decrypting the application data to and from
long-term storage.
        </p>
        <p>
This specification strives to provide an architecture where application data
remains in its native format and is not made opaque, while other cryptographic
data, such as digital signatures, are kept in their opaque binary encoded form.
Cryptographic suite implementers are urged to consider appropriate use of data
opacity when designing their suites, and to weigh the design trade-offs when
making application data opaque versus providing access to cryptographic data at
the application layer.
        </p>
      </section>

      <section id="verification-method-binding"><div class="header-wrapper"><h3 id="x5-6-verification-method-binding"><bdi class="secno">5.6 </bdi>Verification Method Binding</h3><a class="self-link" href="#verification-method-binding" aria-label="Permalink for Section 5.6"></a></div>
        

        <div class="issue" id="issue-container-generatedID-20"><div role="heading" class="issue-title marker" id="h-issue-16" aria-level="4"><span>Issue</span></div><p class="">
Implementers must ensure that a verification method is bound to a particular
controller by going from the verification method to the controller document,
and then ensuring that the controller document also contains the verification
method.
        </p></div>
      </section>

      <section id="verification-relationship-validation"><div class="header-wrapper"><h3 id="x5-7-verification-relationship-validation"><bdi class="secno">5.7 </bdi>Verification Relationship Validation</h3><a class="self-link" href="#verification-relationship-validation" aria-label="Permalink for Section 5.7"></a></div>
        

        <div class="issue" id="issue-container-generatedID-21"><div role="heading" class="issue-title marker" id="h-issue-17" aria-level="4"><span>Issue</span></div><p class="">
Implementers need to ensure that when a verification method is used, that
it matches the verification relationship associated with it and that it lines
up with the proof purpose.
        </p></div>
      </section>

      <section id="canonicalization-method-correctness"><div class="header-wrapper"><h3 id="x5-8-canonicalization-method-correctness"><bdi class="secno">5.8 </bdi>Canonicalization Method Correctness</h3><a class="self-link" href="#canonicalization-method-correctness" aria-label="Permalink for Section 5.8"></a></div>
        

        <div class="issue" id="issue-container-generatedID-22"><div role="heading" class="issue-title marker" id="h-issue-18" aria-level="4"><span>Issue</span></div><p class="">
Canonicalization mechanisms utilized for normalizing input to hashing functions
need to have vetted mathematical proofs associted with them. Canonicalization
mechanisms that create collisions in hash functions can be used to attack
digital signatures.
        </p></div>
      </section>

    </section>

    <section id="privacy-considerations"><div class="header-wrapper"><h2 id="x6-privacy-considerations"><bdi class="secno">6. </bdi>Privacy Considerations</h2><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Section 6."></a></div>
      
      <p>
The following section describes privacy considerations that developers
implementing this specification should be aware of in order to create
privacy enhancing software.
      </p>

      <section id="unlinkability"><div class="header-wrapper"><h3 id="x6-1-unlinkability"><bdi class="secno">6.1 </bdi>Unlinkability</h3><a class="self-link" href="#unlinkability" aria-label="Permalink for Section 6.1"></a></div>
        

        <p>
When a digitally-signed payload contains data that is seen by multiple
verifiers, it becomes a point of correlation. An example of such data is a
shopping loyalty card number. Correlatable data can be used for tracking
purposes by verifiers, which can sometimes violate privacy expectations. The
fact that some data can be used for tracking might not be immediately apparent.
Examples of such correlatable data include, but are not limited to, a static
digital signature or a cryptographic hash of an image.
        </p>

        <p>
It is possible to create a digitally-signed payload that does not have any
correlatable tracking data while also providing some level of assurance that the
payload is trustworthy for a given interaction. This characteristic is called
<dfn class="lint-ignore" id="dfn-unlinkability" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">unlinkability</dfn> which ensures that no correlatable
data are used in a digitally-signed payload while still providing some level of
trust, the sufficiency of which must be determined by each verifier.
        </p>

        <p>
It is important to understand that not all use cases require or even permit
unlinkability. There are use cases where linkability and correlation are
required due to regulatory or safety reasons, such as correlating organizations
and individuals that are shipping and storing hazardous materials. Unlinkability
is useful when there is an expectation of privacy for a particular interaction.
        </p>

        <p>
There are at least two mechanisms that can provide some level of unlinkability.
The first method is to ensure that no data value used in the message is ever
repeated in a future message. The second is to ensure that any repeated data
value provides adequate herd privacy such that it becomes practically impossible
to correlate the entity that expects some level of privacy in the interaction.
        </p>

        <p>
A variety of methods can be used to achieve unlinkability. These methods include
ensuring that a message is a single use bearer token with no information that
can be used for the purposes of correlation, using attributes that ensure an
adequate level of herd privacy, and the use of cryptosuites that enable the
entity presenting a message to regenerate new signatures while not compromising
the trust in the message being presented.
        </p>
      </section>

      <section id="selective-disclosure"><div class="header-wrapper"><h3 id="x6-2-selective-disclosure"><bdi class="secno">6.2 </bdi>Selective Disclosure</h3><a class="self-link" href="#selective-disclosure" aria-label="Permalink for Section 6.2"></a></div>
        

        <p>
Selective disclosure is a technique that enables the recipient of a
previously-signed message (that is, a message signed by its creator) to reveal
only parts of the message without disturbing the verifiability of those
parts. For example, one might selectively disclose a digital driver's license for
the purpose of renting a car. This could involve revealing only the issuing
authority, license number, birthday, and authorized motor vehicle class from
the license. Note that in this case, the license number is correlatable
information, but some amount of privacy is preserved because the driver's
full name and address are not shared.
        </p>

        <p>
Not all software or cryptosuites are capable of providing selective disclosure.
If the author of a message wishes it to be selectively disclosable by
its recipient, then they need to enable selective disclosure on the specific
message, and both need to use a capable cryptosuite. The author might
also make it mandatory
to disclose certain parts of the message. A recipient that wants to selectively
disclose partial content of the message needs to utilize software that is able to perform the
technique. An example of a cryptosuite that supports selective disclosure is
<code>bbs-2022</code>.
        </p>

        <p>
It is possible to selectively disclose information in a way that does not preserve
unlinkability. For example, one might want to disclose the inspection results related
to a shipment, which include the shipment identifier or lot number, which might
have to be correlatable due to regulatory requirements. However, disclosure of
the entire inspection result might not be required as selectively disclosing just
the pass/fail status could be deemed adequate. For more information on
disclosing information while preserving privacy, see
Section <a href="#unlinkability" class="sec-ref"><bdi class="secno">6.1 </bdi>Unlinkability</a>.
        </p>

      </section>

    </section>



<section id="references" class="appendix"><div class="header-wrapper"><h2 id="a-references"><bdi class="secno">A. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix A."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="a-1-normative-references"><bdi class="secno">A.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix A.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-infra">[INFRA]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-multibase">[MULTIBASE]</dt><dd>
      <a href="https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-03"><cite>The Multibase Encoding Scheme</cite></a>. Juan Benet; Manu Sporny.  IETF. February 2021. Internet-Draft. URL: <a href="https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-03">https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-03</a>
    </dd><dt id="bib-multicodec">[MULTICODEC]</dt><dd>
      <a href="https://github.com/multiformats/multicodec/blob/master/table.csv"><cite>The Multi Codec Encoding Scheme</cite></a>. The Multiformats Community.  IETF. February 2022. Internet-Draft. URL: <a href="https://github.com/multiformats/multicodec/blob/master/table.csv">https://github.com/multiformats/multicodec/blob/master/table.csv</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc7517">[RFC7517]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-rfc7638">[RFC7638]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7638"><cite>JSON Web Key (JWK) Thumbprint</cite></a>. M. Jones; N. Sakimura.  IETF. September 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7638">https://www.rfc-editor.org/rfc/rfc7638</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-url">[URL]</dt><dd>
      <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Anne van Kesteren.  WHATWG. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
    </dd><dt id="bib-xmlschema11-2">[XMLSCHEMA11-2]</dt><dd>
      <a href="https://www.w3.org/TR/xmlschema11-2/"><cite>W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes</cite></a>. David Peterson; Sandy Gao; Ashok Malhotra; Michael Sperberg-McQueen; Henry Thompson; Paul V. Biron et al.  W3C. 5 April 2012. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlschema11-2/">https://www.w3.org/TR/xmlschema11-2/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="a-2-informative-references"><bdi class="secno">A.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix A.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-did-core">[DID-CORE]</dt><dd>
      <a href="https://www.w3.org/TR/did-core/"><cite>Decentralized Identifiers (DIDs) v1.0</cite></a>. Manu Sporny; Amy Guy; Markus Sabadello; Drummond Reed.  W3C. 19 July 2022. W3C Recommendation. URL: <a href="https://www.w3.org/TR/did-core/">https://www.w3.org/TR/did-core/</a>
    </dd><dt id="bib-n-quads">[N-QUADS]</dt><dd>
      <a href="https://www.w3.org/TR/n-quads/"><cite>RDF 1.1 N-Quads</cite></a>. Gavin Carothers.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/n-quads/">https://www.w3.org/TR/n-quads/</a>
    </dd><dt id="bib-rdf-dataset-c14n">[RDF-DATASET-C14N]</dt><dd>
      <a href="https://w3c-ccg.github.io/rdf-dataset-canonicalization/spec/index.html"><cite>RDF Dataset Canonicalization</cite></a>. David Longley; Manu Sporny.  Credentials Community Group. CGFINAL. URL: <a href="https://w3c-ccg.github.io/rdf-dataset-canonicalization/spec/index.html">https://w3c-ccg.github.io/rdf-dataset-canonicalization/spec/index.html</a>
    </dd><dt id="bib-rfc3986">[RFC3986]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3986"><cite>Uniform Resource Identifier (URI): Generic Syntax</cite></a>. T. Berners-Lee; R. Fielding; L. Masinter.  IETF. January 2005. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>
    </dd><dt id="bib-rfc7696">[RFC7696]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7696"><cite>Guidelines for Cryptographic Algorithm Agility and Selecting Mandatory-to-Implement Algorithms</cite></a>. R. Housley.  IETF. November 2015. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc7696">https://www.rfc-editor.org/rfc/rfc7696</a>
    </dd><dt id="bib-rfc8785">[RFC8785]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8785"><cite>JSON Canonicalization Scheme (JCS)</cite></a>. A. Rundgren; B. Jordan; S. Erdtman.  IETF. June 2020. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8785">https://www.rfc-editor.org/rfc/rfc8785</a>
    </dd><dt id="bib-security-vocabulary">[SECURITY-VOCABULARY]</dt><dd>
      <a href="https://w3id.org/security"><cite>The Security Vocabulary</cite></a>. Ivan Herman; Manu Sporny; David Longley.  Verifiable Credentials Working Group. W3C Editor's Draft. URL: <a href="https://w3id.org/security">https://w3id.org/security</a>
    </dd><dt id="bib-vc-data-model-2">[VC-DATA-MODEL-2]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-model-2.0/"><cite>Verifiable Credentials Data Model v2.0</cite></a>. Manu Sporny; Dave Longley; Grant Noble; Dan Burnett; Ted Thibodeau; Brent Zundel; David Chadwick; Kyle Den Hartog.  W3C Verifiable Credentials Working Group. Working Draft. URL: <a href="https://www.w3.org/TR/vc-data-model-2.0/">https://www.w3.org/TR/vc-data-model-2.0/</a>
    </dd><dt id="bib-vc-extension-registry">[VC-EXTENSION-REGISTRY]</dt><dd>
      <a href="https://w3c-ccg.github.io/vc-extension-registry/"><cite>Verifiable Credentials Extension Registry</cite></a>. Manu Sporny.  Credentials Community Group. CG-DRAFT. URL: <a href="https://w3c-ccg.github.io/vc-extension-registry/">https://w3c-ccg.github.io/vc-extension-registry/</a>
    </dd><dt id="bib-zcap">[ZCAP]</dt><dd>
      <a href="https://w3c-ccg.github.io/zcap-spec"><cite>Authorization Capabilities for Linked Data</cite></a>.  Credentials Community Group. CGDRAFT. URL: <a href="https://w3c-ccg.github.io/zcap-spec">https://w3c-ccg.github.io/zcap-spec</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-transformation" aria-label="Links in this document to definition: Transformation">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-transformation" aria-label="Permalink for definition: Transformation. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-transformation-1" title="§ 1.1 How it Works">§ 1.1 How it Works</a> 
  </li><li>
    <a href="#ref-for-dfn-transformation-2" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> 
  </li><li>
    <a href="#ref-for-dfn-transformation-3" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-transformation-algorithm" aria-label="Links in this document to definition: transformation algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-transformation-algorithm" aria-label="Permalink for definition: transformation algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-transformation-algorithm-1" title="§ 3. Cryptographic Suites">§ 3. Cryptographic Suites</a> 
  </li><li>
    <a href="#ref-for-dfn-transformation-algorithm-2" title="§ 4. Algorithms">§ 4. Algorithms</a> 
  </li><li>
    <a href="#ref-for-dfn-transformation-algorithm-3" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> 
  </li><li>
    <a href="#ref-for-dfn-transformation-algorithm-4" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-hashing" aria-label="Links in this document to definition: Hashing">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-hashing" aria-label="Permalink for definition: Hashing. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-hashing-1" title="§ 1.1 How it Works">§ 1.1 How it Works</a> 
  </li><li>
    <a href="#ref-for-dfn-hashing-2" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> 
  </li><li>
    <a href="#ref-for-dfn-hashing-3" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-hashing-algorithm" aria-label="Links in this document to definition: hashing algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-hashing-algorithm" aria-label="Permalink for definition: hashing algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-hashing-algorithm-1" title="§ 3. Cryptographic Suites">§ 3. Cryptographic Suites</a> 
  </li><li>
    <a href="#ref-for-dfn-hashing-algorithm-2" title="§ 4. Algorithms">§ 4. Algorithms</a> 
  </li><li>
    <a href="#ref-for-dfn-hashing-algorithm-3" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> <a href="#ref-for-dfn-hashing-algorithm-4" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-hashing-algorithm-5" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-generation-algorithm" aria-label="Links in this document to definition: proof generation algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-generation-algorithm" aria-label="Permalink for definition: proof generation algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-generation-algorithm-1" title="§ 3. Cryptographic Suites">§ 3. Cryptographic Suites</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-generation-algorithm-2" title="§ 4. Algorithms">§ 4. Algorithms</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-generation-algorithm-3" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-verification-algorithm" aria-label="Links in this document to definition: proof verification algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-verification-algorithm" aria-label="Permalink for definition: proof verification algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-verification-algorithm-1" title="§ 3. Cryptographic Suites">§ 3. Cryptographic Suites</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-verification-algorithm-2" title="§ 4. Algorithms">§ 4. Algorithms</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-verification-algorithm-3" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data-integrity-proof" aria-label="Links in this document to definition: data integrity proof">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-data-integrity-proof" aria-label="Permalink for definition: data integrity proof. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-data-integrity-proof-1" title="§ 2. Data Model">§ 2. Data Model</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-2" title="§ 2.1 Proofs">§ 2.1 Proofs</a> <a href="#ref-for-dfn-data-integrity-proof-3" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-public-key" aria-label="Links in this document to definition: public key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-public-key" aria-label="Permalink for definition: public key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-public-key-1" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> <a href="#ref-for-dfn-public-key-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-private-key" aria-label="Links in this document to definition: private key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-private-key" aria-label="Permalink for definition: private key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-private-key-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-type" aria-label="Links in this document to definition: proof type">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-type" aria-label="Permalink for definition: proof type. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-type-1" title="§ 2.1 Proofs">§ 2.1 Proofs</a> <a href="#ref-for-dfn-proof-type-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-options" aria-label="Links in this document to definition: proof options">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-options" aria-label="Permalink for definition: proof options. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-options-1" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> <a href="#ref-for-dfn-proof-options-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-proof-options-3" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-proof-purpose" aria-label="Links in this document to definition: proof purpose">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-proof-purpose" aria-label="Permalink for definition: proof purpose. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-proof-purpose-1" title="§ 2.2 Proof Purposes">§ 2.2 Proof Purposes</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-challenge" aria-label="Links in this document to definition: challenge">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-challenge" aria-label="Permalink for definition: challenge. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-challenge-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-domain" aria-label="Links in this document to definition: domain">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-domain" aria-label="Permalink for definition: domain. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-domain-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-domain-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-domain-3" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-domain-4" title="§ 2.1 Proofs">§ 2.1 Proofs</a> 
  </li><li>
    <a href="#ref-for-dfn-domain-5" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-authenticated" aria-label="Links in this document to definition: authenticate">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-authenticated" aria-label="Permalink for definition: authenticate. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-authenticated-1" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> 
  </li><li>
    <a href="#ref-for-dfn-authenticated-2" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-authenticated-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-authenticated-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-authenticated-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-authenticated-6" title="Reference 5">(5)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cryptosuite" aria-label="Links in this document to definition: cryptographic suite">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cryptosuite" aria-label="Permalink for definition: cryptographic suite. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-cryptosuite-1" title="§ 1.1 How it Works">§ 1.1 How it Works</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-2" title="§ 1.2 Design Goals and Rationale">§ 1.2 Design Goals and Rationale</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-3" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-4" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-5" title="§ 3. Cryptographic Suites">§ 3. Cryptographic Suites</a> <a href="#ref-for-dfn-cryptosuite-6" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-7" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> <a href="#ref-for-dfn-cryptosuite-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cryptosuite-9" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cryptosuite-10" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cryptosuite-11" title="Reference 5">(5)</a> <a href="#ref-for-dfn-cryptosuite-12" title="Reference 6">(6)</a> 
  </li><li>
    <a href="#ref-for-dfn-cryptosuite-13" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> <a href="#ref-for-dfn-cryptosuite-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-cryptosuite-15" title="Reference 3">(3)</a> <a href="#ref-for-dfn-cryptosuite-16" title="Reference 4">(4)</a> <a href="#ref-for-dfn-cryptosuite-17" title="Reference 5">(5)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-decentralized-identifiers" aria-label="Links in this document to definition: decentralized identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-decentralized-identifiers" aria-label="Permalink for definition: decentralized identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-decentralized-identifiers-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controller-s" aria-label="Links in this document to definition: controller">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controller-s" aria-label="Permalink for definition: controller. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-controller-s-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-controller-s-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-3" title="§ 2.3 Controller Documents">§ 2.3 Controller Documents</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-4" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> <a href="#ref-for-dfn-controller-s-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-s-7" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-8" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-9" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> <a href="#ref-for-dfn-controller-s-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-11" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-12" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-controller-s-13" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-14" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-15" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> <a href="#ref-for-dfn-controller-s-16" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-17" title="§ 2.3.2.3 Key Agreement">§ 2.3.2.3 Key Agreement</a> <a href="#ref-for-dfn-controller-s-18" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-19" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> <a href="#ref-for-dfn-controller-s-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-21" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-22" title="§ 2.3.2.5 Capability Delegation">§ 2.3.2.5 Capability Delegation</a> <a href="#ref-for-dfn-controller-s-23" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-s-24" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-s-25" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-s-26" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controller-documents" aria-label="Links in this document to definition: controller document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controller-documents" aria-label="Permalink for definition: controller document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-controller-documents-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-controller-documents-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-3" title="§ 2.3 Controller Documents">§ 2.3 Controller Documents</a> <a href="#ref-for-dfn-controller-documents-4" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-5" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> <a href="#ref-for-dfn-controller-documents-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-documents-7" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-documents-8" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-9" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> <a href="#ref-for-dfn-controller-documents-10" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-11" title="§ 2.3.1.3 Referring to Verification Methods">§ 2.3.1.3 Referring to Verification Methods</a> <a href="#ref-for-dfn-controller-documents-12" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-13" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> <a href="#ref-for-dfn-controller-documents-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-documents-15" title="Reference 3">(3)</a> <a href="#ref-for-dfn-controller-documents-16" title="Reference 4">(4)</a> <a href="#ref-for-dfn-controller-documents-17" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-18" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-controller-documents-19" title="Reference 2">(2)</a> <a href="#ref-for-dfn-controller-documents-20" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-21" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> 
  </li><li>
    <a href="#ref-for-dfn-controller-documents-22" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> <a href="#ref-for-dfn-controller-documents-23" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-subjects" aria-label="Links in this document to definition: subject">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-subjects" aria-label="Permalink for definition: subject. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-subjects-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-subjects-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-distributed-ledger-technology" aria-label="Links in this document to definition: distributed ledger">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-distributed-ledger-technology" aria-label="Permalink for definition: distributed ledger. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-distributed-ledger-technology-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-resources" aria-label="Links in this document to definition: resource">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-resources" aria-label="Permalink for definition: resource. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-resources-1" title="§ 2.3.1.3 Referring to Verification Methods">§ 2.3.1.3 Referring to Verification Methods</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verifiable-credentials" aria-label="Links in this document to definition: verifiable credential">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verifiable-credentials" aria-label="Permalink for definition: verifiable credential. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verifiable-credentials-1" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> <a href="#ref-for-dfn-verifiable-credentials-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-method" aria-label="Links in this document to definition: verification method">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-method" aria-label="Permalink for definition: verification method. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verification-method-1" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-verification-method-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-3" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-4" title="§ 2. Data Model">§ 2. Data Model</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-5" title="§ 2.3 Controller Documents">§ 2.3 Controller Documents</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-6" title="§ 2.3.1 Verification Methods">§ 2.3.1 Verification Methods</a> <a href="#ref-for-dfn-verification-method-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-10" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-11" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-12" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-method-13" title="Reference 8">(8)</a> <a href="#ref-for-dfn-verification-method-14" title="Reference 9">(9)</a> <a href="#ref-for-dfn-verification-method-15" title="Reference 10">(10)</a> <a href="#ref-for-dfn-verification-method-16" title="Reference 11">(11)</a> <a href="#ref-for-dfn-verification-method-17" title="Reference 12">(12)</a> <a href="#ref-for-dfn-verification-method-18" title="Reference 13">(13)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-19" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> <a href="#ref-for-dfn-verification-method-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-21" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-22" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-23" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-24" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-method-25" title="Reference 7">(7)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-26" title="§ 2.3.1.2 Multikey">§ 2.3.1.2 Multikey</a> <a href="#ref-for-dfn-verification-method-27" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-28" title="§ 2.3.1.3 Referring to Verification Methods">§ 2.3.1.3 Referring to Verification Methods</a> <a href="#ref-for-dfn-verification-method-29" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-30" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-31" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-32" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-33" title="Reference 6">(6)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-34" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> <a href="#ref-for-dfn-verification-method-35" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-36" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-37" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-method-38" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-method-39" title="Reference 6">(6)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-40" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-verification-method-41" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-42" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-43" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-44" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> <a href="#ref-for-dfn-verification-method-45" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-46" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-47" title="§ 2.3.2.3 Key Agreement">§ 2.3.2.3 Key Agreement</a> <a href="#ref-for-dfn-verification-method-48" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-49" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-50" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> <a href="#ref-for-dfn-verification-method-51" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-52" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-method-53" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-54" title="§ 2.3.2.5 Capability Delegation">§ 2.3.2.5 Capability Delegation</a> <a href="#ref-for-dfn-verification-method-55" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-method-56" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-57" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-58" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-relationship" aria-label="Links in this document to definition: verification relationship">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-relationship" aria-label="Permalink for definition: verification relationship. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verification-relationship-1" title="§ 2.3 Controller Documents">§ 2.3 Controller Documents</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-2" title="§ 2.3.1.3 Referring to Verification Methods">§ 2.3.1.3 Referring to Verification Methods</a> <a href="#ref-for-dfn-verification-relationship-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-4" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> <a href="#ref-for-dfn-verification-relationship-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verification-relationship-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-verification-relationship-7" title="Reference 4">(4)</a> <a href="#ref-for-dfn-verification-relationship-8" title="Reference 5">(5)</a> <a href="#ref-for-dfn-verification-relationship-9" title="Reference 6">(6)</a> <a href="#ref-for-dfn-verification-relationship-10" title="Reference 7">(7)</a> <a href="#ref-for-dfn-verification-relationship-11" title="Reference 8">(8)</a> <a href="#ref-for-dfn-verification-relationship-12" title="Reference 9">(9)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-13" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-verification-relationship-14" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-15" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-16" title="§ 2.3.2.3 Key Agreement">§ 2.3.2.3 Key Agreement</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-17" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-relationship-18" title="§ 2.3.2.5 Capability Delegation">§ 2.3.2.5 Capability Delegation</a> <a href="#ref-for-dfn-verification-relationship-19" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-publickeyjwk" aria-label="Links in this document to definition: publicKeyJwk">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-publickeyjwk" aria-label="Permalink for definition: publicKeyJwk. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-publickeyjwk-1" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-publickeymultibase" aria-label="Links in this document to definition: publicKeyMultibase">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-publickeymultibase" aria-label="Permalink for definition: publicKeyMultibase. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-publickeymultibase-1" title="§ 2.3.1.1 Verification Material">§ 2.3.1.1 Verification Material</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-authentication" aria-label="Links in this document to definition: authentication">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-authentication" aria-label="Permalink for definition: authentication. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-authentication-1" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> 
  </li><li>
    <a href="#ref-for-dfn-authentication-2" title="§ 2.3.2.1 Authentication">§ 2.3.2.1 Authentication</a> <a href="#ref-for-dfn-authentication-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-authentication-4" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-assertionmethod" aria-label="Links in this document to definition: assertionMethod">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-assertionmethod" aria-label="Permalink for definition: assertionMethod. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-assertionmethod-1" title="§ 2.3.2.2 Assertion">§ 2.3.2.2 Assertion</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-keyagreement" aria-label="Links in this document to definition: keyAgreement">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-keyagreement" aria-label="Permalink for definition: keyAgreement. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-keyagreement-1" title="§ 2.3.2 Verification Relationships">§ 2.3.2 Verification Relationships</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-capabilityinvocation" aria-label="Links in this document to definition: capabilityInvocation">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-capabilityinvocation" aria-label="Permalink for definition: capabilityInvocation. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-capabilityinvocation-1" title="§ 2.3.2.4 Capability Invocation">§ 2.3.2.4 Capability Invocation</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-unsecured-data-document" aria-label="Links in this document to definition: unsecured data document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-unsecured-data-document" aria-label="Permalink for definition: unsecured data document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-unsecured-data-document-1" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-secured-data-document" aria-label="Links in this document to definition: secured data document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-secured-data-document" aria-label="Permalink for definition: secured data document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-secured-data-document-1" title="§ 4.1 Generate Proof">§ 4.1 Generate Proof</a> 
  </li><li>
    <a href="#ref-for-dfn-secured-data-document-2" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> <a href="#ref-for-dfn-secured-data-document-3" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-result" aria-label="Links in this document to definition: verification result">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-result" aria-label="Permalink for definition: verification result. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verification-result-1" title="§ 4.2 Verify Proof">§ 4.2 Verify Proof</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>